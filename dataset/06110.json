{
  "Title": "[N-08] Missing inheritance",
  "Content": "- Severity: Non-Critical\n- Confidence: High\n\n### Description\nThis detector identifies instances where a contract defines functions that match an interface's signature, but does not explicitly inherit from the interface. Explicitly declaring inheritance relationships can improve code readability and maintainability, and ensures that the contract adheres to the defined interface.\n\n<details>\n\n<summary>\nThere are 3 instances of this issue:\n\n</summary>\n\n###\n- File: solidity/contracts/governance/AmphoraProtocolToken.sol\n```\n \nLine: 8          contract AmphoraProtocolToken is IAmphoraProtocolToken, ERC20VotesComp, Ownable \n```\n should inherit from File: solidity/interfaces/governance/IAMPH.sol\n```\n \nLine: 4          interface IAMPH \n```\n\n[https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/governance/AmphoraProtocolToken.sol#L8-L23](https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/governance/AmphoraProtocolToken.sol#L8-L23)\n\n- File: solidity/contracts/periphery/oracles/ChainlinkOracleRelay.sol\n```\n \nLine: 11          contract ChainlinkOracleRelay is OracleRelay, Ownable \n```\n should inherit from File: solidity/interfaces/periphery/IChainlinkOracleRelay.sol\n```\n \nLine: 4          interface IChainlinkOracleRelay \n```\n\n[https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/periphery/oracles/ChainlinkOracleRelay.sol#L11-L77](https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/periphery/oracles/ChainlinkOracleRelay.sol#L11-L77)\n\n- File: solidity/contracts/periphery/oracles/ChainlinkTokenOracleRelay.sol\n```\n \nLine: 10          contract ChainlinkTokenOracleRelay is OracleRelay \n```\n should inherit from File: solidity/interfaces/periphery/IChainlinkOracleRelay.sol\n```\n \nLine: 4          interface IChainlinkOracleRelay \n```\n\n[https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/periphery/oracles/ChainlinkTokenOracleRelay.sol#L10-L53](https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/periphery/oracles/ChainlinkTokenOracleRelay.sol#L10-L53)\n\n</details>\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2023-07-amphora",
  "Code": [
    {
      "filename": "core/solidity/contracts/governance/AmphoraProtocolToken.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.9;\n\nimport {IAmphoraProtocolToken} from '@interfaces/governance/IAmphoraProtocolToken.sol';\nimport {Ownable} from '@openzeppelin/contracts/access/Ownable.sol';\nimport {ERC20, ERC20Permit, ERC20VotesComp} from '@openzeppelin/contracts/token/ERC20/extensions/ERC20VotesComp.sol';\n\ncontract AmphoraProtocolToken is IAmphoraProtocolToken, ERC20VotesComp, Ownable {\n  constructor(\n    address _account,\n    uint256 _initialSupply\n  ) ERC20('Amphora Protocol', 'AMPH') ERC20Permit('Amphora Protocol') {\n    if (_account == address(0)) revert AmphoraProtocolToken_InvalidAddress();\n    if (_initialSupply <= 0) revert AmphoraProtocolToken_InvalidSupply();\n\n    _mint(_account, _initialSupply);\n  }\n\n  /// @notice Mint a specified amount of tokens to a specified address\n  function mint(address _dst, uint256 _rawAmount) public onlyOwner {\n    _mint(_dst, _rawAmount);\n  }\n}"
    },
    {
      "filename": "core/solidity/contracts/periphery/oracles/ChainlinkOracleRelay.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.9;\n\nimport {IOracleRelay, OracleRelay} from '@contracts/periphery/oracles/OracleRelay.sol';\nimport {ChainlinkStalePriceLib} from '@contracts/periphery/oracles/ChainlinkStalePriceLib.sol';\nimport {AggregatorV2V3Interface} from '@chainlink/interfaces/AggregatorV2V3Interface.sol';\nimport {Ownable} from '@openzeppelin/contracts/access/Ownable.sol';\n\n/// @notice Oracle that wraps a chainlink oracle.\n///         The oracle returns (chainlinkPrice) * mul / div\ncontract ChainlinkOracleRelay is OracleRelay, Ownable {\n  /// @notice Emitted when the amount is zero\n  error ChainlinkOracle_ZeroAmount();\n\n  /// @notice The chainlink aggregator\n  AggregatorV2V3Interface private immutable _AGGREGATOR;\n\n  /// @notice multiply number used to scale the price\n  uint256 public immutable MULTIPLY;\n\n  /// @notice divide number used to scale the price\n  uint256 public immutable DIVIDE;\n\n  /// @notice The delay before the price is considered stale\n  uint256 public stalePriceDelay;\n\n  /// @notice All values set at construction time\n  /// @param _underlying The underlying address\n  /// @param _feedAddress The address of chainlink feed\n  /// @param _mul The numerator of scalar\n  /// @param _div The denominator of scalar\n  /// @param _stalePriceDelay The delay before the price is considered stale\n  constructor(\n    address _underlying,\n    address _feedAddress,\n    uint256 _mul,\n    uint256 _div,\n    uint256 _stalePriceDelay\n  ) OracleRelay(OracleType.Chainlink) {\n    _AGGREGATOR = AggregatorV2V3Interface(_feedAddress);\n    MULTIPLY = _mul;\n    DIVIDE = _div;\n    stalePriceDelay = _stalePriceDelay;\n\n    _setUnderlying(_underlying);\n  }\n\n  /// @notice The current reported value of the oracle\n  /// @dev Implementation in getLastSecond\n  /// @return _value The current value\n  function peekValue() public view override returns (uint256 _value) {\n    _value = _getLastSecond();\n  }\n\n  /// @notice Returns true if the price is stale\n  /// @return _stale True if the price is stale\n  function isStale() external view returns (bool _stale) {\n    (,,, uint256 _updatedAt,) = _AGGREGATOR.latestRoundData();\n    if (block.timestamp > _updatedAt + stalePriceDelay) _stale = true;\n  }\n\n  /// @notice Sets the stale price delay\n  /// @param _stalePriceDelay The new stale price delay\n  /// @dev Only the owner can call this function\n  function setStalePriceDelay(uint256 _stalePriceDelay) external onlyOwner {\n    if (_stalePriceDelay == 0) revert ChainlinkOracle_ZeroAmount();\n    stalePriceDelay = _stalePriceDelay;\n  }\n\n  /// @notice Returns last second value of the oracle\n  /// @dev    It does not revert if price is stale\n  /// @return _value The last second value of the oracle\n  function _getLastSecond() private view returns (uint256 _value) {\n    uint256 _latest = ChainlinkStalePriceLib.getCurrentPrice(_AGGREGATOR);\n    _value = (uint256(_latest) * MULTIPLY) / DIVIDE;\n  }\n}"
    },
    {
      "filename": "core/solidity/contracts/periphery/oracles/ChainlinkTokenOracleRelay.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.9;\n\nimport {IOracleRelay, OracleRelay} from '@contracts/periphery/oracles/OracleRelay.sol';\nimport {ChainlinkOracleRelay} from '@contracts/periphery/oracles/ChainlinkOracleRelay.sol';\n\n/// @notice This oracle is for tokens that don't have a USD pair but do have a wETH/ETH pair\n/// @dev Oracle that wraps a chainlink oracle\n///      The oracle returns (chainlinkPrice) * mul / div\ncontract ChainlinkTokenOracleRelay is OracleRelay {\n  /// @notice The chainlink aggregator\n  ChainlinkOracleRelay public immutable AGGREGATOR;\n\n  /// @notice The chainlink aggregator for the base token\n  ChainlinkOracleRelay public immutable BASE_AGGREGATOR;\n\n  /// @notice All values set at construction time\n  /// @param  _feedAddress The address of chainlink feed\n  /// @param  _baseFeedAddress The address of chainlink feed for the base token\n  constructor(\n    ChainlinkOracleRelay _feedAddress,\n    ChainlinkOracleRelay _baseFeedAddress\n  ) OracleRelay(OracleType.Chainlink) {\n    AGGREGATOR = ChainlinkOracleRelay(_feedAddress);\n    BASE_AGGREGATOR = ChainlinkOracleRelay(_baseFeedAddress);\n\n    _setUnderlying(_feedAddress.underlying());\n  }\n\n  /// @notice returns the price with 18 decimals without any state changes\n  /// @dev some oracles require a state change to get the exact current price.\n  ///      This is updated when calling other state changing functions that query the price\n  /// @return _price the current price\n  function peekValue() public view override returns (uint256 _price) {\n    _price = _get();\n  }\n\n  /// @notice Returns true if the price is stale\n  /// @return _stale True if the price is stale\n  function isStale() external view returns (bool _stale) {\n    _stale = AGGREGATOR.isStale() || BASE_AGGREGATOR.isStale();\n  }\n\n  /// @notice The current reported value of the oracle\n  /// @dev Implementation in getLastSecond\n  /// @return _value The current value\n  function _get() internal view returns (uint256 _value) {\n    uint256 _aggregatorPrice = AGGREGATOR.peekValue();\n    uint256 _baseAggregatorPrice = BASE_AGGREGATOR.peekValue();\n\n    _value = (_aggregatorPrice * _baseAggregatorPrice) / 1e18;\n  }\n}"
    }
  ]
}