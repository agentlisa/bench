{
  "Title": "Misleading Comment",
  "Content": "The [comment in line 172](https://github.com/scroll-tech/scroll/blob/f6894bb82f78228b349267ed814375cae2fc1483/contracts/src/L2/gateways/usdc/L2USDCGateway.sol#L172) of the `L2USDCGateway` contract should say `L2ScrollMessenger` instead of `L1ScrollMessenger`.\n\n\nConsider resolving this instance of incorrect documentation to improve the clarity and readability of the codebase.\n\n\n***Update:** Resolved in [pull request #928](https://github.com/scroll-tech/scroll/pull/928) at commit [733d2a6](https://github.com/scroll-tech/scroll/pull/928/commits/733d2a62d44a0037b2972d6825e6802fc6ac76f5).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/src/L2/gateways/usdc/L2USDCGateway.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity =0.8.16;\n\nimport {OwnableUpgradeable} from \"@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol\";\nimport {IERC20Upgradeable} from \"@openzeppelin/contracts-upgradeable/token/ERC20/IERC20Upgradeable.sol\";\nimport {SafeERC20Upgradeable} from \"@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol\";\n\nimport {IFiatToken} from \"../../../interfaces/IFiatToken.sol\";\nimport {IUSDCDestinationBridge} from \"../../../interfaces/IUSDCDestinationBridge.sol\";\nimport {IL1ERC20Gateway} from \"../../../L1/gateways/IL1ERC20Gateway.sol\";\nimport {IL2ScrollMessenger} from \"../../IL2ScrollMessenger.sol\";\nimport {IL2ERC20Gateway} from \"../IL2ERC20Gateway.sol\";\n\nimport {ScrollGatewayBase, IScrollGateway} from \"../../../libraries/gateway/ScrollGatewayBase.sol\";\nimport {L2ERC20Gateway} from \"../L2ERC20Gateway.sol\";\n\n/// @title L2USDCGateway\n/// @notice The `L2USDCGateway` contract is used to withdraw `USDC` token on layer 2 and\n/// finalize deposit `USDC` from layer 1.\ncontract L2USDCGateway is L2ERC20Gateway, IUSDCDestinationBridge {\n    using SafeERC20Upgradeable for IERC20Upgradeable;\n\n    /*************\n     * Constants *\n     *************/\n\n    /// @notice The address of L1 USDC address.\n    address public immutable l1USDC;\n\n    /// @notice The address of L2 USDC address.\n    address public immutable l2USDC;\n\n    /*************\n     * Variables *\n     *************/\n\n    /// @notice The address of caller from Circle.\n    address public circleCaller;\n\n    /// @notice The flag indicates whether USDC deposit is paused.\n    /// @dev This is not necessary to be set `true` since we will set `L1USDCGateway.depositPaused` first.\n    ///      This is kept just in case and will be set after all pending messages are relayed.\n    bool public depositPaused;\n\n    /// @notice The flag indicates whether USDC withdrawal is paused.\n    bool public withdrawPaused;\n\n    /***************\n     * Constructor *\n     ***************/\n\n    constructor(address _l1USDC, address _l2USDC) {\n        _disableInitializers();\n\n        l1USDC = _l1USDC;\n        l2USDC = _l2USDC;\n    }\n\n    function initialize(\n        address _counterpart,\n        address _router,\n        address _messenger\n    ) external initializer {\n        require(_router != address(0), \"zero router address\");\n        ScrollGatewayBase._initialize(_counterpart, _router, _messenger);\n    }\n\n    /*************************\n     * Public View Functions *\n     *************************/\n\n    /// @inheritdoc IL2ERC20Gateway\n    function getL1ERC20Address(address) external view override returns (address) {\n        return l1USDC;\n    }\n\n    /// @inheritdoc IL2ERC20Gateway\n    function getL2ERC20Address(address) public view override returns (address) {\n        return l2USDC;\n    }\n\n    /*****************************\n     * Public Mutating Functions *\n     *****************************/\n\n    /// @inheritdoc IL2ERC20Gateway\n    function finalizeDepositERC20(\n        address _l1Token,\n        address _l2Token,\n        address _from,\n        address _to,\n        uint256 _amount,\n        bytes calldata _data\n    ) external payable override onlyCallByCounterpart nonReentrant {\n        require(msg.value == 0, \"nonzero msg.value\");\n        require(_l1Token == l1USDC, \"l1 token not USDC\");\n        require(_l2Token == l2USDC, \"l2 token not USDC\");\n        require(!depositPaused, \"deposit paused\");\n\n        require(IFiatToken(_l2Token).mint(_to, _amount), \"mint USDC failed\");\n\n        // disable call for USDC\n        // _doCallback(_to, _data);\n\n        emit FinalizeDepositERC20(_l1Token, _l2Token, _from, _to, _amount, _data);\n    }\n\n    /*******************************\n     * Public Restricted Functions *\n     *******************************/\n\n    /// @inheritdoc IUSDCDestinationBridge\n    function transferUSDCRoles(address _owner) external {\n        require(msg.sender == circleCaller, \"only circle caller\");\n\n        OwnableUpgradeable(l2USDC).transferOwnership(_owner);\n    }\n\n    /// @notice Update the Circle EOA address.\n    /// @param _caller The address to update.\n    function updateCircleCaller(address _caller) external onlyOwner {\n        circleCaller = _caller;\n    }\n\n    /// @notice Change the deposit pause status of this contract.\n    /// @param _paused The new status, `true` means paused and `false` means not paused.\n    function pauseDeposit(bool _paused) external onlyOwner {\n        depositPaused = _paused;\n    }\n\n    /// @notice Change the withdraw pause status of this contract.\n    /// @param _paused The new status, `true` means paused and `false` means not paused.\n    function pauseWithdraw(bool _paused) external onlyOwner {\n        withdrawPaused = _paused;\n    }\n\n    /**********************\n     * Internal Functions *\n     **********************/\n\n    /// @inheritdoc L2ERC20Gateway\n    function _withdraw(\n        address _token,\n        address _to,\n        uint256 _amount,\n        bytes memory _data,\n        uint256 _gasLimit\n    ) internal virtual override nonReentrant {\n        require(_amount > 0, \"withdraw zero amount\");\n        require(_token == l2USDC, \"only USDC is allowed\");\n        require(!withdrawPaused, \"withdraw paused\");\n\n        // 1. Extract real sender if this call is from L2GatewayRouter.\n        address _from = msg.sender;\n        if (router == msg.sender) {\n            (_from, _data) = abi.decode(_data, (address, bytes));\n        }\n        require(_data.length == 0, \"call is not allowed\");\n\n        // 2. Transfer token into this contract.\n        IERC20Upgradeable(_token).safeTransferFrom(_from, address(this), _amount);\n        IFiatToken(_token).burn(_amount);\n\n        // 3. Generate message passed to L1USDCGateway.\n        address _l1USDC = l1USDC;\n        bytes memory _message = abi.encodeCall(\n            IL1ERC20Gateway.finalizeWithdrawERC20,\n            (_l1USDC, _token, _from, _to, _amount, _data)\n        );\n\n        // 4. Send message to L1ScrollMessenger.\n        IL2ScrollMessenger(messenger).sendMessage{value: msg.value}(counterpart, 0, _message, _gasLimit);\n\n        emit WithdrawERC20(_l1USDC, _token, _from, _to, _amount, _data);\n    }\n}"
    }
  ]
}