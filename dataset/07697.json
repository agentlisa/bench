{
  "Title": "[L-01] Draft Openzeppelin Dependencies",
  "Content": "<h2 id=\"l-01-draft-openzeppelin-dependencies\" style=\"position:relative;\"><a href=\"#l-01-draft-openzeppelin-dependencies\" aria-label=\"l 01 draft openzeppelin dependencies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-01] Draft Openzeppelin Dependencies</h2>\n<p>The <code>LPToken.sol</code> contract utilised draft-ERC20PermitUpgradeable.sol , an OpenZeppelin contract. This contract is still a draft and is not considered ready for mainnet use. OpenZeppelin contracts may be considered draft contracts if they have not received adequate security auditing or are liable to change with future development.</p>\n<p><a href=\"https://github.com/code-423n4/2022-11-stakehouse/blob/main/contracts/liquid-staking/LPToken.sol#L6\">LPToken.sol#L6</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"152\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">liquid</span><span class=\"mtk1\">-</span><span class=\"mtk12\">staking</span><span class=\"mtk1\">/</span><span class=\"mtk12\">LPToken</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">6</span><span class=\"mtk1\">: </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">ERC20PermitUpgradeable</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">\"@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol\"</span><span class=\"mtk1\">;</span></span></span></code></pre>\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/contests/2022-11-lsd-network-stakehouse-contest",
  "Code": [
    {
      "filename": "contracts/liquid-staking/LPToken.sol",
      "content": "pragma solidity ^0.8.13;\n\n// SPDX-License-Identifier: MIT\n\nimport { Initializable } from \"@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol\";\nimport { ERC20PermitUpgradeable } from \"@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol\";\nimport { ILPTokenInit } from \"../interfaces/ILPTokenInit.sol\";\nimport { ILiquidStakingManagerChildContract } from \"../interfaces/ILiquidStakingManagerChildContract.sol\";\nimport { ITransferHookProcessor } from \"../interfaces/ITransferHookProcessor.sol\";\n\ncontract LPToken is ILPTokenInit, ILiquidStakingManagerChildContract, Initializable, ERC20PermitUpgradeable {\n\n    /// @notice Contract deployer that can control minting and burning but is associated with a liquid staking manager\n    address public deployer;\n\n    /// @notice Optional hook for processing transfers\n    ITransferHookProcessor transferHookProcessor;\n\n    /// @notice Whenever the address last interacted with a token\n    mapping(address => uint256) public lastInteractedTimestamp;\n\n    modifier onlyDeployer {\n        require(msg.sender == deployer, \"Only savETH vault\");\n        _;\n    }\n\n    /// @custom:oz-upgrades-unsafe-allow constructor\n    constructor() initializer {}\n\n    /// @param _deployer Address of the account deploying the LP token\n    /// @param _transferHookProcessor Optional contract account that can be notified about transfer hooks\n    function init(\n        address _deployer,\n        address _transferHookProcessor,\n        string calldata _tokenSymbol,\n        string calldata _tokenName\n    ) external override initializer {\n        deployer = _deployer;\n        transferHookProcessor = ITransferHookProcessor(_transferHookProcessor);\n        __ERC20_init(_tokenName, _tokenSymbol);\n        __ERC20Permit_init(_tokenName);\n    }\n\n    /// @notice Mints a given amount of LP tokens\n    /// @dev Only savETH vault can mint\n    function mint(address _recipient, uint256 _amount) external onlyDeployer {\n        _mint(_recipient, _amount);\n    }\n\n    /// @notice Allows a LP token owner to burn their tokens\n    function burn(address _recipient, uint256 _amount) external onlyDeployer {\n        _burn(_recipient, _amount);\n    }\n\n    /// @notice In order to know the liquid staking network and manager associated with the LP token, call this\n    function liquidStakingManager() external view returns (address) {\n        return ILiquidStakingManagerChildContract(deployer).liquidStakingManager();\n    }\n\n    /// @dev If set, notify the transfer hook processor before token transfer\n    function _beforeTokenTransfer(address _from, address _to, uint256 _amount) internal override {\n        if (address(transferHookProcessor) != address(0)) transferHookProcessor.beforeTokenTransfer(_from, _to, _amount);\n    }\n\n    /// @dev If set, notify the transfer hook processor after token transfer\n    function _afterTokenTransfer(address _from, address _to, uint256 _amount) internal override {\n        lastInteractedTimestamp[_from] = block.timestamp;\n        lastInteractedTimestamp[_to] = block.timestamp;\n        if (address(transferHookProcessor) != address(0)) transferHookProcessor.afterTokenTransfer(_from, _to, _amount);\n    }\n}"
    }
  ]
}