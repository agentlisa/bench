{
  "Title": "Inconsistency of Allowing a Trusted Forwarder",
  "Content": "In `GasSwap`, some parts of the code rely on `_msgSender` and others on `msg.sender`. This inconsistency can lead to confusion as to when meta-transactions are allowed. For example, `GasSwap` inherits from `OwnableBase` which has an `onlyOwner` check that uses [`msg.sender`](https://github.com/scroll-tech/scroll/blob/2eb458cf4224d82fc56254e91e297a9ed261cefb/contracts/src/libraries/common/OwnableBase.sol#L28). Therefore, all functions with `onlyOwner` modifier will fail when submitted through a trusted forwarder.\n\n\nThis inconsistency is confusing and error-prone. Consider using `_msgSender()` everywhere in `GasSwap` and `OwnableBase`, which will automatically default to `msg.sender` if it is not sent from the `trustedForwarder` address.\n\n\n***Update:** Resolved in [pull request #846](https://github.com/scroll-tech/scroll/pull/846) at commit [60de22b](https://github.com/scroll-tech/scroll/pull/846/commits/60de22bfea6cde7c7790b3a8914230d1ea0a70af).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/src/libraries/common/OwnableBase.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.16;\n\nabstract contract OwnableBase {\n    /**********\n     * Events *\n     **********/\n\n    /// @notice Emitted when owner is changed by current owner.\n    /// @param _oldOwner The address of previous owner.\n    /// @param _newOwner The address of new owner.\n    event OwnershipTransferred(address indexed _oldOwner, address indexed _newOwner);\n\n    /*************\n     * Variables *\n     *************/\n\n    /// @notice The address of the current owner.\n    address public owner;\n\n    /**********************\n     * Function Modifiers *\n     **********************/\n\n    /// @dev Throws if called by any account other than the owner.\n    modifier onlyOwner() {\n        require(owner == msg.sender, \"caller is not the owner\");\n        _;\n    }\n\n    /************************\n     * Restricted Functions *\n     ************************/\n\n    /// @notice Leaves the contract without owner. It will not be possible to call\n    /// `onlyOwner` functions anymore. Can only be called by the current owner.\n    ///\n    /// @dev Renouncing ownership will leave the contract without an owner,\n    /// thereby removing any functionality that is only available to the owner.\n    function renounceOwnership() public onlyOwner {\n        _transferOwnership(address(0));\n    }\n\n    /// @notice Transfers ownership of the contract to a new account (`newOwner`).\n    /// Can only be called by the current owner.\n    function transferOwnership(address _newOwner) public onlyOwner {\n        require(_newOwner != address(0), \"new owner is the zero address\");\n        _transferOwnership(_newOwner);\n    }\n\n    /**********************\n     * Internal Functions *\n     **********************/\n\n    /// @dev Transfers ownership of the contract to a new account (`newOwner`).\n    /// Internal function without access restriction.\n    function _transferOwnership(address _newOwner) internal {\n        address _oldOwner = owner;\n        owner = _newOwner;\n        emit OwnershipTransferred(_oldOwner, _newOwner);\n    }\n}"
    }
  ]
}