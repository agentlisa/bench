{
  "Title": "Using `transferShares()` is possible",
  "Content": "##### Description\nTransfer can be made via `transferShares()`: \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.6.12/WstETH.sol#L73\n##### Recommendation\nIt is recommended to fix the code.",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/0.6.12/WstETH.sol",
      "content": "// SPDX-FileCopyrightText: 2021 Lido <info@lido.fi>\n\n// SPDX-License-Identifier: GPL-3.0\n\n/* See contracts/COMPILERS.md */\npragma solidity 0.6.12;\n\nimport \"@openzeppelin/contracts/drafts/ERC20Permit.sol\";\nimport \"./interfaces/IStETH.sol\";\n\n/**\n * @title StETH token wrapper with static balances.\n * @dev It's an ERC20 token that represents the account's share of the total\n * supply of stETH tokens. WstETH token's balance only changes on transfers,\n * unlike StETH that is also changed when oracles report staking rewards and\n * penalties. It's a \"power user\" token for DeFi protocols which don't\n * support rebasable tokens.\n *\n * The contract is also a trustless wrapper that accepts stETH tokens and mints\n * wstETH in return. Then the user unwraps, the contract burns user's wstETH\n * and sends user locked stETH in return.\n *\n * The contract provides the staking shortcut: user can send ETH with regular\n * transfer and get wstETH in return. The contract will send ETH to Lido submit\n * method, staking it and wrapping the received stETH.\n *\n */\ncontract WstETH is ERC20Permit {\n    IStETH public stETH;\n\n    /**\n     * @param _stETH address of the StETH token to wrap\n     */\n    constructor(IStETH _stETH)\n        public\n        ERC20Permit(\"Wrapped liquid staked Ether 2.0\")\n        ERC20(\"Wrapped liquid staked Ether 2.0\", \"wstETH\")\n    {\n        stETH = _stETH;\n    }\n\n    /**\n     * @notice Exchanges stETH to wstETH\n     * @param _stETHAmount amount of stETH to wrap in exchange for wstETH\n     * @dev Requirements:\n     *  - `_stETHAmount` must be non-zero\n     *  - msg.sender must approve at least `_stETHAmount` stETH to this\n     *    contract.\n     *  - msg.sender must have at least `_stETHAmount` of stETH.\n     * User should first approve _stETHAmount to the WstETH contract\n     * @return Amount of wstETH user receives after wrap\n     */\n    function wrap(uint256 _stETHAmount) external returns (uint256) {\n        require(_stETHAmount > 0, \"wstETH: can't wrap zero stETH\");\n        uint256 wstETHAmount = stETH.getSharesByPooledEth(_stETHAmount);\n        _mint(msg.sender, wstETHAmount);\n        stETH.transferFrom(msg.sender, address(this), _stETHAmount);\n        return wstETHAmount;\n    }\n\n    /**\n     * @notice Exchanges wstETH to stETH\n     * @param _wstETHAmount amount of wstETH to uwrap in exchange for stETH\n     * @dev Requirements:\n     *  - `_wstETHAmount` must be non-zero\n     *  - msg.sender must have at least `_wstETHAmount` wstETH.\n     * @return Amount of stETH user receives after unwrap\n     */\n    function unwrap(uint256 _wstETHAmount) external returns (uint256) {\n        require(_wstETHAmount > 0, \"wstETH: zero amount unwrap not allowed\");\n        uint256 stETHAmount = stETH.getPooledEthByShares(_wstETHAmount);\n        _burn(msg.sender, _wstETHAmount);\n        stETH.transfer(msg.sender, stETHAmount);\n        return stETHAmount;\n    }\n\n    /**\n    * @notice Shortcut to stake ETH and auto-wrap returned stETH\n    */\n    receive() external payable {\n        uint256 shares = stETH.submit{value: msg.value}(address(0));\n        _mint(msg.sender, shares);\n    }\n\n    /**\n     * @notice Get amount of wstETH for a given amount of stETH\n     * @param _stETHAmount amount of stETH\n     * @return Amount of wstETH for a given stETH amount\n     */\n    function getWstETHByStETH(uint256 _stETHAmount) external view returns (uint256) {\n        return stETH.getSharesByPooledEth(_stETHAmount);\n    }\n\n    /**\n     * @notice Get amount of stETH for a given amount of wstETH\n     * @param _wstETHAmount amount of wstETH\n     * @return Amount of stETH for a given wstETH amount\n     */\n    function getStETHByWstETH(uint256 _wstETHAmount) external view returns (uint256) {\n        return stETH.getPooledEthByShares(_wstETHAmount);\n    }\n\n    /**\n     * @notice Get amount of stETH for a one wstETH\n     * @return Amount of stETH for 1 wstETH\n     */\n    function stEthPerToken() external view returns (uint256) {\n        return stETH.getPooledEthByShares(1 ether);\n    }\n\n    /**\n     * @notice Get amount of wstETH for a one stETH\n     * @return Amount of wstETH for a 1 stETH\n     */\n    function tokensPerStEth() external view returns (uint256) {\n        return stETH.getSharesByPooledEth(1 ether);\n    }\n}"
    }
  ]
}