{
  "Title": "[G-05] Save gas with the use of the import statement",
  "Content": "\nWhile the following two critical fee values are assigned in the constructor, there is no zero value control. This means that if both state variables are started with a possible value of ``0``, the contract must be deployed again. This possibility means gas consumption.\n\nZero value control is the most error-prone value control since zero value is assigned in case of no value entry due to EVM design.\n\nIn addition, since the immutable value will be changed once, adding a zero value control does not cause high gas consumption.\n\n```solidity\npackages\\v2-pool\\src\\TimeswapV2PoolFactory.sol:\n  37:     constructor(address chosenOwner, uint256 chosenTransactionFee, uint256 chosenProtocolFee) OwnableTwoSteps(chosenOwner) {\n  38:         if (chosenTransactionFee > type(uint16).max) revert IncorrectFeeInitialization(chosenTransactionFee);\n  39:         if (chosenProtocolFee > type(uint16).max) revert IncorrectFeeInitialization(chosenProtocolFee);\n  40: \n  41:         transactionFee = chosenTransactionFee;\n  42:         protocolFee = chosenProtocolFee;\n  43:     }\n```\nhttps://github.com/code-423n4/2023-01-timeswap/blob/main/packages/v2-pool/src/TimeswapV2PoolFactory.sol#L37-L43\n\n\n**Recommendation:**\n\nIt is recommended to perform a zero value check for critical value assignments.\n\nAdd zero check for immutable values when assigning values in critical constructor.\n\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/reports/2023-01-timeswap",
  "Code": [
    {
      "filename": "packages/v2-pool/src/TimeswapV2PoolFactory.sol",
      "content": "//SPDX-License-Identifier: Unlicense\npragma solidity =0.8.8;\n\nimport {Ownership} from \"@timeswap-labs/v2-library/src/Ownership.sol\";\n\nimport {OptionPairLibrary} from \"@timeswap-labs/v2-option/src/libraries/OptionPair.sol\";\n\nimport {ITimeswapV2PoolFactory} from \"./interfaces/ITimeswapV2PoolFactory.sol\";\n\nimport {TimeswapV2PoolDeployer} from \"./TimeswapV2PoolDeployer.sol\";\n\nimport {Error} from \"@timeswap-labs/v2-library/src/Error.sol\";\n\nimport {OwnableTwoSteps} from \"./base/OwnableTwoSteps.sol\";\n\ncontract TimeswapV2PoolFactory is ITimeswapV2PoolFactory, TimeswapV2PoolDeployer, OwnableTwoSteps {\n    using OptionPairLibrary for address;\n    using Ownership for address;\n\n    /// @dev Revert when fee initialization is chosen to be larger than uint16.\n    /// @param fee The chosen fee.\n    error IncorrectFeeInitialization(uint256 fee);\n\n    /* ===== MODEL ===== */\n\n    /// @inheritdoc ITimeswapV2PoolFactory\n    uint256 public immutable override transactionFee;\n    /// @inheritdoc ITimeswapV2PoolFactory\n    uint256 public immutable override protocolFee;\n\n    mapping(address => address) private pairs;\n\n    address[] public override getByIndex;\n\n    /* ===== INIT ===== */\n\n    constructor(address chosenOwner, uint256 chosenTransactionFee, uint256 chosenProtocolFee) OwnableTwoSteps(chosenOwner) {\n        if (chosenTransactionFee > type(uint16).max) revert IncorrectFeeInitialization(chosenTransactionFee);\n        if (chosenProtocolFee > type(uint16).max) revert IncorrectFeeInitialization(chosenProtocolFee);\n\n        transactionFee = chosenTransactionFee;\n        protocolFee = chosenProtocolFee;\n    }\n\n    /* ===== VIEW ===== */\n\n    /// @inheritdoc ITimeswapV2PoolFactory\n    function get(address optionPair) external view override returns (address pair) {\n        pair = pairs[optionPair];\n    }\n\n    function numberOfPairs() external view override returns (uint256) {\n        return getByIndex.length;\n    }\n\n    /* ===== UPDATE ===== */\n\n    /// @inheritdoc ITimeswapV2PoolFactory\n    function create(address optionPair) external override returns (address pair) {\n        if (optionPair == address(0)) Error.zeroAddress();\n\n        pair = pairs[optionPair];\n        if (pair != address(0)) Error.zeroAddress();\n\n        pair = deploy(address(this), optionPair, transactionFee, protocolFee);\n\n        pairs[optionPair] = pair;\n\n        emit Create(msg.sender, optionPair, pair);\n    }\n}"
    }
  ]
}