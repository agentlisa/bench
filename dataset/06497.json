{
  "Title": "[G-07] Make 3 event parameters indexed when possible",
  "Content": "\nItâ€™s the most gas efficient to make up to 3 event parameters indexed. If there are less than 3 parameters, you need to make all parameters indexed.\n\n[Reference](https://code4rena.com/reports/2023-01-drips#g-05-make-3-event-parameters-indexed-when-possible)\n\n<details>\n\n```solidity\nFile:  src/erc-20/interfaces/IERC20Boost.sol\n222   event UpdateUserBoost(address indexed user, uint256 updatedBoost);\n\n225   event DecrementUserGaugeBoost(address indexed user, address indexed gauge, uint256 UpdatedBoost);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/erc-20/interfaces/IERC20Boost.sol#L222\n\n```solidity\nFile:  src/erc-20/interfaces/IERC20Gauges.sol\n246    event IncrementGaugeWeight(address indexed user, address indexed gauge, uint256 weight, uint32 cycleEnd);\n\n249    event DecrementGaugeWeight(address indexed user, address indexed gauge, uint256 weight, uint32 cycleEnd);\n\n258    event MaxGaugesUpdate(uint256 oldMaxGauges, uint256 newMaxGauges);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/erc-20/interfaces/IERC20Gauges.sol#L246\n\n```solidity\nFile: src/erc-20/interfaces/IERC20MultiVotes.sol\n147    event MaxDelegatesUpdate(uint256 oldMaxDelegates, uint256 newMaxDelegates);\n\n153    event Delegation(address indexed delegator, address indexed delegate, uint256 amount);\n\n159    event DelegateVotesChanged(address indexed delegate, uint256 previousBalance, uint256 newBalance);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/erc-20/interfaces/IERC20MultiVotes.sol#L147\n\n```solidity\nFile:  src/erc-4626/interfaces/IERC4626.sol\n93    event Deposit(address indexed caller, address indexed owner, uint256 assets, uint256 shares);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/erc-4626/interfaces/IERC4626.sol#L93\n\n```solidity\nFile:  src/erc-4626/interfaces/IERC4626DepositOnly.sol\n64    event Deposit(address indexed caller, address indexed owner, uint256 assets, uint256 shares);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/erc-4626/interfaces/IERC4626DepositOnly.sol#L64\n\n```solidity\nFile:  src/erc-4626/interfaces/IERC4626MultiToken.sol\n159    event Deposit(address indexed caller, address indexed owner, uint256[] assets, uint256 shares);\n\n178    event AssetAdded(address asset, uint256 weight);\n\n184    event AssetRemoved(address asset);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/erc-4626/interfaces/IERC4626MultiToken.sol#L159\n\n```solidity\nFile:  src/erc-4626/interfaces/IUlyssesERC4626.sol\n86   event Deposit(address indexed caller, address indexed owner, uint256 assets, uint256 shares);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/erc-4626/interfaces/IUlyssesERC4626.sol#L86\n\n```solidity\nFile:  src/gauges/interfaces/IBaseV2GaugeManager.sol\n111    event AddedGaugeFactory(address gaugeFactory);\n\n114    event RemovedGaugeFactory(address gaugeFactory);\n\n117    event ChangedbHermesGaugeOwner(address newOwner);\n\n120    event ChangedAdmin(address newAdmin);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/gauges/interfaces/IBaseV2GaugeManager.sol#L111\n\n```solidity\nFile: src/governance/GovernorBravoInterfaces.sol\n6     event ProposalCreated(\n        uint256 id,\n        address proposer,\n        address[] targets,\n        uint256[] values,\n        string[] signatures,\n        bytes[] calldatas,\n        uint256 startBlock,\n        uint256 endBlock,\n        string description\n    );\n24    event VoteCast(address indexed voter, uint256 proposalId, uint8 support, uint256 votes, string reason);\n\n27    event ProposalCanceled(uint256 id);\n\n30    event ProposalQueued(uint256 id, uint256 eta);\n\n33    event ProposalExecuted(uint256 id);\n\n36    event VotingDelaySet(uint256 oldVotingDelay, uint256 newVotingDelay);\n\n39    event VotingPeriodSet(uint256 oldVotingPeriod, uint256 newVotingPeriod);\n\n42    event NewImplementation(address oldImplementation, address newImplementation);\n\n45    event ProposalThresholdSet(uint256 oldProposalThreshold, uint256 newProposalThreshold);\n\n48    event NewPendingAdmin(address oldPendingAdmin, address newPendingAdmin);\n\n51    event NewAdmin(address oldAdmin, address newAdmin);\n\n54    event WhitelistAccountExpirationSet(address account, uint256 expiration);\n\n57    event WhitelistGuardianSet(address oldGuardian, address newGuardian);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/governance/GovernorBravoInterfaces.sol#L6\n\n```solidity\nFile:  src/hermes/interfaces/IBaseV2Minter.sol\n109    event Mint(address indexed sender, uint256 weekly, uint256 circulatingSupply, uint256 growth, uint256 dao_share);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/hermes/interfaces/IBaseV2Minter.sol#L109\n\n```solidity\nFile:  src/hermes/interfaces/IUtilityManager.sol\n82    event ForfeitWeight(address indexed user, uint256 amount);\n\n85    event ForfeitBoost(address indexed user, uint256 amount);\n\n88    event ForfeitGovernance(address indexed user, uint256 amount);\n\n91    event ClaimWeight(address indexed user, uint256 amount);\n\n94    event ClaimBoost(address indexed user, uint256 amount);\n\n97    event ClaimGovernance(address indexed user, uint256 amount);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/hermes/interfaces/IUtilityManager.sol#L82\n\n```solidity\nFile:  src/maia/interfaces/IERC4626PartnerManager.sol\n78    event AccrueRewards(address indexed user, uint256 rewardsDelta, uint256 rewardsIndex);\n\n85    event ClaimRewards(address indexed user, uint256 amount);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/maia/interfaces/IERC4626PartnerManager.sol#L78\n\n```solidity\nFile:  src/rewards/interfaces/IFlywheelAcummulatedRewards.sol\n42    event NewRewardsCycle(uint32 indexed start, uint256 indexed end, uint256 reward);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/rewards/interfaces/IFlywheelAcummulatedRewards.sol#L42\n\n```solidity\nFile:  src/rewards/interfaces/IFlywheelCore.sol\n121    event AccrueRewards(ERC20 indexed strategy, address indexed user, uint256 rewardsDelta, uint256 rewardsIndex);\n\n128    event ClaimRewards(address indexed user, uint256 amount);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/rewards/interfaces/IFlywheelCore.sol#L121\n\n```solidity\nFile:  src/rewards/interfaces/IFlywheelGaugeRewards.sol\n93    event CycleStart(uint32 indexed cycleStart, uint256 rewardAmount);\n\n96    event QueueRewards(address indexed gauge, uint32 indexed cycleStart, uint256 rewardAmount);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/rewards/interfaces/IFlywheelGaugeRewards.sol#L93\n\n```solidity\nFile:  src/talos/TalosStrategyVanilla.sol\n165    event CollectFees(uint256 feesFromPool0, uint256 feesFromPool1, uint256 usersFees0, uint256 usersFees1);\n\n170    event CompoundFees(uint256 amount0, uint256 amount1);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/talos/TalosStrategyVanilla.sol#L165\n\n```solidity\nFile:  src/talos/interfaces/ITalosBaseStrategy.sol\n187    event RewardPaid(address indexed sender, uint256 fees0, uint256 fees1);\n\n235    event Rerange(uint256 indexed tokenId, int24 tickLower, int24 tickUpper, uint256 amount0, uint256 amount1);\n\n240    event Snapshot(uint256 totalAmount0, uint256 totalAmount1);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/talos/interfaces/ITalosBaseStrategy.sol#L187\n\n```solidity\nFile:  src/talos/libraries/PoolActions.sol\n23     event Snapshot(uint256 totalAmount0, uint256 totalAmount1);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/talos/libraries/PoolActions.sol#L23\n\n```solidity\nFile:  src/talos/libraries/PoolVariables.sol\n28    event Snapshot(uint256 totalAmount0, uint256 totalAmount1);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/talos/libraries/PoolVariables.sol#L28\n\n```solidity\nFile:  src/ulysses-amm/interfaces/IUlyssesPool.sol\n237    event Swap(address indexed caller, uint256 indexed poolId, uint256 assets);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/ulysses-amm/interfaces/IUlyssesPool.sol#L237\n\n```solidity\nFile:  src/ulysses-omnichain/interfaces/IBranchBridgeAgent.sol\n281    event LogCallin(bytes1 selector, bytes data, uint256 fromChainId);\n\n282    event LogCallout(bytes1 selector, bytes data, uint256, uint256 toChainId);\n\n293    event LogCalloutFail(bytes1 selector, bytes data, uint256 toChainId);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/ulysses-omnichain/interfaces/IBranchBridgeAgent.sol#L281\n\n```solidity\nFile:  src/ulysses-omnichain/interfaces/IBranchPort.sol\n198    event DebtCreated(address indexed _strategy, address indexed _token, uint256 _amount);\n\n199    event DebtRepaid(address indexed _strategy, address indexed _token, uint256 _amount);\n\n201    event StrategyTokenAdded(address indexed _token, uint256 _minimumReservesRatio);\n\n202    event StrategyTokenToggled(address indexed _token);\n\n\n204    event PortStrategyAdded(address indexed _portStrategy, address indexed _token, uint256 _dailyManagementLimit);\n\n205    event PortStrategyToggled(address indexed _portStrategy, address indexed _token);\n\n206    event PortStrategyUpdated(address indexed _portStrategy, address indexed _token, uint256 _dailyManagementLimit);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/ulysses-omnichain/interfaces/IBranchPort.sol#L198\n\n```solidity\nFile:  src/ulysses-omnichain/interfaces/IRootBridgeAgent.sol\n378    event LogCallin(bytes1 selector, bytes data, uint24 fromChainId);\n\n379    event LogCallout(bytes1 selector, bytes data, uint256, uint24 toChainId);\n\n380    event LogCalloutFail(bytes1 selector, bytes data, uint24 toChainId);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/ulysses-omnichain/interfaces/IRootBridgeAgent.sol#L378\n\n```solidity\nFile:  src/ulysses-omnichain/interfaces/IRootPort.sol\n315    event BridgeAgentAdded(address indexed bridgeAgent, address manager);\n\n322    event VirtualAccountCreated(address indexed user, address account);\n\n324    event LocalTokenAdded(\n        address indexed underlyingAddress, address localAddress, address globalAddress, uint24 chainId\n    );\n327    event GlobalTokenAdded(address indexed localAddress, address indexed globalAddress, uint24 chainId);    \n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/ulysses-omnichain/interfaces/IRootPort.sol#L315\n\n```solidity\nFile:  src/uni-v3-staker/interfaces/IUniswapV3Staker.sol\n264    event IncentiveCreated(IUniswapV3Pool indexed pool, uint256 startTime, uint256 reward);\n\n269    event IncentiveEnded(bytes32 indexed incentiveId, uint256 refund);\n\n281    event TokenStaked(uint256 indexed tokenId, bytes32 indexed incentiveId, uint128 liquidity);\n\n291    event RewardClaimed(address indexed to, uint256 reward);\n\n296    event BribeDepotUpdated(IUniswapV3Pool indexed uniswapV3Pool, address bribeDepot);\n```\n\nhttps://github.com/code-423n4/2023-05-maia/blob/main/src/uni-v3-staker/interfaces/IUniswapV3Staker.sol#L264\n\n</details>\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/reports/2023-05-maia",
  "Code": [
    {
      "filename": "src/erc-20/interfaces/IERC20Boost.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * @title  An ERC20 with an embedded attachment mechanism to keep track of boost allocations to gauges.\n *  @author Maia DAO (https://github.com/Maia-DAO)\n *  @notice This contract is meant to be used to represent a token that can boost holders' rewards in other contracts.\n *          Holders can have their boost attached to gauges and cannot transfer their bHermes until they remove their boost.\n *          Only gauges can attach and detach boost from a user. The current user's boost and total supply are stored when attaching.\n *          The boost is then detached when the user removes their boost or when the gauge is removed.\n *          A \"gauge\" is represented by an address that distributes rewards to users periodically or continuously.\n *\n *          For example, gauges can be used to direct token emissions, similar to Curve or Hermes V1.\n *          Alternatively, gauges can be used to direct another quantity such as relative access to a line of credit.\n *          This contract should serve as reference for the amount of boost a user has allocated to a gauge.\n *          Then liquidity per user should be caculated by using this formula, from curve finance:\n *          min(UserLiquidity, (40 * UserLiquidity) + (60 * TotalLiquidity * UserBoostBalance / BoostTotal))\n *\n *          \"Live\" gauges are in the set.\n *          Users can only be attached to live gauges but can detach from live or deprecated gauges.\n *          Gauges can be deprecated and reinstated; and will maintain any non-removed boost from before.\n *\n *  @dev    SECURITY NOTES: decrementGaugeAllBoost can run out of gas.\n *          Gauges should be removed individually until decrementGaugeAllBoost can be called.\n *\n *          After having the boost attached, getUserBoost() will return the maximum boost a user had allocated to all gauges.\n *\n *          Boost state is preserved on the gauge and user level even when a gauge is removed, in case it is re-added.\n */\ninterface IERC20Boost {\n    /*//////////////////////////////////////////////////////////////\n                                STRUCTS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice User allocated boost to a gauge and bHermes total supply.\n     * @param userGaugeBoost User allocated boost to a gauge.\n     * @param totalGaugeBoost bHermes total supply when a user allocated the boost.\n     */\n    struct GaugeState {\n        uint128 userGaugeBoost;\n        uint128 totalGaugeBoost;\n    }\n\n    /*///////////////////////////////////////////////////////////////\n                            GAUGE STATE\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice User allocated boost to a gauge and the bHermes total supply.\n     * @param user User address.\n     * @param gauge Gauge address.\n     * @return userGaugeBoost User allocated boost to a gauge.\n     * @return totalGaugeBoost The bHermes total supply when a user allocated the boost.\n     */\n    function getUserGaugeBoost(address user, address gauge)\n        external\n        view\n        returns (uint128 userGaugeBoost, uint128 totalGaugeBoost);\n\n    /*///////////////////////////////////////////////////////////////\n                            VIEW HELPERS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Maximum boost a user had allocated to all gauges since he last called decrementAllGaugesAllBoost().\n     * @param user User address.\n     * @return boost Maximum user allocated boost.\n     */\n    function getUserBoost(address user) external view returns (uint256 boost);\n\n    /**\n     * @notice returns the set of live gauges\n     */\n    function gauges() external view returns (address[] memory);\n\n    /**\n     * @notice returns a paginated subset of live gauges\n     *   @param offset the index of the first gauge element to read\n     *   @param num the number of gauges to return\n     */\n    function gauges(uint256 offset, uint256 num) external view returns (address[] memory values);\n\n    /**\n     * @notice returns true if `gauge` is not in deprecated gauges\n     */\n    function isGauge(address gauge) external view returns (bool);\n\n    /**\n     * @notice returns the number of live gauges\n     */\n    function numGauges() external view returns (uint256);\n\n    /**\n     * @notice returns the set of previously live but now deprecated gauges\n     */\n    function deprecatedGauges() external view returns (address[] memory);\n\n    /**\n     * @notice returns the number of live gauges\n     */\n    function numDeprecatedGauges() external view returns (uint256);\n\n    /**\n     * @notice returns the set of gauges the user has allocated to, they may be live or deprecated.\n     */\n    function freeGaugeBoost(address user) external view returns (uint256);\n\n    /**\n     * @notice returns the set of gauges the user has allocated to, they may be live or deprecated.\n     */\n    function userGauges(address user) external view returns (address[] memory);\n\n    /**\n     * @notice returns true if `gauge` is in user gauges\n     */\n    function isUserGauge(address user, address gauge) external view returns (bool);\n\n    /**\n     *  @notice returns a paginated subset of gauges the user has allocated to, they may be live or deprecated.\n     *  @param user the user to return gauges from.\n     *  @param offset the index of the first gauge element to read.\n     *  @param num the number of gauges to return.\n     */\n    function userGauges(address user, uint256 offset, uint256 num) external view returns (address[] memory values);\n\n    /**\n     * @notice returns the number of user gauges\n     */\n    function numUserGauges(address user) external view returns (uint256);\n\n    /*///////////////////////////////////////////////////////////////\n                        GAUGE OPERATIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice attach all user's boost to a gauge, only callable by the gauge.\n     *  @param user the user to attach the gauge to.\n     */\n    function attach(address user) external;\n\n    /**\n     * @notice detach all user's boost from a gauge, only callable by the gauge.\n     * @param user the user to detach the gauge from.\n     */\n    function detach(address user) external;\n\n    /*///////////////////////////////////////////////////////////////\n                        USER GAUGE OPERATIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Update geUserBoost for a user, loop through all _userGauges\n     * @param user the user to update the boost for.\n     */\n    function updateUserBoost(address user) external;\n\n    /**\n     * @notice Remove an amount of boost from a gauge\n     * @param gauge the gauge to remove boost from.\n     * @param boost the amount of boost to remove.\n     */\n    function decrementGaugeBoost(address gauge, uint256 boost) external;\n\n    /**\n     * @notice Remove all the boost from a gauge\n     * @param gauge the gauge to remove boost from.\n     */\n    function decrementGaugeAllBoost(address gauge) external;\n\n    /**\n     * @notice Remove an amount of boost from all user gauges\n     * @param boost the amount of boost to remove.\n     */\n    function decrementAllGaugesBoost(uint256 boost) external;\n\n    /**\n     * @notice Remove an amount of boost from all user gauges indexed\n     * @param boost the amount of boost to remove.\n     * @param offset the index of the first gauge element to read.\n     * @param num the number of gauges to return.\n     */\n    function decrementGaugesBoostIndexed(uint256 boost, uint256 offset, uint256 num) external;\n\n    /**\n     * @notice Remove all the boost from all user gauges\n     */\n    function decrementAllGaugesAllBoost() external;\n\n    /**\n     * @notice add a new gauge. Requires auth by `authority`.\n     */\n    function addGauge(address gauge) external;\n\n    /**\n     * @notice remove a new gauge. Requires auth by `authority`.\n     */\n    function removeGauge(address gauge) external;\n\n    /**\n     * @notice replace a gauge. Requires auth by `authority`.\n     */\n    function replaceGauge(address oldGauge, address newGauge) external;\n\n    /*///////////////////////////////////////////////////////////////\n                            EVENTS\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice emitted when adding a new gauge to the live set.\n    event AddGauge(address indexed gauge);\n\n    /// @notice emitted when removing a gauge from the live set.\n    event RemoveGauge(address indexed gauge);\n\n    /// @notice emmitted when a user attaches boost to a gauge.\n    event Attach(address indexed user, address indexed gauge, uint256 boost);\n\n    /// @notice emmitted when a user detaches boost from a gauge.\n    event Detach(address indexed user, address indexed gauge);\n\n    /// @notice emmitted when a user updates their boost.\n    event UpdateUserBoost(address indexed user, uint256 updatedBoost);\n\n    /// @notice emmitted when a user decrements their gauge boost.\n    event DecrementUserGaugeBoost(address indexed user, address indexed gauge, uint256 UpdatedBoost);\n\n    /*///////////////////////////////////////////////////////////////\n                            ERRORS\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice thrown when trying to increment or remove a non-live gauge, or add a live gauge.\n    error InvalidGauge();\n\n    /// @notice thrown when a gauge tries to attach a position and already has one attached.\n    error GaugeAlreadyAttached();\n\n    /// @notice thrown when a gauge tries to transfer a position but does not have enough free balance.\n    error AttachedBoost();\n}"
    },
    {
      "filename": "src/erc-20/interfaces/IERC20Gauges.sol",
      "content": "// SPDX-License-Identifier: MIT\n// Gauge weight logic inspired by Tribe DAO Contracts (flywheel-v2/src/token/ERC20Gauges.sol)\npragma solidity ^0.8.0;\n\n/**\n * @title  An ERC20 with an embedded \"Gauge\" style vote with liquid weights\n *  @author Maia DAO (https://github.com/Maia-DAO)\n *  @notice This contract is meant to be used to support gauge style votes with weights associated with resource allocation.\n *          Only after delegating to himself can a user allocate weight to a gauge.\n *          Holders can allocate weight in any proportion to supported gauges.\n *          A \"gauge\" is represented by an address that would receive the resources periodically or continuously.\n *\n *          For example, gauges can be used to direct token emissions, similar to Curve or Hermes V1.\n *          Alternatively, gauges can be used to direct another quantity such as relative access to a line of credit.\n *\n *          The contract's Ownable <https://github.com/Vectorized/solady/blob/main/src/auth/Ownable.sol> manages the gauge set and cap.\n *          \"Live\" gauges are in the set.\n *          Users can only add weight to live gauges but can remove weight from live or deprecated gauges.\n *          Gauges can be deprecated and reinstated; and will maintain any non-removed weight from before.\n *\n *  @dev    SECURITY NOTES: `maxGauges` is a critical variable to protect against gas DOS attacks upon token transfer.\n *          This must be low enough to allow complicated transactions to fit in a block.\n *\n *          Weight state is preserved on the gauge and user level even when a gauge is removed, in case it is re-added.\n *          This maintains the state efficiently, and global accounting is managed only on the `_totalWeight`\n */\ninterface IERC20Gauges {\n    /*//////////////////////////////////////////////////////////////\n                                STRUCTS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice a struct representing a user's weight allocation to a gauge\n     * @param storedWeight weight allocated to a gauge at the end of the last cycle\n     * @param currentWeight current weight allocated to a gauge\n     * @param currentCycle cycle in which the current weight was allocated\n     */\n    struct Weight {\n        uint112 storedWeight;\n        uint112 currentWeight;\n        uint32 currentCycle;\n    }\n\n    /*///////////////////////////////////////////////////////////////\n                            GAUGE STATE\n    //////////////////////////////////////////////////////////////*/\n    /**\n     * @notice a mapping from a user to their total allocated weight across all gauges\n     */\n    function getUserWeight(address) external view returns (uint112);\n\n    /**\n     * @notice the length of a gauge cycle\n     */\n    function gaugeCycleLength() external view returns (uint32);\n\n    /**\n     * @notice the period at the end of a cycle where votes cannot increment\n     */\n    function incrementFreezeWindow() external view returns (uint32);\n\n    /**\n     * @notice a mapping from users to gauges to a user's allocated weight to that gauge\n     */\n    function getUserGaugeWeight(address, address) external view returns (uint112);\n\n    /*///////////////////////////////////////////////////////////////\n                              VIEW HELPERS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice returns the end of the current cycle. This is the next unix timestamp which evenly divides `gaugeCycleLength`\n     */\n    function getGaugeCycleEnd() external view returns (uint32);\n\n    /**\n     * @notice returns the current weight of a given gauge\n     * @param gauge address of the gauge to get the weight from\n     */\n    function getGaugeWeight(address gauge) external view returns (uint112);\n\n    /**\n     * @notice returns the stored weight of a given gauge. This is the snapshotted weight as-of the end of the last cycle.\n     */\n    function getStoredGaugeWeight(address gauge) external view returns (uint112);\n\n    /**\n     * @notice returns the current total allocated weight\n     */\n    function totalWeight() external view returns (uint112);\n\n    /**\n     * @notice returns the stored total allocated weight\n     */\n    function storedTotalWeight() external view returns (uint112);\n\n    /**\n     * @notice returns the set of live gauges\n     */\n    function gauges() external view returns (address[] memory);\n\n    /**\n     * @notice returns a paginated subset of live gauges\n     *   @param offset the index of the first gauge element to read\n     *   @param num the number of gauges to return\n     */\n    function gauges(uint256 offset, uint256 num) external view returns (address[] memory values);\n\n    /**\n     * @notice returns true if `gauge` is not in deprecated gauges\n     */\n    function isGauge(address gauge) external view returns (bool);\n\n    /**\n     * @notice returns the number of live gauges\n     */\n    function numGauges() external view returns (uint256);\n\n    /**\n     * @notice returns the set of previously live but now deprecated gauges\n     */\n    function deprecatedGauges() external view returns (address[] memory);\n\n    /**\n     * @notice returns the number of live gauges\n     */\n    function numDeprecatedGauges() external view returns (uint256);\n\n    /**\n     * @notice returns the set of gauges the user has allocated to, may be live or deprecated.\n     */\n    function userGauges(address user) external view returns (address[] memory);\n\n    /**\n     * @notice returns true if `gauge` is in user gauges\n     */\n    function isUserGauge(address user, address gauge) external view returns (bool);\n\n    /**\n     * @notice returns a paginated subset of gauges the user has allocated to, may be live or deprecated.\n     *   @param user the user to return gauges from.\n     *   @param offset the index of the first gauge element to read.\n     *   @param num the number of gauges to return.\n     */\n    function userGauges(address user, uint256 offset, uint256 num) external view returns (address[] memory values);\n\n    /**\n     * @notice returns the number of user gauges\n     */\n    function numUserGauges(address user) external view returns (uint256);\n\n    /**\n     * @notice helper function for calculating the proportion of a `quantity` allocated to a gauge\n     *  @param gauge the gauge to calculate the allocation of\n     *  @param quantity a representation of a resource to be shared among all gauges\n     *  @return the proportion of `quantity` allocated to `gauge`. Returns 0 if a gauge is not live, even if it has weight.\n     */\n    function calculateGaugeAllocation(address gauge, uint256 quantity) external view returns (uint256);\n\n    /*///////////////////////////////////////////////////////////////\n                        USER GAUGE OPERATIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice increment a gauge with some weight for the caller\n     *  @param gauge the gauge to increment\n     *  @param weight the amount of weight to increment on a gauge\n     *  @return newUserWeight the new user weight\n     */\n    function incrementGauge(address gauge, uint112 weight) external returns (uint112 newUserWeight);\n\n    /**\n     * @notice increment a list of gauges with some weights for the caller\n     *  @param gaugeList the gauges to increment\n     *  @param weights the weights to increment by\n     *  @return newUserWeight the new user weight\n     */\n    function incrementGauges(address[] memory gaugeList, uint112[] memory weights)\n        external\n        returns (uint256 newUserWeight);\n\n    /**\n     * @notice decrement a gauge with some weight for the caller\n     *  @param gauge the gauge to decrement\n     *  @param weight the amount of weight to decrement on a gauge\n     *  @return newUserWeight the new user weight\n     */\n    function decrementGauge(address gauge, uint112 weight) external returns (uint112 newUserWeight);\n\n    /**\n     * @notice decrement a list of gauges with some weights for the caller\n     *  @param gaugeList the gauges to decrement\n     *  @param weights the list of weights to decrement on the gauges\n     *  @return newUserWeight the new user weight\n     */\n    function decrementGauges(address[] memory gaugeList, uint112[] memory weights)\n        external\n        returns (uint112 newUserWeight);\n\n    /*///////////////////////////////////////////////////////////////\n                        ADMIN GAUGE OPERATIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice the default maximum amount of gauges a user can allocate to.\n     * @dev if this number is ever lowered, or a contract has an override, then existing addresses MAY have more gauges allocated to. Use `numUserGauges` to check this.\n     */\n    function maxGauges() external view returns (uint256);\n\n    /**\n     * @notice an approved list for contracts to go above the max gauge limit.\n     */\n    function canContractExceedMaxGauges(address) external view returns (bool);\n\n    /**\n     * @notice add a new gauge. Requires auth by `authority`.\n     */\n    function addGauge(address gauge) external returns (uint112);\n\n    /**\n     * @notice remove a new gauge. Requires auth by `authority`.\n     */\n    function removeGauge(address gauge) external;\n\n    /**\n     * @notice replace a gauge. Requires auth by `authority`.\n     */\n    function replaceGauge(address oldGauge, address newGauge) external;\n\n    /**\n     * @notice set the new max gauges. Requires auth by `authority`.\n     * @dev if this is set to a lower number than the current max, users MAY have more gauges active than the max. Use `numUserGauges` to check this.\n     */\n    function setMaxGauges(uint256 newMax) external;\n\n    /**\n     * @notice set the canContractExceedMaxGauges flag for an account.\n     */\n    function setContractExceedMaxGauges(address account, bool canExceedMax) external;\n\n    /*///////////////////////////////////////////////////////////////\n                            EVENTS\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice emitted when incrementing a gauge\n    event IncrementGaugeWeight(address indexed user, address indexed gauge, uint256 weight, uint32 cycleEnd);\n\n    /// @notice emitted when decrementing a gauge\n    event DecrementGaugeWeight(address indexed user, address indexed gauge, uint256 weight, uint32 cycleEnd);\n\n    /// @notice emitted when adding a new gauge to the live set.\n    event AddGauge(address indexed gauge);\n\n    /// @notice emitted when removing a gauge from the live set.\n    event RemoveGauge(address indexed gauge);\n\n    /// @notice emitted when updating the max number of gauges a user can delegate to.\n    event MaxGaugesUpdate(uint256 oldMaxGauges, uint256 newMaxGauges);\n\n    /// @notice emitted when changing a contract's approval to go over the max gauges.\n    event CanContractExceedMaxGaugesUpdate(address indexed account, bool canContractExceedMaxGauges);\n\n    /*///////////////////////////////////////////////////////////////\n                            ERRORS\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice thrown when trying to increment/decrement a mismatched number of gauges and weights.\n    error SizeMismatchError();\n\n    /// @notice thrown when trying to increment over the max allowed gauges.\n    error MaxGaugeError();\n\n    /// @notice thrown when incrementing over a user's free weight.\n    error OverWeightError();\n\n    /// @notice thrown when incrementing during the frozen window.\n    error IncrementFreezeError();\n\n    /// @notice thrown when trying to increment or remove a non-live gauge, or add a live gauge.\n    error InvalidGaugeError();\n}"
    },
    {
      "filename": "src/erc-20/interfaces/IERC20MultiVotes.sol",
      "content": "// SPDX-License-Identifier: MIT\n// Voting logic inspired by OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/ERC20Votes.sol)\npragma solidity ^0.8.0;\n\n/**\n * @title ERC20 Multi-Delegation Voting contract\n *  @notice an ERC20 extension that allows delegations to multiple delegatees up to a user's balance on a given block.\n */\ninterface IERC20MultiVotes {\n    /*//////////////////////////////////////////////////////////////\n                                STRUCTS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice A checkpoint for marking the number of votes from a given block.\n     * @param fromBlock the block number that the votes were delegated.\n     * @param votes the number of votes delegated.\n     */\n    struct Checkpoint {\n        uint32 fromBlock;\n        uint224 votes;\n    }\n\n    /*///////////////////////////////////////////////////////////////\n                        VOTE CALCULATION LOGIC\n    //////////////////////////////////////////////////////////////*/\n    /**\n     * @notice Get the `pos`-th checkpoint for `account`.\n     */\n    function checkpoints(address account, uint32 pos) external view returns (Checkpoint memory);\n\n    /**\n     * @notice Get number of checkpoints for `account`.\n     */\n    function numCheckpoints(address account) external view returns (uint32);\n\n    /**\n     * @notice Gets the amount of unallocated votes for `account`.\n     * @param account the address to get free votes of.\n     * @return the amount of unallocated votes.\n     */\n    function freeVotes(address account) external view returns (uint256);\n\n    /**\n     * @notice Gets the current votes balance for `account`.\n     * @param account the address to get votes of.\n     * @return the amount of votes.\n     */\n    function getVotes(address account) external view returns (uint256);\n\n    /**\n     * @notice helper function exposing the amount of weight available to allocate for a user\n     */\n    function userUnusedVotes(address user) external view returns (uint256);\n\n    /**\n     * @notice Retrieve the number of votes for `account` at the end of `blockNumber`.\n     * @param account the address to get votes of.\n     * @param blockNumber the block to calculate votes for.\n     * @return the amount of votes.\n     */\n    function getPriorVotes(address account, uint256 blockNumber) external view returns (uint256);\n\n    /*///////////////////////////////////////////////////////////////\n                        ADMIN OPERATIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice the maximum amount of delegates for a user at a given time\n     */\n    function maxDelegates() external view returns (uint256);\n\n    /**\n     * @notice an approve list for contracts to go above the max delegate limit.\n     */\n    function canContractExceedMaxDelegates(address) external view returns (bool);\n\n    /**\n     * @notice set the new max delegates per user. Requires auth by `authority`.\n     */\n    function setMaxDelegates(uint256 newMax) external;\n\n    /**\n     * @notice set the canContractExceedMaxDelegates flag for an account.\n     */\n    function setContractExceedMaxDelegates(address account, bool canExceedMax) external;\n\n    /**\n     * @notice mapping from a delegator to the total number of delegated votes.\n     */\n    function userDelegatedVotes(address) external view returns (uint256);\n\n    /*///////////////////////////////////////////////////////////////\n                        DELEGATION LOGIC\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Get the amount of votes currently delegated by `delegator` to `delegatee`.\n     * @param delegator the account which is delegating votes to `delegatee`.\n     * @param delegatee the account receiving votes from `delegator`.\n     * @return the total amount of votes delegated to `delegatee` by `delegator`\n     */\n    function delegatesVotesCount(address delegator, address delegatee) external view returns (uint256);\n\n    /**\n     * @notice Get the list of delegates from `delegator`.\n     * @param delegator the account which is delegating votes to delegates.\n     * @return the list of delegated accounts.\n     */\n    function delegates(address delegator) external view returns (address[] memory);\n\n    /**\n     * @notice Get the number of delegates from `delegator`.\n     * @param delegator the account which is delegating votes to delegates.\n     * @return the number of delegated accounts.\n     */\n    function delegateCount(address delegator) external view returns (uint256);\n\n    /**\n     * @notice Delegate `amount` votes from the sender to `delegatee`.\n     * @param delegatee the receivier of votes.\n     * @param amount the amount of votes received.\n     * @dev requires \"freeVotes(msg.sender) > amount\" and will not exceed max delegates\n     */\n    function incrementDelegation(address delegatee, uint256 amount) external;\n\n    /**\n     * @notice Undelegate `amount` votes from the sender from `delegatee`.\n     * @param delegatee the receivier of undelegation.\n     * @param amount the amount of votes taken away.\n     */\n    function undelegate(address delegatee, uint256 amount) external;\n\n    /**\n     * @notice Delegate all votes `newDelegatee`. First undelegates from an existing delegate. If `newDelegatee` is zero, only undelegates.\n     * @param newDelegatee the receiver of votes.\n     * @dev undefined for `delegateCount(msg.sender) > 1`\n     * NOTE This is meant for backward compatibility with the `ERC20Votes` and `ERC20VotesComp` interfaces from OpenZeppelin.\n     */\n    function delegate(address newDelegatee) external;\n\n    /*///////////////////////////////////////////////////////////////\n                            EVENTS\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice emitted when updating the maximum amount of delegates per user\n    event MaxDelegatesUpdate(uint256 oldMaxDelegates, uint256 newMaxDelegates);\n\n    /// @notice emitted when updating the canContractExceedMaxDelegates flag for an account\n    event CanContractExceedMaxDelegatesUpdate(address indexed account, bool canContractExceedMaxDelegates);\n\n    /// @dev Emitted when a `delegator` delegates `amount` votes to `delegate`.\n    event Delegation(address indexed delegator, address indexed delegate, uint256 amount);\n\n    /// @dev Emitted when a `delegator` undelegates `amount` votes from `delegate`.\n    event Undelegation(address indexed delegator, address indexed delegate, uint256 amount);\n\n    /// @dev Emitted when a token transfer or delegate change results in changes to an account's voting power.\n    event DelegateVotesChanged(address indexed delegate, uint256 previousBalance, uint256 newBalance);\n\n    /// @notice An event thats emitted when an account changes its delegate\n    /// @dev this is used for backward compatibility with OZ interfaces for ERC20Votes and ERC20VotesComp.\n    event DelegateChanged(address indexed delegator, address indexed fromDelegate, address indexed toDelegate);\n\n    /*///////////////////////////////////////////////////////////////\n                            ERRORS\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice thrown when trying to read from an invalid block.\n    error BlockError();\n\n    /// @dev thrown when attempting to delegate more votes than an address has free, or exceeding the max delegates\n    error DelegationError();\n\n    /// @dev thrown when attempting to undelegate more votes than the delegatee has unused.\n    error UndelegationVoteError();\n}"
    },
    {
      "filename": "src/erc-4626/interfaces/IERC4626.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity >=0.8.0;\n\ninterface IERC4626 {\n    /**\n     * @notice Deposit assets into the Vault.\n     * @param assets The amount of assets to deposit.\n     * @param receiver The address to receive the shares.\n     */\n    function deposit(uint256 assets, address receiver) external returns (uint256 shares);\n\n    /**\n     * @notice Mint shares from the Vault.\n     * @param shares The amount of shares to mint.\n     * @param receiver The address to receive the shares.\n     */\n    function mint(uint256 shares, address receiver) external returns (uint256 assets);\n\n    /**\n     * @notice Withdraw assets from the Vault.\n     * @param assets The amount of assets to withdraw.\n     * @param receiver The address to receive the assets.\n     * @param owner The address to receive the shares.\n     */\n    function withdraw(uint256 assets, address receiver, address owner) external returns (uint256 shares);\n\n    /**\n     * @notice  Redeem shares from the Vault.\n     * @param shares The amount of shares to redeem.\n     * @param receiver The address to receive the assets.\n     * @param owner The address to receive the shares.\n     */\n    function redeem(uint256 shares, address receiver, address owner) external returns (uint256 assets);\n\n    /**\n     * @notice Calculates the amount of shares that would be received for a given amount of assets.\n     * @param assets The amount of assets to deposit.\n     */\n    function convertToShares(uint256 assets) external view returns (uint256);\n\n    /**\n     * @notice  Calculates the amount of assets that would be received for a given amount of shares.\n     * @param shares The amount of shares to redeem.\n     */\n    function convertToAssets(uint256 shares) external view returns (uint256);\n\n    /**\n     * @notice Preview the amount of shares that would be received for a given amount of assets.\n     */\n    function previewDeposit(uint256 assets) external view returns (uint256);\n\n    /**\n     * @notice Previews the amount of assets that would be received for minting a given amount of shares\n     * @param shares The amount of shares to mint\n     */\n    function previewMint(uint256 shares) external view returns (uint256);\n\n    /**\n     * @notice Previews the amount of shares that would be received for a withdraw of a given amount of assets.\n     * @param assets The amount of assets to withdraw.\n     */\n    function previewWithdraw(uint256 assets) external view returns (uint256);\n\n    /**\n     * @notice Previews the amount of assets that would be received for a redeem of a given amount of shares.\n     */\n    function previewRedeem(uint256 shares) external view returns (uint256);\n\n    /**\n     * @notice Returns the max amount of assets that can be deposited into the Vault.\n     */\n    function maxDeposit(address) external view returns (uint256);\n\n    /**\n     * @notice Returns the max amount of shares that can be minted from the Vault.\n     */\n    function maxMint(address) external view returns (uint256);\n\n    /**\n     * @notice Returns the max amount of assets that can be withdrawn from the Vault.\n     */\n    function maxWithdraw(address owner) external view returns (uint256);\n\n    /**\n     * @notice Returns the max amount of shares that can be redeemed from the Vault.\n     */\n    function maxRedeem(address owner) external view returns (uint256);\n\n    /*//////////////////////////////////////////////////////////////\n                                 EVENTS\n    ///////////"
    }
  ]
}