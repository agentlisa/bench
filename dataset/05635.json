{
  "Title": "[N-01] Misleading natspec",
  "Content": "\n[`WalletRegistry::registerWallet`](https://github.com/code-423n4/2023-10-brahma/blob/main/contracts/src/core/registries/WalletRegistry.sol#L31-L40):\n\n```solidity\nFile: contracts/src/core/registries/WalletRegistry.sol\n\n31:    /**\n32:     * @notice Registers a wallet\n33:     * @dev Can only be called by safe deployer or the wallet itself\n34:     */\n```\n\n> `Can only be called by safe deployer or the wallet itself`\n\nIt cannot be called by safe deployer, as it only instructs the wallet to call it upon setup (as it only registers `msg.sender`, it would then be the safe deployer address registered as a wallet).\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2023-10-brahma",
  "Code": [
    {
      "filename": "contracts/src/core/registries/WalletRegistry.sol",
      "content": "/// SPDX-License-Identifier: BUSL-1.1\n\n/// Copyright (C) 2023 Brahma.fi\n\npragma solidity 0.8.19;\n\nimport {AddressProviderService} from \"../AddressProviderService.sol\";\n\n/**\n * @title WalletRegistry\n * @author Brahma.fi\n * @notice Registry for wallet and sub account addresses\n */\ncontract WalletRegistry is AddressProviderService {\n    error AlreadyRegistered();\n    error InvalidSender();\n    error IsSubAccount();\n\n    event RegisterWallet(address indexed wallet);\n    event RegisterSubAccount(address indexed wallet, address indexed subAccount);\n\n    /// @notice subAccount addresses mapped to owner wallet\n    mapping(address subAccount => address wallet) public subAccountToWallet;\n    /// @notice wallet addresses mapped to list of subAccounts\n    mapping(address wallet => address[] subAccountList) public walletToSubAccountList;\n    /// @notice address of wallet mapped to boolean indicating if it's a wallet\n    mapping(address => bool) public isWallet;\n\n    constructor(address _addressProvider) AddressProviderService(_addressProvider) {}\n\n    /**\n     * @notice Registers a wallet\n     * @dev Can only be called by safe deployer or the wallet itself\n     */\n    function registerWallet() external {\n        if (isWallet[msg.sender]) revert AlreadyRegistered();\n        if (subAccountToWallet[msg.sender] != address(0)) revert IsSubAccount();\n        isWallet[msg.sender] = true;\n        emit RegisterWallet(msg.sender);\n    }\n\n    /**\n     * @notice Registers a sub account for a Safe\n     * @param _wallet Console account address, owner of sub account\n     * @param _subAccount Sub account address to register\n     * @dev Can only be called by safe deployer\n     */\n\n    function registerSubAccount(address _wallet, address _subAccount) external {\n        if (msg.sender != AddressProviderService._getAuthorizedAddress(_SAFE_DEPLOYER_HASH)) revert InvalidSender();\n        if (subAccountToWallet[_subAccount] != address(0)) revert AlreadyRegistered();\n        subAccountToWallet[_subAccount] = _wallet;\n        walletToSubAccountList[_wallet].push(_subAccount);\n        emit RegisterSubAccount(_wallet, _subAccount);\n    }\n\n    /**\n     * @notice sub account list getter\n     * @dev returns sub account list associated with _wallet\n     * @param _wallet safe address\n     * @return list of subAccounts for wallet\n     */\n    function getSubAccountsForWallet(address _wallet) external view returns (address[] memory) {\n        return walletToSubAccountList[_wallet];\n    }\n\n    /**\n     * @notice checks if _wallet owns _subAccount\n     * @param _wallet address of wallet\n     * @param _subAccount address of subAccount\n     * @return isWalletOwnerOfSubAccount\n     */\n    function isOwner(address _wallet, address _subAccount) external view returns (bool) {\n        return subAccountToWallet[_subAccount] == _wallet;\n    }\n}"
    }
  ]
}