{
  "Title": "Batch Events Lack Information",
  "Content": "The `CommitBatch`, `RevertBatch`, and `FinalizeBatch` events of the [`IScrollChain` interface](https://github.com/scroll-tech/scroll/blob/3bc8a3f5c6ac816ddffadca41024331dcf4d3064/contracts/src/L1/rollup/IScrollChain.sol#L10-L22) give crucial updates about the state of L2 finalization on L1. However, while the [`ScrollChain` `view` functions](https://github.com/scroll-tech/scroll/blob/3bc8a3f5c6ac816ddffadca41024331dcf4d3064/contracts/src/L1/rollup/IScrollChain.sol#L28-L42) work by querying the `batchIndex`, the events do not emit the `batchIndex` information.\n\n\nConsider emitting the indexed `batchIndex` together with the hash per event to help facilitate querying important information.\n\n\n***Update:** Resolved in [pull request #624](https://github.com/scroll-tech/scroll/pull/624) at commit [7e8bf3a](https://github.com/scroll-tech/scroll/pull/624/commits/7e8bf3a7c49c4aa355a3060c3e11020e505badc8).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/src/L1/rollup/IScrollChain.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.0;\n\ninterface IScrollChain {\n    /**********\n     * Events *\n     **********/\n\n    /// @notice Emitted when a new batch is committed.\n    /// @param batchHash The hash of the batch.\n    event CommitBatch(bytes32 indexed batchHash);\n\n    /// @notice revert a pending batch.\n    /// @param batchHash The hash of the batch\n    event RevertBatch(bytes32 indexed batchHash);\n\n    /// @notice Emitted when a batch is finalized.\n    /// @param batchHash The hash of the batch\n    /// @param stateRoot The state root in layer 2 after this batch.\n    /// @param withdrawRoot The merkle root in layer2 after this batch.\n    event FinalizeBatch(bytes32 indexed batchHash, bytes32 stateRoot, bytes32 withdrawRoot);\n\n    /*************************\n     * Public View Functions *\n     *************************/\n\n    /// @notice Return the batch hash of a committed batch.\n    /// @param batchIndex The index of the batch.\n    function committedBatches(uint256 batchIndex) external view returns (bytes32);\n\n    /// @notice Return the state root of a committed batch.\n    /// @param batchIndex The index of the batch.\n    function finalizedStateRoots(uint256 batchIndex) external view returns (bytes32);\n\n    /// @notice Return the message root of a committed batch.\n    /// @param batchIndex The index of the batch.\n    function withdrawRoots(uint256 batchIndex) external view returns (bytes32);\n\n    /// @notice Return whether the batch is finalized by batch index.\n    /// @param batchIndex The index of the batch.\n    function isBatchFinalized(uint256 batchIndex) external view returns (bool);\n\n    /*****************************\n     * Public Mutating Functions *\n     *****************************/\n\n    /// @notice Commit a batch of transactions on layer 1.\n    ///\n    /// @param version The version of current batch.\n    /// @param parentBatchHeader The header of parent batch, see the comments of `BatchHeaderV0Codec`.\n    /// @param chunks The list of encoded chunks, see the comments of `ChunkCodec`.\n    /// @param skippedL1MessageBitmap The bitmap indicates whether each L1 message is skipped or not.\n    function commitBatch(\n        uint8 version,\n        bytes calldata parentBatchHeader,\n        bytes[] memory chunks,\n        bytes calldata skippedL1MessageBitmap\n    ) external;\n\n    /// @notice Revert a pending batch.\n    /// @dev one can only revert unfinalized batches.\n    /// @param batchHeader The header of current batch, see the encoding in comments of `commitBatch`.\n    /// @param count The number of subsequent batches to revert, including current batch.\n    function revertBatch(bytes calldata batchHeader, uint256 count) external;\n\n    /// @notice Finalize a committed batch on layer 1.\n    /// @param batchHeader The header of current batch, see the encoding in comments of `commitBatch.\n    /// @param prevStateRoot The state root of parent batch.\n    /// @param postStateRoot The state root of current batch.\n    /// @param withdrawRoot The withdraw trie root of current batch.\n    /// @param aggrProof The aggregation proof for current batch.\n    function finalizeBatchWithProof(\n        bytes calldata batchHeader,\n        bytes32 prevStateRoot,\n        bytes32 postStateRoot,\n        bytes32 withdrawRoot,\n        bytes calldata aggrProof\n    ) external;\n}"
    }
  ]
}