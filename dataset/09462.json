{
  "Title": "[N-05] Use a more recent version of solidity",
  "Content": "\nUse a solidity version of at least 0.8.12 to get `string.concat()` to be used instead of `abi.encodePacked(<str>,<str>)`\n\n1.  File: contracts/ManagedIndex.sol (line [3](https://github.com/code-423n4/2022-04-phuture/blob/594459d0865fb6603ba388b53f3f01648f5bb6fb/contracts/ManagedIndex.sol#L3))\n\n```solidity\npragma solidity >=0.8.7;\n```\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2022-04-phuture",
  "Code": [
    {
      "filename": "contracts/ManagedIndex.sol",
      "content": "// SPDX-License-Identifier: BUSL-1.1\n\npragma solidity >=0.8.7;\n\nimport \"./interfaces/IManagedIndex.sol\";\nimport \"./interfaces/IIndexFactory.sol\";\nimport \"./interfaces/IManagedIndexReweightingLogic.sol\";\n\nimport \"./BaseIndex.sol\";\n\n/// @title Managed index\n/// @notice Contains initialization and reweighting logic\ncontract ManagedIndex is IManagedIndex, BaseIndex {\n    using EnumerableSet for EnumerableSet.AddressSet;\n\n    /// @notice Role for index reweighting\n    bytes32 private REWEIGHT_INDEX_ROLE;\n\n    constructor() BaseIndex(msg.sender) {\n        REWEIGHT_INDEX_ROLE = keccak256(abi.encodePacked(\"REWEIGHT_PERMISSION\", address(this)));\n    }\n\n    /// @notice Index initialization with assets and their weights\n    /// @dev Method is called by factory\n    /// @param _assets Assets list for the index\n    /// @param _weights List of assets corresponding weights\n    function initialize(address[] calldata _assets, uint8[] calldata _weights) external {\n        require(msg.sender == factory, \"ManagedIndex: FORBIDDEN\");\n\n        for (uint i; i < _assets.length; ++i) {\n            address asset = _assets[i];\n            uint8 weight = _weights[i];\n\n            weightOf[asset] = weight;\n            assets.add(asset);\n\n            emit UpdateAnatomy(asset, weight);\n        }\n    }\n\n    /// @inheritdoc IManagedIndex\n    /// @dev Assets total weight should be equal to 255\n    function reweight(address[] calldata _updatedAssets, uint8[] calldata _updatedWeights) external override {\n        require(\n            IAccessControl(registry).hasRole(INDEX_MANAGER_ROLE, msg.sender) ||\n                IAccessControl(registry).hasRole(REWEIGHT_INDEX_ROLE, msg.sender),\n            \"ManagedIndex: FORBIDDEN\"\n        );\n        (bool success, bytes memory data) = IIndexFactory(factory).reweightingLogic().delegatecall(\n            abi.encodeWithSelector(IManagedIndexReweightingLogic.reweight.selector, _updatedAssets, _updatedWeights)\n        );\n        if (!success) {\n            if (data.length == 0) {\n                revert(\"ManagedIndex: REWEIGH_FAILED\");\n            } else {\n                assembly {\n                    revert(add(32, data), mload(data))\n                }\n            }\n        }\n    }\n\n    /// @inheritdoc ERC165\n    function supportsInterface(bytes4 _interfaceId) public view virtual override returns (bool) {\n        return _interfaceId == type(IManagedIndex).interfaceId || super.supportsInterface(_interfaceId);\n    }\n}"
    }
  ]
}