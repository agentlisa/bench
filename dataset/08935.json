{
  "Title": "[M-30] Incorrect deployment parameters",
  "Content": "_Submitted by Picodes_\n\n<https://github.com/code-423n4/2022-05-vetoken/blob/2d7cd1f6780a9bcc8387dea8fecfbd758462c152/migrations/25_deploy_angle_pools.js#L68>\n\n<https://github.com/code-423n4/2022-05-vetoken/blob/2d7cd1f6780a9bcc8387dea8fecfbd758462c152/migrations/25_deploy_angle_pools.js#L80>\n\n### Impact\n\nThe address of G-Uni tokens in the deployment scripts are not up to date.\n\n### Proof of Concept\n\nFor example for agEUR/USDC it is 0xedecb43233549c51cc3268b5de840239787ad56c and not 0x2bD9F7974Bc0E4Cb19B8813F8Be6034F3E772add.\n\n### Recommended Mitigation Steps\n\nFor safety why not fetching directly the LP token from the staking contract?\n\n**[jetbrain10 (veToken Finance) confirmed](https://github.com/code-423n4/2022-05-vetoken-findings/issues/52)** \n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-05-vetoken-findings/issues/52#issuecomment-1200279065):**\n> The warden has shown how a configuration file shows that the settings for the project are using an old address.\n> \n> While the finding pertains to a setup script (generally out of scope), given that:\n> - The sponsor has confirmed\n> - The finding is valid in that using older deployments will cause at the very least a loss of yield\n> - We already had an instance of bringing an out-of-scope file into scope via Sponsor-Confirming (See: [#209](https://github.com/code-423n4/2022-05-vetoken-findings/issues/209))\n> \n> With the information I have, I believe the finding to be of Medium Severity and believe the sponsor will mitigate by updating to the Warden suggested addresses.\n\n\n***\n\n\n\n",
  "Impact": "MEDIUM",
  "Source": "https://code4rena.com/contests/2022-05-vetoken-finance-contest",
  "Code": [
    {
      "filename": "migrations/25_deploy_angle_pools.js",
      "content": "const { getContract } = require(\"./helper/addContracts\");\nconst { logTransaction } = require(\"./helper/logger.js\");\n\nconst PoolManager = artifacts.require(\"PoolManager\");\nconst IERC20 = artifacts.require(\"IERC20\");\n\nmodule.exports = async function (deployer, network, accounts) {\n  const contractList = getContract();\n  const admin = accounts[0];\n  const poolManager = await PoolManager.at(contractList.system.poolManager);\n  const boosterAdd = contractList.system.angle_booster;\n  const angle = await IERC20.at(contractList.system.angle_address);\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x7B8E89b0cE7BAC2cfEC92A371Da899eA8CBdb450\",\n      \"0x8E2c0CbDa6bA7B65dbcA333798A3949B07638026\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanDAI_EUR\"\n  );\n\n  // funcd account[0] with lp token AA_idleCvxalUSD3CRV-f\n  const sanDAI_EUR = await IERC20.at(\"0x7B8E89b0cE7BAC2cfEC92A371Da899eA8CBdb450\");\n  logTransaction(\n    await sanDAI_EUR.transfer(accounts[0], web3.utils.toWei(\"1000\"), {\n      from: \"0x5aB0e4E355b08e692933c1F6f85fd0bE56aD18A6\",\n    }),\n    \"funcd account[0] with lp token sanDAI_EUR\"\n  );\n  // fund gauge with veasset\n  logTransaction(\n    await angle.transfer(\"0x8E2c0CbDa6bA7B65dbcA333798A3949B07638026\", web3.utils.toWei(\"1000\"), { from: admin }),\n    \"fund angle to gauge\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x9C215206Da4bf108aE5aEEf9dA7caD3352A36Dad\",\n      \"0x51fE22abAF4a26631b2913E417c0560D547797a7\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanUSDC_EUR\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x5d8D3Ac6D21C016f9C935030480B7057B21EC804\",\n      \"0x7c0fF11bfbFA3cC2134Ce62034329a4505408924\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanFEI_EUR\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0xb3B209Bb213A5Da5B947C56f2C770b3E1015f1FE\",\n      \"0xb40432243E4F317cE287398e72Ab8f0312fc2FE8\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanFRAX_EUR\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x2bD9F7974Bc0E4Cb19B8813F8Be6034F3E772add\",\n      \"0xEB7547a8a734b6fdDBB8Ce0C314a9E6485100a3C\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge Gelato Uni-V3 agEUR/USDC\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x26C2251801D2cfb5461751c984Dc3eAA358bdf0f\",\n      \"0x3785Ce82be62a342052b9E5431e9D3a839cfB581\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge Gelato Uni-V3 agEUR/wETH\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x1f4c763BdE1D4832B3EA0640e66Da00B98831355\",\n      \"0xBa625B318483516F7483DD2c4706aC92d44dBB2B\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge SushiSwap agEUR/ANGLE\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0xF89CE5eD65737dA8440411544b0499c9FaD323B2\",\n      \"0xd6282C5aEAaD4d776B932451C44b8EB453E44244\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge Uni-V2 agEUR/FEI\"\n  );\n};"
    },
    {
      "filename": "migrations/25_deploy_angle_pools.js",
      "content": "const { getContract } = require(\"./helper/addContracts\");\nconst { logTransaction } = require(\"./helper/logger.js\");\n\nconst PoolManager = artifacts.require(\"PoolManager\");\nconst IERC20 = artifacts.require(\"IERC20\");\n\nmodule.exports = async function (deployer, network, accounts) {\n  const contractList = getContract();\n  const admin = accounts[0];\n  const poolManager = await PoolManager.at(contractList.system.poolManager);\n  const boosterAdd = contractList.system.angle_booster;\n  const angle = await IERC20.at(contractList.system.angle_address);\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x7B8E89b0cE7BAC2cfEC92A371Da899eA8CBdb450\",\n      \"0x8E2c0CbDa6bA7B65dbcA333798A3949B07638026\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanDAI_EUR\"\n  );\n\n  // funcd account[0] with lp token AA_idleCvxalUSD3CRV-f\n  const sanDAI_EUR = await IERC20.at(\"0x7B8E89b0cE7BAC2cfEC92A371Da899eA8CBdb450\");\n  logTransaction(\n    await sanDAI_EUR.transfer(accounts[0], web3.utils.toWei(\"1000\"), {\n      from: \"0x5aB0e4E355b08e692933c1F6f85fd0bE56aD18A6\",\n    }),\n    \"funcd account[0] with lp token sanDAI_EUR\"\n  );\n  // fund gauge with veasset\n  logTransaction(\n    await angle.transfer(\"0x8E2c0CbDa6bA7B65dbcA333798A3949B07638026\", web3.utils.toWei(\"1000\"), { from: admin }),\n    \"fund angle to gauge\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x9C215206Da4bf108aE5aEEf9dA7caD3352A36Dad\",\n      \"0x51fE22abAF4a26631b2913E417c0560D547797a7\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanUSDC_EUR\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x5d8D3Ac6D21C016f9C935030480B7057B21EC804\",\n      \"0x7c0fF11bfbFA3cC2134Ce62034329a4505408924\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanFEI_EUR\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0xb3B209Bb213A5Da5B947C56f2C770b3E1015f1FE\",\n      \"0xb40432243E4F317cE287398e72Ab8f0312fc2FE8\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge sanFRAX_EUR\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x2bD9F7974Bc0E4Cb19B8813F8Be6034F3E772add\",\n      \"0xEB7547a8a734b6fdDBB8Ce0C314a9E6485100a3C\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge Gelato Uni-V3 agEUR/USDC\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x26C2251801D2cfb5461751c984Dc3eAA358bdf0f\",\n      \"0x3785Ce82be62a342052b9E5431e9D3a839cfB581\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge Gelato Uni-V3 agEUR/wETH\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0x1f4c763BdE1D4832B3EA0640e66Da00B98831355\",\n      \"0xBa625B318483516F7483DD2c4706aC92d44dBB2B\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge SushiSwap agEUR/ANGLE\"\n  );\n\n  logTransaction(\n    await poolManager.addPool(\n      \"0xF89CE5eD65737dA8440411544b0499c9FaD323B2\",\n      \"0xd6282C5aEAaD4d776B932451C44b8EB453E44244\",\n      boosterAdd,\n      3\n    ),\n    \"add gauge Uni-V2 agEUR/FEI\"\n  );\n};"
    }
  ]
}