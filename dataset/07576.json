{
  "Title": "[N-26]  Contracts should have full test coverage",
  "Content": "While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.\n\n*There is 1 instance of this issue:*\n```\n- What is the overall line coverage percentage provided by your tests?: 85\n```\nhttps://github.com/code-423n4/2022-11-paraspace/blob/c6820a279c64a299a783955749fdc977de8f0449/README.md?plain=1#L98\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2022-11-paraspace",
  "Code": [
    {
      "filename": "README.md?plain=1",
      "content": "# ParaSpace contest details\n\n- Total Prize Pool: $192,500 USDC\n  - HM awards: $136,000 USDC\n  - QA report awards: $16,000 USDC\n  - Gas report awards: $8,000 USDC\n  - Judge + presort awards: $32,000 USDC\n  - Scout awards: $500 USDC\n- Join [C4 Discord](https://discord.gg/code4rena) to register\n- Submit findings [using the C4 form](https://code4rena.com/contests/2022-11-paraspace-contest/submit)\n- [Read our guidelines for more details](https://docs.code4rena.com/roles/wardens)\n- Starts November 28, 2022 20:00 UTC\n- Ends December 9, 2022 20:00 UTC\n\n## C4udit / Publicly Known Issues\n\nThe C4audit output for the contest can be found [here](https://gist.github.com/Picodes/d39514dc40b7dee4fe0ff32768569cba).\n\n*Note for C4 wardens: Anything included in the C4udit output is considered a publicly known issue and is ineligible for awards.* \n\n# Overview\n\n[ParaSpace](https://para.space) is a decentralized lending protocol that allows users to borrow and lend against Non-Fungible and Fungible tokens alike. ParaSpace allows users to tap into otherwise-unused capital to fund further investments and earn yields on the same.\n\n[![Twitter URL](https://img.shields.io/twitter/follow/ParallelFi?style=social)](https://twitter.com/ParallelFi)\n[![Telegram](https://img.shields.io/badge/Telegram-gray?logo=telegram)](https://t.me/parallelfi_community)\n[![Discourse](https://img.shields.io/badge/Forum-gray?logo=discourse)](https://discourse.para.space)\n[![Discord chat][discord-badge]][discord-url]\n\n[discord-badge]: https://img.shields.io/discord/830972820846018600.svg?logo=discord&style=flat-square\n[discord-url]: https://discord.com/invite/buKKx4dySW\n\n[Website](https://para.space) |\n[White Paper](https://docs.para.space/para-space/#introduction-to-para-space) |\n[API Docs](https://api-docs.para.space) |\n[Chat](https://discord.com/invite/buKKx4dySW)\n\n![paraspace-architecture](https://user-images.githubusercontent.com/47150934/203772823-ef824800-55eb-427e-933f-6e8c198d6845.png)\n\n# Scope\n\n| Contract                                                                           | SLOC | Purpose                                                                                                    | Libraries used                   |\n| ---------------------------------------------------------------------------------- | ---- | ---------------------------------------------------------------------------------------------------------- | -------------------------------- |\n| paraspace-core/contracts/misc/marketplaces/LooksRareAdapter.sol                    | 89   | Implements the NFT <=> ERC20 exchange logic via LooksRare marketplace                                      | @LooksRare/contracts-exchange/\\* |\n| paraspace-core/contracts/misc/marketplaces/SeaportAdapter.sol                      | 112  | Implements the NFT <=> ERC20 exchange logic via OpenSea Seaport marketplace                                | @ProjectOpenSea/seaport/\\*       |\n| paraspace-core/contracts/misc/marketplaces/X2Y2Adapter.sol                         | 92   | Implements the NFT <=> ERC20 exchange logic via X2Y2 marketplace                                           | @openzeppelin/\\*                 |\n| paraspace-core/contracts/misc/NFTFloorOracle.sol                                   | 337  | /// @notice Offchain clients can update the prices in this contract. The public can read prices            | @openzeppelin/\\*                 |\n| paraspace-core/contracts/misc/ParaSpaceOracle.sol                                  | 163  | Contract to get asset prices, manage price sources and update the fallback oracle                          | @openzeppelin/\\*                 |\n| paraspace-core/contracts/misc/UniswapV3OracleWrapper.sol                           | 307  |                                                                                                            | @Uniswap/v3-core/\\*              |\n| paraspace-core/contracts/protocol/configuration/PoolAddressesProvider.sol          | 244  | Main registry of addresses part of or connected to the protocol, including permissioned roles              | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/AuctionLogic.sol                 | 114  | Implements actions involving NFT auctions                                                                  | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/BorrowLogic.sol                  | 159  | Implements the base logic for all the actions related to borrowing                                         | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/FlashClaimLogic.sol              | 71   |                                                                                                            | @Chainlink/vrf/\\*                |\n| paraspace-core/contracts/protocol/libraries/logic/GenericLogic.sol                 | 442  | Implements protocol-level logic to calculate and validate the state of a user                              | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/LiquidationLogic.sol             | 645  | Implements actions involving management of collateral in the protocol, the main one being the liquidations | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/MarketplaceLogic.sol             | 482  | Implements the base logic for all the actions related to NFT buy/accept bid                                | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/PoolLogic.sol                    | 175  | Implements the logic for Pool specific functions                                                           | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/SupplyLogic.sol                  | 545  | Implements the base logic for supply/withdraw                                                              | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/libraries/logic/ValidationLogic.sol              | 968  | Implements functions to validate the different actions of the protocol                                     | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/pool/DefaultReserveAuctionStrategy.sol           | 94   | Implements the calculation of the current dutch auction price                                              | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/pool/PoolApeStaking.sol                          | 381  | ParaSpace Ape Staking Pool                                                                                 | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/pool/PoolCore.sol                                | 678  | Main point of interaction with an ParaSpace protocol's market                                              | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/pool/PoolMarketplace.sol                         | 114  | Main point of interaction with an ParaSpace protocol's market                                              | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/pool/PoolParameters.sol                          | 224  | Main point of interaction with an ParaSpace protocol's market                                              | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/pool/PoolStorage.sol                             | 19   | Contract used as storage of the Pool contract.                                                             | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/tokenization/base/MintableIncentivizedERC721.sol | 434  | Basic ERC721 implementation                                                                                | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/tokenization/NToken.sol                          | 267  | Implementation of the NFT derivative token for the ParaSpace protocol                                      | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/tokenization/NTokenApeStaking.sol                | 145  | Implementation of the NToken for the ParaSpace protocol                                                    | @yoga-labs/ApeCoinStaking/\\*     |\n| paraspace-core/contracts/protocol/tokenization/NTokenBAYC.sol                      | 65   | Implementation of the NToken for the ParaSpace protocol                                                    | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/tokenization/NTokenMAYC.sol                      | 65   | Implementation of the NToken for the ParaSpace protocol                                                    | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/tokenization/NTokenMoonBirds.sol                 | 87   | Implementation of the interest bearing token for the ParaSpace protocol                                    | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/tokenization/NTokenUniswapV3.sol                 | 109  | Implementation of the interest bearing token for the ParaSpace protocol                                    | @Uniswap/v3-core/\\*              |\n| paraspace-core/contracts/protocol/tokenization/libraries/MintableERC721Logic.sol   | 427  | Implements the base logic for MintableERC721                                                               | @openzeppelin/\\*                 |\n| paraspace-core/contracts/protocol/tokenization/libraries/ApeStakingLogic.sol       | 197  | Implements the base logic for ApeStaking                                                                   | @yoga-labs/ApeCoinStaking/\\*     |\n| paraspace-core/contracts/ui/WPunkGateway.sol                                       | 156  | Implements the acceptBidWithCredit feature. AcceptBidWithCredit allows users to                            | @openzeppelin/\\*                 |\n\n## Out of scope\n\nThe issue raised in PR https://github.com/para-space/paraspace-core/pull/7 has been already identified and evaluated, therefore, not eligible for rewards.\n\n# Additional Context\n\n- docs: https://docs.para.space\n- audit technical documentation: https://www.notion.so/parallelfinance/Audit-Technical-Documentation-0a107270dabe45d2b66a076e0bdaa943\n- code walkthrough: https://drive.google.com/file/d/1_3lz2le-DJ-pzfpoBiawETQrzeKWAq30/view\n- [goerli deployed contracts](https://github.com/para-space/paraspace-core/files/10064318/deployed-contracts.md)\n\n## Scoping Details\n\n```\n- If you have a public code repo, please share it here:  https://github.com/para-space/paraspace-core\n- How many contracts are in scope?: 32\n- Total SLoC for these contracts?: 8408\n- How many external imports are there?: 12\n- How many separate interfaces and struct definitions are there for the contracts within scope?: 44 interfaces, 35 struct definitions\n- Does most of your code generally use composition or inheritance?: Yes\n- How many external calls?: 306\n- What is the overall line coverage percentage provided by your tests?: 85\n- Is there a need to understand a separate part of the codebase / get context in order to audit this part of the protocol?: No\n- Please describe required context: N/A\n- Does it use an oracle?: Yes. Chainlink + offchain client\n- Does the token conform to the ERC20 standard?: Yes, plus ERC-721\n- Are there any novel or unique curve logic or mathematical models?: https://docs.para.space/para-space/para-space/risk-framework\n- Does it use a timelock function?: No\n- Is it an NFT?: Yes. It does NFT lending & marketplace\n- Does it have an AMM?: Yes\n- Is it a fork of a popular project?: Yes. Forked from AaveV3 protocol. https://docs.para.space\n- Does it use rollups?: No\n- Is it multi-chain?: No\n- Does it use a side-chain?: No\n```\n\n# Tests\n\n```\ncd paraspace-core\n\n# create an empty .env file (tests should work fine with it being empty)\ntouch .env\n\n# install dependencies\nyarn\n\n# build contracts\nyarn build\n\n# run tests\nmake fast-test\n```"
    }
  ]
}