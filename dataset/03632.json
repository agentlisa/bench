{
  "Title": "Use `external` instead of `public` modifier",
  "Content": "##### Description\nAt line:\nhttps://github.com/ransonhobbes/stardust/blob/c446b1f12f53fa75ea6c347daee1e15df562a81d/contracts/Treasury.sol#L79\nhttps://github.com/ransonhobbes/stardust/blob/c446b1f12f53fa75ea6c347daee1e15df562a81d/contracts/Treasury.sol#L120\n##### Recommendation\nWe recommend using `external` instead of `public` modifier for `deposit` and `redeem` functions because they are not called internally.",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/Treasury.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport \"@openzeppelin/contracts/utils/Context.sol\";\nimport \"./interface/IAzimuth.sol\";\nimport \"./interface/IEcliptic.sol\";\nimport \"./StarToken.sol\";\n\n//  Treasury: simple automated market maker for StarTokens\n//\n//    This contract implements an extremely simple automated market maker for StarTokens.\n//    It allows owners of Azimuth star points to deposit\n\ncontract Treasury is Context {\n    // MODEL\n\n    //  assets: stars currently held in this pool\n    //\n    uint16[] public assets;\n\n    //  azimuth: points state data store\n    //\n    IAzimuth public azimuth;\n\n    // deploy a new token contract with no balance and no operators\n    StarToken public startoken = new StarToken(0, new address[](0));\n\n    uint256 constant public oneStar = 1e18;\n\n    // EVENTS\n\n    event Deposit(\n        uint32 indexed prefix,\n        uint32 indexed star,\n        address sender\n    );\n\n    event Redeem(\n        uint32 indexed prefix,\n        uint32 indexed star,\n        address sender\n    );\n\n    // IMPLEMENTATION\n\n    //  constructor(): configure the points data store and token contract address\n    //\n    constructor(IAzimuth _azimuth)\n    {\n        azimuth = _azimuth;\n    }\n\n    //  getAllAssets(): return array of assets held by this contract\n    //\n    //    Note: only useful for clients, as Solidity does not currently\n    //    support returning dynamic arrays.\n    //\n    function getAllAssets()\n        view\n        external\n        returns (uint16[] memory allAssets)\n    {\n        return assets;\n    }\n\n    //  getAssetCount(): returns the number of assets held by this contract\n    //\n    function getAssetCount()\n        view\n        external\n        returns (uint256 count)\n    {\n        return assets.length;\n    }\n\n    //  deposit(star): deposit a star you own, receive a newly-minted $STAR token in exchange\n    //\n    function deposit(uint16 _star)\n        public\n    {\n        require(azimuth.getPointSize(_star) == IAzimuth.Size.Star);\n        IEcliptic ecliptic = IEcliptic(azimuth.owner());\n\n        // case (1):\n        // star is owned by the caller, we are a transfer proxy for the star, and the star has spawned no planets\n        if (\n            azimuth.isOwner(_star, _msgSender()) &&\n            azimuth.getSpawnCount(_star) == 0 &&\n            azimuth.isTransferProxy(_star, address(this))\n        ) {\n            // transfer ownership of the _star to :this contract\n            ecliptic.transferPoint(_star, address(this), true);\n        }\n        // case (2):\n        // the star's galaxy is owned by the caller, the star is not active, and we are a spawn proxy for the galaxy\n        else if (\n            azimuth.isOwner(azimuth.getPrefix(_star), _msgSender()) &&\n            !azimuth.isActive(_star) &&\n            azimuth.isSpawnProxy(azimuth.getPrefix(_star), address(this))\n        ) {\n            // spawn the _star directly to :this contract\n            ecliptic.spawn(_star, address(this));\n        }\n        else {\n            revert();\n        }\n\n        //  update state to include the deposited star\n        //\n        assets.push(_star);\n\n        //  mint star tokens and grant them to the :msg.sender\n        //\n        startoken.mint(_msgSender(), oneStar);\n        emit Deposit(azimuth.getPrefix(_star), _star, _msgSender());\n    }\n\n    //  redeem(): burn one star token, receive ownership of the most recently deposited star in exchange\n    //\n    function redeem() public {\n        // must have sufficient balance\n        require(startoken.balanceOf(_msgSender()) >= oneStar);\n\n        // there must be at least one star in the asset list\n        require(assets.length>0);\n\n        // remove the star to be redeemed\n        uint16 _star = assets[assets.length-1];\n        assets.pop();\n\n        // check its ownership\n        require(azimuth.isOwner(_star, address(this)));\n\n        // burn the tokens\n        startoken.ownerBurn(_msgSender(), oneStar);\n\n        // transfer ownership\n        IEcliptic ecliptic = IEcliptic(azimuth.owner());\n        ecliptic.transferPoint(_star, _msgSender(), true);\n\n        emit Redeem(azimuth.getPrefix(_star), _star, _msgSender());\n    }\n}"
    },
    {
      "filename": "contracts/Treasury.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport \"@openzeppelin/contracts/utils/Context.sol\";\nimport \"./interface/IAzimuth.sol\";\nimport \"./interface/IEcliptic.sol\";\nimport \"./StarToken.sol\";\n\n//  Treasury: simple automated market maker for StarTokens\n//\n//    This contract implements an extremely simple automated market maker for StarTokens.\n//    It allows owners of Azimuth star points to deposit\n\ncontract Treasury is Context {\n    // MODEL\n\n    //  assets: stars currently held in this pool\n    //\n    uint16[] public assets;\n\n    //  azimuth: points state data store\n    //\n    IAzimuth public azimuth;\n\n    // deploy a new token contract with no balance and no operators\n    StarToken public startoken = new StarToken(0, new address[](0));\n\n    uint256 constant public oneStar = 1e18;\n\n    // EVENTS\n\n    event Deposit(\n        uint32 indexed prefix,\n        uint32 indexed star,\n        address sender\n    );\n\n    event Redeem(\n        uint32 indexed prefix,\n        uint32 indexed star,\n        address sender\n    );\n\n    // IMPLEMENTATION\n\n    //  constructor(): configure the points data store and token contract address\n    //\n    constructor(IAzimuth _azimuth)\n    {\n        azimuth = _azimuth;\n    }\n\n    //  getAllAssets(): return array of assets held by this contract\n    //\n    //    Note: only useful for clients, as Solidity does not currently\n    //    support returning dynamic arrays.\n    //\n    function getAllAssets()\n        view\n        external\n        returns (uint16[] memory allAssets)\n    {\n        return assets;\n    }\n\n    //  getAssetCount(): returns the number of assets held by this contract\n    //\n    function getAssetCount()\n        view\n        external\n        returns (uint256 count)\n    {\n        return assets.length;\n    }\n\n    //  deposit(star): deposit a star you own, receive a newly-minted $STAR token in exchange\n    //\n    function deposit(uint16 _star)\n        public\n    {\n        require(azimuth.getPointSize(_star) == IAzimuth.Size.Star);\n        IEcliptic ecliptic = IEcliptic(azimuth.owner());\n\n        // case (1):\n        // star is owned by the caller, we are a transfer proxy for the star, and the star has spawned no planets\n        if (\n            azimuth.isOwner(_star, _msgSender()) &&\n            azimuth.getSpawnCount(_star) == 0 &&\n            azimuth.isTransferProxy(_star, address(this))\n        ) {\n            // transfer ownership of the _star to :this contract\n            ecliptic.transferPoint(_star, address(this), true);\n        }\n        // case (2):\n        // the star's galaxy is owned by the caller, the star is not active, and we are a spawn proxy for the galaxy\n        else if (\n            azimuth.isOwner(azimuth.getPrefix(_star), _msgSender()) &&\n            !azimuth.isActive(_star) &&\n            azimuth.isSpawnProxy(azimuth.getPrefix(_star), address(this))\n        ) {\n            // spawn the _star directly to :this contract\n            ecliptic.spawn(_star, address(this));\n        }\n        else {\n            revert();\n        }\n\n        //  update state to include the deposited star\n        //\n        assets.push(_star);\n\n        //  mint star tokens and grant them to the :msg.sender\n        //\n        startoken.mint(_msgSender(), oneStar);\n        emit Deposit(azimuth.getPrefix(_star), _star, _msgSender());\n    }\n\n    //  redeem(): burn one star token, receive ownership of the most recently deposited star in exchange\n    //\n    function redeem() public {\n        // must have sufficient balance\n        require(startoken.balanceOf(_msgSender()) >= oneStar);\n\n        // there must be at least one star in the asset list\n        require(assets.length>0);\n\n        // remove the star to be redeemed\n        uint16 _star = assets[assets.length-1];\n        assets.pop();\n\n        // check its ownership\n        require(azimuth.isOwner(_star, address(this)));\n\n        // burn the tokens\n        startoken.ownerBurn(_msgSender(), oneStar);\n\n        // transfer ownership\n        IEcliptic ecliptic = IEcliptic(azimuth.owner());\n        ecliptic.transferPoint(_star, _msgSender(), true);\n\n        emit Redeem(azimuth.getPrefix(_star), _star, _msgSender());\n    }\n}"
    }
  ]
}