{
  "Title": "[M07] Deprecated TokenVesting draft contract is used",
  "Content": "The [`Vester`](https://github.com/emptysetsquad/emptyset/blob/bf9753ef9cd5b17236036257f290e0d0b850a029/protocol/contracts/src/vester/Vester.sol#L29) contract is using the `TokenVesting` contract provided in a [previous deprecated draft version](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v2.5.0/contracts/drafts/TokenVesting.sol) provided by OpenZeppelin.\n\n\nUsing deprecated contracts which are in draft status and not properly audited can be dangerous and increase the attack surface.\n\n\nConsider properly documenting this and correctly inform users of its use.\n\n\n***Update**: Acknowledged.*\n\n\n",
  "Impact": "MEDIUM",
  "Source": "",
  "Code": [
    {
      "filename": "protocol/contracts/src/vester/Vester.sol",
      "content": "/*\n    Copyright 2020, 2021 Empty Set Squad <emptysetsquad@protonmail.com>\n\n    Licensed under the Apache License, Version 2.0 (the \"License\");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an \"AS IS\" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n*/\n\npragma solidity 0.5.17;\npragma experimental ABIEncoderV2;\n\nimport \"./TokenVesting.sol\";\nimport \"../Interfaces.sol\";\n\n/**\n * @title Vesting\n * @notice Generic ERC20 token vesting contract, which additionally supports COMP-style governance\n * @dev Extension of the OZ TokenVesting contract with support for beneficiary transfer and COMP-style\n *      governance participation with unvested tokens\n */\ncontract Vester is TokenVesting {\n\n    /**\n     * @notice Emitted when {beneficiary} transfers beneficiary to `newBeneficiary`\n     */\n    event BeneficiaryTransfer(address newBeneficiary);\n\n    /**\n     * @dev Creates a vesting contract that vests its balance of any ERC20 token to the\n     * beneficiary, gradually in a linear fashion until start + duration. By then all\n     * of the balance will have vested.\n     * @param beneficiary address of the beneficiary to whom vested tokens are transferred\n     * @param cliffDuration duration in seconds of the cliff in which tokens will begin to vest\n     * @param start the time (as Unix time) at which point vesting starts\n     * @param duration duration in seconds of the period in which the tokens will vest\n     * @param revocable whether the vesting is revocable or not\n     */\n    constructor (address beneficiary, uint256 start, uint256 cliffDuration, uint256 duration, bool revocable)\n    TokenVesting(beneficiary, start, cliffDuration, duration, revocable) public { }\n\n    /**\n     * @notice Allows the current {beneficiary} to transfer beneficiary status to a new address\n     * @dev Beneficiary only\n     * @param newBeneficiary New beneficiary address\n     */\n    function transferBeneficiary(address newBeneficiary) external onlyBeneficiary {\n        require(newBeneficiary != address(0), \"Vester: zero address\");\n        _beneficiary = newBeneficiary;\n        emit BeneficiaryTransfer(newBeneficiary);\n    }\n\n    /**\n     * @notice Delegates voting power to `delegatee` for `token` governance token held by the vesting contract\n     * @dev Beneficiary only\n     *      Works for all COMP-style governance tokens\n     * @param token Governance token to delegate voting power\n     * @param delegatee Account to receive voting power\n     */\n    function delegate(address token, address delegatee) external onlyBeneficiary {\n        IGovToken(token).delegate(delegatee);\n    }\n\n    /**\n     * @notice Only beneficiary may call\n     */\n    modifier onlyBeneficiary {\n        require(msg.sender == beneficiary(), \"Vester: not beneficiary\");\n\n        _;\n    }\n}"
    }
  ]
}