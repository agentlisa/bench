{
  "Title": "[L-01] Using Vulnerable Version of Openzeppelin",
  "Content": "<h2 id=\"l-01-using-vulnerable-version-of-openzeppelin\" style=\"position:relative;\"><a href=\"#l-01-using-vulnerable-version-of-openzeppelin\" aria-label=\"l 01 using vulnerable version of openzeppelin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-01] Using Vulnerable Version of Openzeppelin</h2>\n<h3 id=\"context-9\" style=\"position:relative;\"><a href=\"#context-9\" aria-label=\"context 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Context</h3>\n<p><a href=\"https://github.com/code-423n4/2022-10-thegraph/blob/main/package.json#L27-L28\">package.json</a></p>\n<h3 id=\"description-13\" style=\"position:relative;\"><a href=\"#description-13\" aria-label=\"description 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h3>\n<p>The package.json configuration file says that the project is using 3.4.1 â€“ 3.4.2 of OpenZeppelin which has a vulnerability in initializers that call external contracts, <br>\nThere is 1 instance of this issue</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Package</th>\n<th align=\"center\">Affected versions</th>\n<th align=\"center\">Patched versions</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">@openzeppelin/contracts (npm)</td>\n<td align=\"center\">&gt;=3.2.0 &lt;4.4.1</td>\n<td align=\"center\">4.4.1</td>\n</tr>\n<tr>\n<td align=\"center\">@openzeppelin/contracts-upgradeable (npm)</td>\n<td align=\"center\">&gt;=3.2.0 &lt;4.4.1</td>\n<td align=\"center\">4.4.1</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"recommendation-9\" style=\"position:relative;\"><a href=\"#recommendation-9\" aria-label=\"recommendation 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommendation</h3>\n<p>Use patched versions</p>\n<h3 id=\"proof-of-concept-4\" style=\"position:relative;\"><a href=\"#proof-of-concept-4\" aria-label=\"proof of concept 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof Of Concept</h3>\n<p><a href=\"https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-9c22-pwxw-p6hx\">https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-9c22-pwxw-p6hx</a></p>\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/contests/2022-10-the-graph-l2-bridge-contest",
  "Code": [
    {
      "filename": "package.json",
      "content": "{\n  \"name\": \"@graphprotocol/contracts\",\n  \"version\": \"1.16.0\",\n  \"description\": \"Contracts for the Graph Protocol\",\n  \"directories\": {\n    \"test\": \"test\"\n  },\n  \"files\": [\n    \"dist/**/*\",\n    \"README.md\",\n    \"LICENSE\",\n    \"addresses.json\"\n  ],\n  \"dependencies\": {\n    \"ethers\": \"^5.6.0\"\n  },\n  \"devDependencies\": {\n    \"@arbitrum/sdk\": \"^3.0.0-beta.6\",\n    \"@commitlint/cli\": \"^13.2.1\",\n    \"@commitlint/config-conventional\": \"^13.2.0\",\n    \"@defi-wonderland/smock\": \"^2.0.7\",\n    \"@ethersproject/experimental\": \"^5.6.0\",\n    \"@graphprotocol/common-ts\": \"^1.8.3\",\n    \"@nomiclabs/hardhat-ethers\": \"^2.0.2\",\n    \"@nomiclabs/hardhat-etherscan\": \"^2.1.1\",\n    \"@nomiclabs/hardhat-waffle\": \"^2.0.1\",\n    \"@openzeppelin/contracts\": \"^3.4.1\",\n    \"@openzeppelin/contracts-upgradeable\": \"3.4.2\",\n    \"@openzeppelin/hardhat-upgrades\": \"^1.6.0\",\n    \"@tenderly/hardhat-tenderly\": \"^1.0.11\",\n    \"@typechain/ethers-v5\": \"^7.0.0\",\n    \"@typechain/hardhat\": \"^2.0.0\",\n    \"@types/bs58\": \"^4.0.1\",\n    \"@types/chai-as-promised\": \"^7.1.5\",\n    \"@types/dotenv\": \"^8.2.0\",\n    \"@types/glob\": \"^7.2.0\",\n    \"@types/inquirer\": \"^7.3.1\",\n    \"@types/minimist\": \"^1.2.1\",\n    \"@types/mocha\": \"^8.2.2\",\n    \"@types/node\": \"^15.0.1\",\n    \"@types/winston\": \"^2.4.4\",\n    \"@types/yargs\": \"^16.0.0\",\n    \"@typescript-eslint/eslint-plugin\": \"^4.0.0\",\n    \"@typescript-eslint/parser\": \"^4.0.0\",\n    \"@urql/core\": \"^2.1.3\",\n    \"arbos-precompiles\": \"^1.0.2\",\n    \"bignumber.js\": \"^9.0.0\",\n    \"chai\": \"^4.3.4\",\n    \"chai-as-promised\": \"^7.1.1\",\n    \"cli-table\": \"^0.3.6\",\n    \"dotenv\": \"^9.0.0\",\n    \"eslint\": \"^7.24.0\",\n    \"eslint-config-prettier\": \"^8.3.0\",\n    \"eslint-plugin-no-only-tests\": \"^2.4.0\",\n    \"eslint-plugin-prettier\": \"^3.4.0\",\n    \"ethereum-waffle\": \"^3.3.0\",\n    \"form-data\": \"^4.0.0\",\n    \"glob\": \"^8.0.3\",\n    \"graphql-tag\": \"^2.12.4\",\n    \"hardhat\": \"^2.9.5\",\n    \"hardhat-abi-exporter\": \"^2.2.0\",\n    \"hardhat-contract-sizer\": \"^2.0.3\",\n    \"hardhat-gas-reporter\": \"^1.0.4\",\n    \"hardhat-storage-layout\": \"0.1.6\",\n    \"hardhat-tracer\": \"^1.0.0-alpha.6\",\n    \"husky\": \"^7.0.4\",\n    \"inquirer\": \"^8.0.0\",\n    \"ipfs-http-client\": \"47.0.1\",\n    \"isomorphic-fetch\": \"^3.0.0\",\n    \"lint-staged\": \"^10.5.4\",\n    \"p-queue\": \"^6.6.1\",\n    \"prettier\": \"^2.2.1\",\n    \"prettier-plugin-solidity\": \"^1.0.0-beta.9\",\n    \"solhint\": \"^3.3.6\",\n    \"solhint-plugin-prettier\": \"^0.0.5\",\n    \"solidity-coverage\": \"^0.7.16\",\n    \"ts-node\": \"^10.9.1\",\n    \"typechain\": \"^5.0.0\",\n    \"typescript\": \"^4.7.4\",\n    \"winston\": \"^3.3.3\",\n    \"yaml\": \"^1.10.2\",\n    \"yargs\": \"^17.0.0\"\n  },\n  \"scripts\": {\n    \"prepare\": \"husky install\",\n    \"prepublishOnly\": \"scripts/prepublish\",\n    \"build\": \"SKIP_LOAD=true scripts/build\",\n    \"clean\": \"rm -rf build/ cache/ dist/\",\n    \"compile\": \"hardhat compile\",\n    \"deploy\": \"yarn build && yarn predeploy && hardhat migrate\",\n    \"deploy-localhost\": \"yarn deploy --force --network localhost --graph-config config/graph.localhost.yml\",\n    \"deploy-rinkeby\": \"yarn deploy --force --network rinkeby --graph-config config/graph.rinkeby.yml\",\n    \"deploy-goerli\": \"yarn deploy --force --network goerli --graph-config config/graph.goerli.yml\",\n    \"deploy-arbitrum-goerli\": \"yarn deploy --force --network arbitrum-goerli --graph-config config/graph.arbitrum-goerli.yml\",\n    \"predeploy\": \"scripts/predeploy\",\n    \"test\": \"scripts/test\",\n    \"test:e2e\": \"scripts/e2e\",\n    \"test:gas\": \"RUN_EVM=true REPORT_GAS=true scripts/test\",\n    \"test:coverage\": \"scripts/coverage\",\n    \"test:gre\": \"cd gre && mocha --exit --recursive 'test/**/*.test.ts' && cd ..\",\n    \"lint\": \"yarn lint:ts && yarn lint:sol\",\n    \"lint:fix\": \"yarn lint:ts:fix && yarn lint:sol:fix\",\n    \"lint:ts\": \"eslint '**/*.{js,ts}'\",\n    \"lint:ts:fix\": \"yarn prettier:ts && eslint '**/*.{js,ts}' --fix\",\n    \"lint:sol\": \"solhint 'contracts/**/*.sol'\",\n    \"lint:sol:fix\": \"yarn prettier:sol && solhint --fix 'contracts/**/*.sol'\",\n    \"prettier\": \"yarn prettier:ts && yarn prettier:sol\",\n    \"prettier:ts\": \"prettier --write '**/*.{js,ts,json}'\",\n    \"prettier:sol\": \"prettier --write 'contracts/**/*.sol'\",\n    \"analyze\": \"scripts/analyze\",\n    \"myth\": \"scripts/myth\",\n    \"flatten\": \"scripts/flatten && scripts/clean\",\n    \"typechain\": \"hardhat typechain\",\n    \"verify\": \"hardhat verify\",\n    \"size\": \"hardhat size-contracts\"\n  },\n  \"lint-staged\": {\n    \"contracts/**/*.sol\": [\n      \"yarn lint:sol:fix\"\n    ],\n    \"**/*.ts\": [\n      \"yarn lint:ts:fix\"\n    ],\n    \"**/*.js\": [\n      \"yarn lint:ts:fix\"\n    ],\n    \"**/*.json\": [\n      \"yarn lint:ts:fix\"\n    ]\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/graphprotocol/contracts.git\"\n  },\n  \"author\": \"The Graph Team\",\n  \"license\": \"GPL-2.0-or-later\",\n  \"bugs\": {\n    \"url\": \"https://github.com/graphprotocol/contracts/issues\"\n  },\n  \"homepage\": \"https://github.com/graphprotocol/contracts#readme\",\n  \"types\": \"dist/types/index.d.ts\"\n}"
    }
  ]
}