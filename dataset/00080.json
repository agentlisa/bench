{
  "Title": "Mismatch Between Documentation and Implementation",
  "Content": "The NatSpec comment in the [`IEVault` interface](https://github.com/euler-xyz/euler-vault-kit/blob/83ea1ad97b7c561d6601b220d23ec85d67ceb297/src/EVault/IEVault.sol#L365) indicates that the list can contain duplicates. However, in the code, each element in the array is pushed when the [`initialized` flag](https://github.com/euler-xyz/euler-vault-kit/blob/83ea1ad97b7c561d6601b220d23ec85d67ceb297/src/EVault/modules/Governance.sol#L213) from the `LTVConfig` struct is down, and there is no mechanism provided to reset it back to `false`, even after calling the [`clearLTV` function](https://github.com/euler-xyz/euler-vault-kit/blob/83ea1ad97b7c561d6601b220d23ec85d67ceb297/src/EVault/modules/Governance.sol#L225).\n\n\nTo avoid potential integration issues for other protocols, it is advisable to update the documentation to accurately reflect the current behavior.\n\n\n***Update:** Resolved in [pull request #139](https://github.com/euler-xyz/euler-vault-kit/pull/139).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "src/EVault/IEVault.sol",
      "content": "// SPDX-License-Identifier: GPL-2.0-or-later\n\npragma solidity ^0.8.0;\n\nimport {IVault as IEVCVault} from \"ethereum-vault-connector/interfaces/IVault.sol\";\n\n// Full interface of EVault and all it's modules\n\n/// @title IInitialize\n/// @notice Interface of the initialization module of EVault\ninterface IInitialize {\n    /// @notice Initialization of the newly deployed proxy contract\n    /// @param proxyCreator Account which created the proxy or should be the initial governor\n    function initialize(address proxyCreator) external;\n}\n\n/// @title IERC20\n/// @notice Interface of the EVault's Initialize module\ninterface IERC20 {\n    /// @notice Vault share token (eToken) name, ie \"Euler Vault: DAI\"\n    function name() external view returns (string memory);\n\n    /// @notice Vault share token (eToken) symbol, ie \"eDAI\"\n    function symbol() external view returns (string memory);\n\n    /// @notice Decimals, always normalised to 18\n    function decimals() external view returns (uint8);\n\n    /// @notice Sum of all eToken balances\n    function totalSupply() external view returns (uint256);\n\n    /// @notice Balance of a particular account, in eTokens\n    function balanceOf(address account) external view returns (uint256);\n\n    /// @notice Retrieve the current allowance\n    /// @param holder The account holding the eTokens\n    /// @param spender Trusted address\n    function allowance(address holder, address spender) external view returns (uint256);\n\n    /// @notice Transfer eTokens to another address\n    /// @param to Recipient account\n    /// @param amount In shares.\n    function transfer(address to, uint256 amount) external returns (bool);\n\n    /// @notice Transfer eTokens from one address to another\n    /// @param from This address must've approved the to address\n    /// @param to Recipient account\n    /// @param amount In shares\n    function transferFrom(address from, address to, uint256 amount) external returns (bool);\n\n    /// @notice Allow spender to access an amount of your eTokens\n    /// @param spender Trusted address\n    /// @param amount Use max uint for \"infinite\" allowance\n    function approve(address spender, uint256 amount) external returns (bool);\n}\n\n/// @title IToken\n/// @notice Interface of the EVault's Token module\ninterface IToken is IERC20 {\n    /// @notice Transfer the full eToken balance of an address to another\n    /// @param from This address must've approved the to address\n    /// @param to Recipient account\n    function transferFromMax(address from, address to) external returns (bool);\n}\n\n/// @title IERC4626\n/// @notice Interface of an ERC4626 vault\ninterface IERC4626 {\n    /// @notice Vault underlying asset\n    function asset() external view returns (address);\n\n    /// @notice Total amount of managed assets\n    function totalAssets() external view returns (uint256);\n\n    /// @notice Calculate amount of assets corresponding to the requested shares amount\n    function convertToAssets(uint256 shares) external view returns (uint256);\n\n    /// @notice Calculate amount of shares corresponding to the requested assets amount\n    function convertToShares(uint256 assets) external view returns (uint256);\n\n    /// @notice Fetch the maximum amount of assets a user can deposit\n    function maxDeposit(address account) external view returns (uint256);\n\n    /// @notice Calculate an amount of shares that would be created by depositing assets\n    /// @param assets Amount of assets deposited\n    /// @return Amount of shares received\n    function previewDeposit(uint256 assets) external view returns (uint256);\n\n    /// @notice Fetch the maximum amount of shares a user can mint\n    function maxMint(address account) external view returns (uint256);\n\n    /// @notice Calculate an amount of assets that would be required to mint requested amount of shares\n    /// @param shares Amount of shares to be minted\n    /// @return Required amount of assets\n    function previewMint(uint256 shares) external view returns (uint256);\n\n    /// @notice Fetch the maximum amount of assets a user is allowed to withdraw\n    /// @param owner Account holding the shares\n    /// @return The maximum amount of assets the owner is allowed to withdraw\n    function maxWithdraw(address owner) external view returns (uint256);\n\n    /// @notice Calculate the amount of shares that will be burned when withdrawing requested amount of assets\n    /// @param assets Amount of assets withdrawn\n    /// @return Amount of shares burned\n    function previewWithdraw(uint256 assets) external view returns (uint256);\n\n    /// @notice Fetch the maximum amount of shares a user is allowed to redeem for assets\n    /// @param owner Account holding the shares\n    /// @return The maximum amount of shares the owner is allowed to redeem\n    function maxRedeem(address owner) external view returns (uint256);\n\n    /// @notice Calculate the amount of assets that will be transferred when redeeming requested amount of shares\n    /// @param shares Amount of shares redeemed\n    /// @return Amount of assets transferred\n    function previewRedeem(uint256 shares) external view returns (uint256);\n\n    /// @notice Transfer requested amount of underlying tokens from sender to the vault pool in return for shares\n    /// @param amount Amount of assets to deposit (use max uint256 for full underlying token balance)\n    /// @param receiver An account to receive the shares\n    /// @return Amount of shares minted\n    /// @dev Deposit will round down the amount of assets that are converted to shares. To prevent losses consider using mint instead.\n    function deposit(uint256 amount, address receiver) external returns (uint256);\n\n    /// @notice Transfer underlying tokens from sender to the vault pool in return for requested amount of shares\n    /// @param amount Amount of shares to be minted\n    /// @param receiver An account to receive the shares\n    /// @return Amount of assets deposited\n    function mint(uint256 amount, address receiver) external returns (uint256);\n\n    /// @notice Transfer requested amount of underlying tokens from the vault and decrease account's shares balance\n    /// @param amount Amount of assets to withdraw\n    /// @param receiver Account to receive the withdrawn assets\n    /// @param owner Account holding the shares to burn\n    /// @return Amount of shares burned\n    function withdraw(uint256 amount, address receiver, address owner) external returns (uint256);\n\n    /// @notice Burn requested shares and transfer corresponding underlying tokens from the vault to the receiver\n    /// @param amount Amount of shares to burn (use max uint256 to burn full owner balance)\n    /// @param receiver Account to receive the withdrawn assets\n    /// @param owner Account holding the shares to burn.\n    /// @return Amount of assets transferred\n    function redeem(uint256 amount, address receiver, address owner) external returns (uint256);\n}\n\n/// @title IVault\n/// @notice Interface of the EVault's Vault module\ninterface IVault is IERC4626 {\n    /// @notice Balance of the fees accumulator, in eTokens\n    function accumulatedFees() external view returns (uint256);\n\n    /// @notice Balance of the fees accumulator, in underlying units\n    function accumulatedFeesAssets() external view returns (uint256);\n\n    /// @notice Address of the original vault creator\n    function creator() external view returns (address);\n\n    /// @notice Creates shares for the receiver, from excess asset balances of the vault (not accounted for in `cash`)\n    /// @param amount Amount of assets to claim (use max uint256 to claim all available assets)\n    /// @param receiver An account to receive the shares\n    /// @return Amount of shares minted\n    /// @dev Could be used as an alternative deposit flow in certain scenarios. E.g. swap directly to the vault, call `skim` to claim deposit.\n    function skim(uint256 amount, address receiver) external returns (uint256);\n}\n\n/// @title IBorrowing\n/// @notice Interface of the EVault's Borrowing module\ninterface IBorrowing {\n    /// @notice Sum of all outstanding debts, in underlying units (increases as interest is accrued)\n    function totalBorrows() external view returns (uint256);\n\n    /// @notice Sum of all outstanding debts, in underlying units scaled up by shifting INTERNAL_DEBT_PRECISION_SHIFT bits\n    function totalBorrowsExact() external view returns (uint256);\n\n    /// @notice Balance of vault assets as tracked by deposits/withdrawals and borrows/repays\n    function cash() external view returns (uint256);\n\n    /// @notice Debt owed by a particular account, in underlying units\n    function debtOf(address account) external view returns (uint256);\n\n    /// @notice Debt owed by a particular account, in underlying units scaled up by shifting INTERNAL_DEBT_PRECISION_SHIFT bits\n    function debtOfExact(address account) external view returns (uint256);\n\n    /// @notice Retrieves the current interest rate for an asset\n    /// @return The interest rate in yield-per-second, scaled by 10**27\n    function interestRate() external view returns (uint256);\n\n    /// @notice Retrieves the current interest rate accumulator for an asset\n    /// @return An opaque accumulator that increases as interest is accrued\n    function interestAccumulator() external view returns (uint256);\n\n    /// @notice Address of the sidecar DToken\n    function dToken() external view returns (address);\n\n    /// @notice Transfer underlying tokens from the vault to the sender, and increase sender's debt\n    /// @param amount Amount of assets to borrow (use max uint256 for all available tokens)\n    /// @param receiver Account receiving the borrowed tokens\n    /// @return Amount of assets borrowed\n    function borrow(uint256 amount, address receiver) external returns (uint256);\n\n    /// @notice Transfer underlying tokens from the sender to the vault, and decrease receiver's debt\n    /// @param amount Amount of debt to repay in assets (use max uint256 for full debt)\n    /// @param receiver Account holding the debt to be repaid\n    /// @return Amount of assets repaid\n    function repay(uint256 amount, address receiver) external returns (uint256);\n\n    /// @notice Mint shares and a corresponding amount of debt (\"self-borrow\")\n    /// @param amount In asset units\n    /// @param sharesReceiver Account to receive the created shares\n    /// @return Amount of shares created\n    /// @dev Equivalent to looping borrows and deposits\n    function loop(uint256 amount, address sharesReceiver) external returns (uint256);\n\n    /// @notice Pay off liability with shares (\"self-repay\")\n    /// @param amount In asset units (use max uint256 to repay the debt in full or up to the available underlying balance)\n    /// @param debtFrom Account to remove debt from by burning sender's shares\n    /// @return Amount of shares burned\n    /// @dev Equivalent to withdrawing and repaying\n    function deloop(uint256 amount, address debtFrom) external returns (uint256);\n\n    /// @notice Take over debt from another account\n    /// @param amount Amount of debt in asset units (use max uint256 for all the account's debt)\n    /// @param from Account to pull the debt from\n    /// @return Amount of debt pulled in asset units.\n    function pullDebt(uint256 amount, address from) external returns (uint256);\n\n    /// @notice Request a flash-loan. A onFlashLoan() callback in msg.sender will be invoked, which must repay the loan to the main Euler address prior to returning.\n    /// @param amount In asset units\n    /// @param data Passed through to the onFlashLoan() callback, so contracts don't need to store transient data in storage\n    function flashLoan(uint256 amount, bytes calldata data) external;\n\n    /// @notice Updates interest accumulator and totalBorrows, credits reserves, re-targets interest rate, and logs vault status\n    function touch() external;\n}\n\n/// @title ILiquidation\n/// @notice Interface of the EVault's Liquidation module\ninterface ILiquidation {\n    /// @notice Checks to see if a liquidation would be profitable, without actually doing anything\n    /// @param liquidator Address that will initiate the liquidation\n    /// @param violator Address that may be in collateral violation\n    /// @param collateral Collateral which is to be seized\n    /// @return maxRepay Max amount of debt that can be repaid, in asset units\n    /// @return maxYield Yield in collateral corresponding to max allowed amount of debt to be repaid, in collateral balance (shares for vaults)\n    function checkLiquidation(address liquidator, address violator, address collateral)\n        external\n        view\n        returns (uint256 maxRepay, uint256 maxYield);\n\n    /// @notice Attempts to perform a liquidation\n    /// @param violator Address that may be in collateral violation\n    /// @param collateral Collateral which is to be seized\n    /// @param repayAssets The amount of underlying debt to be transferred from violator to sender, in asset units (use max uint256 to repay the maximum possible amount).\n    /// @param minYieldBalance The minimum acceptable amount of collateral to be transferred from violator to sender, in collateral balance units (shares for vaults)\n    function liquidate(address violator, address collateral, uint256 repayAssets, uint256 minYieldBalance) external;\n}\n\n/// @title IRiskManager\n/// @notice Interface of the EVault's RiskManager module\ninterface IRiskManager is IEVCVault {\n    /// @notice Retrieve account's total liquidity\n    /// @param account Account holding debt in this vault\n    /// @param liquidation Flag to indicate if the calculation should be performed in liquidation vs account status check mode, where different LTV values might apply.\n    /// @return collateralValue Total risk adjusted value of all collaterals in unit of account\n    /// @return liabilityValue Value of debt in unit of account\n    function accountLiquidity(address account, bool liquidation)\n        external\n        view\n        returns (uint256 collateralValue, uint256 liabilityValue);\n\n    /// @notice Retrieve account's liquidity per collateral\n    /// @param account Account holding debt in this vault\n    /// @param liquidation Flag to indicate if the calculation should be performed in liquidation vs account status check mode, where different LTV values might apply.\n    /// @return collaterals Array of collaterals enabled\n    /// @return collateralValues Array of risk adjusted collateral values corresponding to items in collaterals array. In unit of account\n    /// @return liabilityValue Value of debt in unit of account\n    function accountLiquidityFull(address account, bool liquidation)\n        external\n        view\n        returns (address[] memory collaterals, uint256[] memory collateralValues, uint256 liabilityValue);\n\n    /// @notice Release control of the account on EVC if no outstanding debt is present\n    function disableController() external;\n\n    /// @notice Checks the status of an account and reverts if account is not healthy\n    /// @param account The address of the account to be checked\n    /// @return magicValue Must return the bytes4 magic value 0xb168c58f (which is a selector of this function) when account status is valid, or revert otherwise.\n    /// @dev Only callable by EVC during status checks\n    function checkAccountStatus(address account, address[] calldata collaterals) external returns (bytes4);\n\n    /// @notice Checks the status of the vault and reverts if caps are exceeded\n    /// @return magicValue Must return the bytes4 magic value 0x4b3d1223 (which is a selector of this function) when account status is valid, or revert otherwise.\n    /// @dev Only callable by EVC during status checks\n    function checkVaultStatus() external returns (bytes4);\n}\n\n/// @title IBalanceForwarder\n/// @notice Interface of the EVault's BalanceForwarder module\ninterface IBalanceForwarder {\n    /// @notice Retrieve the address of rewards contract, tracking changes in account's balances\n    function balanceTrackerAddress() external view returns (address);\n\n    /// @notice Retrieves boolean indicating if the account opted in to forward balance changes to the rewards contract\n    function balanceForwarderEnabled(address account) external view returns (bool);\n\n    /// @notice Enables balance forwarding for the authenticated account\n    /// @dev Only the authenticated account can enable balance forwarding for itself\n    /// @dev Should call the IBalanceTracker hook with the current account's balance\n    function enableBalanceForwarder() external;\n\n    /// @notice Disables balance forwarding for the authenticated account\n    /// @dev Only the authenticated account can disable balance forwarding for itself\n    /// @dev Should call the IBalanceTracker hook with the account's balance of 0\n    function disableBalanceForwarder() external;\n}\n\n/// @title IGovernance\n/// @notice Interface of the EVault's Governance module\ninterface IGovernance {\n    /// @notice Retrieves the address of the governor\n    function governorAdmin() external view returns (address);\n\n    /// @notice Retrieves address of the governance fee receiver\n    function feeReceiver() external view returns (address);\n\n    /// @notice Retrieves the interest fee in effect for the vault\n    /// @return Amount of interest that is redirected as a fee, as a fraction scaled by 1e4\n    function interestFee() external view returns (uint16);\n\n    /// @notice Looks up an asset's currently configured interest rate model\n    /// @return Address of the interest rate contract or address zero to indicate 0% interest\n    function interestRateModel() external view returns (address);\n\n    /// @notice Retrieves the ProtocolConfig address\n    function protocolConfigAddress() external view returns (address);\n\n    /// @notice Retrieves the protocol fee share\n    /// @return A percentage share of fees accrued belonging to the protocol. In wad scale (1e18)\n    function protocolFeeShare() external view returns (uint256);\n\n    /// @notice Retrieves the address which will receive protocol's fees\n    function protocolFeeReceiver() external view returns (address);\n\n    /// @notice Retrieves supply and borrow caps in AmountCap format\n    function caps() external view returns (uint16 supplyCap, uint16 borrowCap);\n\n    /// @notice Retrieves regular LTV, set for the collateral, which is used to determine the health of the account\n    function borrowingLTV(address collateral) external view returns (uint16);\n\n    /// @notice Retrieves current ramped value of LTV, which is used to determine liquidation penalty\n    function liquidationLTV(address collateral) external view returns (uint16);\n\n    /// @notice Retrieves LTV detailed config for a collateral\n    /// @param collateral Collateral asset\n    /// @return targetTimestamp the timestamp when the ramp ends\n    /// @return targetLTV current regular LTV or target LTV that the ramped LTV will reach after ramp is over\n    /// @return rampDuration ramp duration in seconds\n    /// @return originalLTV previous LTV value, where the ramp starts\n    function LTVFull(address collateral)\n        external\n        view\n        returns (uint48 targetTimestamp, uint16 targetLTV, uint32 rampDuration, uint16 originalLTV);\n\n    /// @notice Retrieves a list of collaterals with configured LTVs\n    /// @return List of asset collaterals\n    /// @dev The list can have duplicates. Returned assets could have the ltv disabled (set to zero)\n    function LTVList() external view returns (address[] memory);\n\n    /// @notice Retrieves a hook target and a bitmask indicating which operations call the hook target.\n    function hookConfig() external view returns (address, uint32);\n\n    /// @notice Retrieves a bitmask indicating enabled config flags.\n    function configFlags() external view returns (uint32);\n\n    /// @notice Address of EthereumVaultConnector contract\n    function EVC() external view returns (address);\n\n    /// @notice Retrieves a reference asset used for liquidity calculations\n    function unitOfAccount() external view returns (address);\n\n    /// @notice Retrieves the address of the oracle contract\n    function oracle() external view returns (address);\n\n    /// @notice Retrieves the Permit2 contract address\n    function permit2Address() external view returns (address);\n\n    /// @notice Splits accrued fees balance according to protocol fee share and transfers shares to the governor fee receiver and protocol fee receiver\n    function convertFees() external;\n\n    /// @notice Set a new eToken name\n    function setName(string calldata newName) external;\n\n    /// @notice Set a new eToken symbol\n    function setSymbol(string calldata newSymbol) external;\n\n    /// @notice Set a new governor address\n    function setGovernorAdmin(address newGovernorAdmin) external;\n\n    /// @notice Set a new governor fee receiver address\n    function setFeeReceiver(address newFeeReceiver) external;\n\n    /// @notice Set a new LTV config\n    /// @param collateral Address of collateral to set LTV for\n    /// @param ltv New LTV in 1e4 scale\n    /// @param rampDuration Ramp duration in seconds\n    function setLTV(address collateral, uint16 ltv, uint32 rampDuration) external;\n\n    /// @notice Completely clears LTV configuratrion, signalling the collateral is not considered safe to liquidate anymore\n    /// @param collateral Address of collateral\n    function clearLTV(address collateral) external;\n\n    /// @notice Set a new interest rate model contract\n    /// @param newModel Address of the contract\n    function setInterestRateModel(address newModel) external;\n\n    /// @notice Set a new hook target and a new bitmap indicating which operations should call the hook target. Operations are defined in Constants.sol\n    function setHookConfig(address newHookTarget, uint32 newHookedOps) external;\n\n    /// @notice Set new bitmap indicating which config flags should be enabled. Flags are defined in Constants.sol\n    function setConfigFlags(uint32 newConfigFlags) external;\n\n    /// @notice Set new supply and borrow caps in AmountCap format\n    function setCaps(uint16 supplyCap, uint16 borrowCap) external;\n\n    /// @notice Set a new interest fee\n    function setInterestFee(uint16 newFee) external;\n}\n\n/// @title IEVault\n/// @notice Interface of the EVault, an EVC enabled lending vault\ninterface IEVault is\n    IInitialize,\n    IToken,\n    IVault,\n    IBorrowing,\n    ILiquidation,\n    IRiskManager,\n    IBalanceForwarder,\n    IGovernance\n{\n    /// @notice Fetch address of the `Initialize` module\n    function MODULE_INITIALIZE() external view returns (address);\n    /// @notice Fetch address of the `Token` module\n    function MODULE_TOKEN() external view returns (address);\n    /// @notice Fetch address of the `Vault` module\n    function MODULE_VAULT() external view returns (address);\n    /// @notice Fetch address of the `Borrowing` module\n    function MODULE_BORROWING() external view returns (address);\n    /// @notice Fetch address of the `Liquidation` module\n    function MODULE_LIQUIDATION() external view returns (address);\n    /// @notice Fetch address of the `RiskManager` module\n    function MODULE_RISKMANAGER() external view returns (address);\n    /// @notice Fetch address of the `BalanceForwarder` module\n    function MODULE_BALANCE_FORWARDER() external view returns (address);\n    /// @notice Fetch address of the `Governance` module\n    function MODULE_GOVERNANCE() external view returns (address);\n}"
    }
  ]
}