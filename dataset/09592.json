{
  "Title": "[N-03] NatSpec is incomplete",
  "Content": "\n1.  File: contracts/interfaces/INFTLoanFacilitator.sol (lines [286-288](https://github.com/code-423n4/2022-04-backed/blob/e8015d7c4b295af131f017e646ba1b99c8f608f0/contracts/interfaces/INFTLoanFacilitator.sol#L286-L288))\n\n```solidity\n* @param loanId The loan id\n*/\nfunction totalOwed(uint256 loanId) view external returns (uint256);\n```\n\nMissing: `@return`\n\n2.  File: contracts/interfaces/INFTLoanFacilitator.sol (lines [292-294](https://github.com/code-423n4/2022-04-backed/blob/e8015d7c4b295af131f017e646ba1b99c8f608f0/contracts/interfaces/INFTLoanFacilitator.sol#L292-L294))\n\n```solidity\n* @param loanId The loan id\n*/\nfunction interestOwed(uint256 loanId) view external returns (uint256);\n```\n\nMissing: `@return`\n\n3.  File: contracts/interfaces/INFTLoanFacilitator.sol (lines [298-300](https://github.com/code-423n4/2022-04-backed/blob/e8015d7c4b295af131f017e646ba1b99c8f608f0/contracts/interfaces/INFTLoanFacilitator.sol#L298-L300))\n\n```solidity\n* @param loanId The loan id\n*/\nfunction loanEndSeconds(uint256 loanId) view external returns (uint256);\n```\n\nMissing: `@return`\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2022-04-backed",
  "Code": [
    {
      "filename": "contracts/interfaces/INFTLoanFacilitator.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.12;\n\ninterface INFTLoanFacilitator {\n    /// @notice See loanInfo\n    struct Loan {\n        bool closed;\n        uint16 perAnumInterestRate;\n        uint32 durationSeconds;\n        uint40 lastAccumulatedTimestamp;\n        address collateralContractAddress;\n        address loanAssetContractAddress;\n        uint128 accumulatedInterest;\n        uint128 loanAmount;\n        uint256 collateralTokenId;\n    }\n\n    /**\n     * @notice The magnitude of SCALAR\n     * @dev 10^INTEREST_RATE_DECIMALS = 1 = 100%\n     */\n    function INTEREST_RATE_DECIMALS() external returns (uint8);\n\n    /**\n     * @notice The SCALAR for all percentages in the loan facilitator contract\n     * @dev Any interest rate passed to a function should already been multiplied by SCALAR\n     */\n    function SCALAR() external returns (uint256);\n\n    /**\n     * @notice The percent of the loan amount that the facilitator will take as a fee, scaled by SCALAR\n     * @dev Starts set to 1%. Can only be set to 0 - 5%. \n     */\n    function originationFeeRate() external returns (uint256);\n\n    /**\n     * @notice The lend ticket contract associated with this loan faciliator\n     * @dev Once set, cannot be modified\n     */\n    function lendTicketContract() external returns (address);\n\n    /**\n     * @notice The borrow ticket contract associated with this loan faciliator\n     * @dev Once set, cannot be modified\n     */\n    function borrowTicketContract() external returns (address);\n\n    /**\n     * @notice The percent improvement required of at least one loan term when buying out current lender \n     * a loan that already has a lender, scaled by SCALAR. \n     * E.g. setting this value to 100 (10%) means, when replacing a lender, the new loan terms must have\n     * at least 10% greater duration or loan amount or at least 10% lower interest rate. \n     * @dev Starts at 100 = 10%. Only owner can set. Cannot be set to 0.\n     */\n    function requiredImprovementRate() external returns (uint256);\n    \n    /**\n     * @notice Emitted when the loan is created\n     * @param id The id of the new loan, matches the token id of the borrow ticket minted in the same transaction\n     * @param minter msg.sender\n     * @param collateralTokenId The token id of the collateral NFT\n     * @param collateralContract The contract address of the collateral NFT\n     * @param maxInterestRate The max per anum interest rate, scaled by SCALAR\n     * @param loanAssetContract The contract address of the loan asset\n     * @param minLoanAmount mimimum loan amount\n     * @param minDurationSeconds minimum loan duration in seconds\n    */\n    event CreateLoan(\n        uint256 indexed id,\n        address indexed minter,\n        uint256 collateralTokenId,\n        address collateralContract,\n        uint256 maxInterestRate,\n        address loanAssetContract,\n        uint256 minLoanAmount,\n        uint256 minDurationSeconds\n        );\n\n    /** \n     * @notice Emitted when ticket is closed\n     * @param id The id of the ticket which has been closed\n     */\n    event Close(uint256 indexed id);\n\n    /** \n     * @notice Emitted when the loan is underwritten or re-underwritten\n     * @param id The id of the ticket which is being underwritten\n     * @param lender msg.sender\n     * @param interestRate The per anum interest rate, scaled by SCALAR, for the loan\n     * @param loanAmount The loan amount\n     * @param durationSeconds The loan duration in seconds \n     */\n    event Lend(\n        uint256 indexed id,\n        address indexed lender,\n        uint256 interestRate,\n        uint256 loanAmount,\n        uint256 durationSeconds\n    );\n\n    /**\n     * @notice Emitted when a loan is being re-underwritten, the current loan ticket holder is being bought out\n     * @param lender msg.sender\n     * @param replacedLoanOwner The current loan ticket holder\n     * @param interestEarned The amount of interest the loan has accrued from first lender to this buyout\n     * @param replacedAmount The loan amount prior to buyout\n     */    \n    event BuyoutLender(\n        uint256 indexed id,\n        address indexed lender,\n        address indexed replacedLoanOwner,\n        uint256 interestEarned,\n        uint256 replacedAmount\n    );\n    \n    /**\n     * @notice Emitted when loan is repaid\n     * @param id The loan id\n     * @param repayer msg.sender\n     * @param loanOwner The current holder of the lend ticket for this loan, token id matching the loan id\n     * @param interestEarned The total interest accumulated on the loan\n     * @param loanAmount The loan amount\n     */\n    event Repay(\n        uint256 indexed id,\n        address indexed repayer,\n        address indexed loanOwner,\n        uint256 interestEarned,\n        uint256 loanAmount\n    );\n\n    /**\n     * @notice Emitted when loan NFT collateral is seized \n     * @param id The ticket id\n     */\n    event SeizeCollateral(uint256 indexed id);\n\n     /**\n      * @notice Emitted when origination fees are withdrawn\n      * @dev only owner can call\n      * @param asset the ERC20 asset withdrawn\n      * @param amount the amount withdrawn\n      * @param to the address the withdrawn amount was sent to\n      */\n     event WithdrawOriginationFees(address asset, uint256 amount, address to);\n\n      /**\n      * @notice Emitted when originationFeeRate is updated\n      * @dev only owner can call, value is scaled by SCALAR, 100% = SCALAR\n      * @param feeRate the new origination fee rate\n      */\n     event UpdateOriginationFeeRate(uint32 feeRate);\n\n     /**\n      * @notice Emitted when requiredImprovementRate is updated\n      * @dev only owner can call, value is scaled by SCALAR, 100% = SCALAR\n      * @param improvementRate the new required improvementRate\n      */\n     event UpdateRequiredImprovementRate(uint256 improvementRate);\n\n    /**\n     * @notice (1) transfers the collateral NFT to the loan facilitator contract \n     * (2) creates the loan, populating loanInfo in the facilitator contract,\n     * and (3) mints a Borrow Ticket to mintBorrowTicketTo\n     * @dev loan duration or loan amount cannot be 0, \n     * this is done to protect borrowers from accidentally passing a default value\n     * and also because it creates odd lending and buyout behavior: possible to lend\n     * for 0 value or 0 duration, and possible to buyout with no improvement because, for example\n     * previousDurationSeconds + (previousDurationSeconds * requiredImprovementRate / SCALAR) <= durationSeconds\n     * evaluates to true if previousDurationSeconds is 0 and durationSeconds is 0.\n     * loanAssetContractAddress cannot be address(0), we check this because Solmate SafeTransferLib\n     * does not revert with address(0) and this could cause odd behavior.\n     * collateralContractAddress cannot be address(borrowTicket) or address(lendTicket).\n     * @param collateralTokenId The token id of the collateral NFT \n     * @param collateralContractAddress The contract address of the collateral NFT\n     * @param maxPerAnumInterest The maximum per anum interest rate for this loan, scaled by SCALAR\n     * @param minLoanAmount The minimum acceptable loan amount for this loan\n     * @param loanAssetContractAddress The address of the loan asset\n     * @param minDurationSeconds The minimum duration for this loan\n     * @param mintBorrowTicketTo An address to mint the Borrow Ticket corresponding to this loan to\n     * @return id of the created loan\n     */\n    function createLoan(\n            uint256 collateralTokenId,\n            address collateralContractAddress,\n            uint16 maxPerAnumInterest,\n            uint128 minLoanAmount,\n            address loanAssetContractAddress,\n            uint32 minDurationSeconds,\n            address mintBorrowTicketTo\n    ) external returns (uint256 id);\n\n    /**\n     * @notice Closes the loan, sends the NFT collateral to sendCollateralTo\n     * @dev Can only be called by the holder of the Borrow Ticket with tokenId\n     * matching the loanId. Can only be called if loan has not be underwritten,\n     * i.e. lastAccumulatedInterestTimestamp = 0\n     * @param loanId The loan id\n     * @param sendCollateralTo The address to send the collateral NFT to\n     */\n    function closeLoan(uint256 loanId, address sendCollateralTo) external;\n\n    /**\n     * @notice Lends, meeting or beating the proposed loan terms, \n     * transferring `amount` of the loan asset \n     * to the facilitator contract. If the loan has not yet been underwritten, \n     * a Lend Ticket is minted to `sendLendTicketTo`. If the loan has already been \n     * underwritten, then this is a buyout, and the Lend Ticket will be transferred\n     * from the current holder to `sendLendTicketTo`. Also in the case of a buyout, interestOwed()\n     * is transferred from the caller to the facilitator contract, in addition to `amount`, and\n     * totalOwed() is paid to the current Lend Ticket holder.\n     * @dev Loan terms must meet or beat loan terms. If a buyout, at least one loan term\n     * must be improved by at least 10%. E.g. 10% longer duration, 10% lower interest, \n     * 10% higher amount\n     * @param loanId The loan id\n     * @param interestRate The per anum interest rate, scaled by SCALAR\n     * @param amount The loan amount\n     * @param durationSeconds The loan duration in seconds\n     * @param sendLendTicketTo The address to send the Lend Ticket to\n     */\n    function lend(\n            uint256 loanId,\n            uint16 interestRate,\n            uint128 amount,\n            uint32 durationSeconds,\n            address sendLendTicketTo\n    ) external;\n\n    /**\n     * @notice repays and closes the loan, transferring totalOwed() to the current Lend Ticket holder\n     * and transferring the collateral NFT to the Borrow Ticket holder.\n     * @param loanId The loan id\n     */\n    function repayAndCloseLoan(uint256 loanId) external;\n\n    /**\n     * @notice Transfers the collateral NFT to `sendCollateralTo` and closes the loan.\n     * @dev Can only be called by Lend Ticket holder. Can only be called \n     * if block.timestamp > loanEndSeconds()\n     * @param loanId The loan id\n     * @param sendCollateralTo The address to send the collateral NFT to\n     */\n    function seizeCollateral(uint256 loanId, address sendCollateralTo) external;\n\n    /**\n     * @notice returns the info for this loan\n     * @param loanId The id of the loan\n     * @return closed Whether or not the ticket is closed\n     * @return perAnumInterestRate The per anum interest rate, scaled by SCALAR\n     * @return durationSeconds The loan duration in seconds\n     \n     * @return lastAccumulatedTimestamp The timestamp (in seconds) when interest was last accumulated, \n     * i.e. the timestamp of the most recent underwriting\n     * @return collateralContractAddress The contract address of the NFT collateral \n     * @return loanAssetContractAddress The contract address of the loan asset.\n     * @return accumulatedInterest The amount of interest accumulated on the loan prior to the current lender\n     * @return loanAmount The loan amount\n     * @return collateralTokenId The token ID of the NFT collateral\n     */\n    function loanInfo(uint256 loanId)\n        external \n        view \n        returns (\n            bool closed,\n            uint16 perAnumInterestRate,\n            uint32 durationSeconds,\n            uint40 lastAccumulatedTimestamp,\n            address collateralContractAddress,\n            address loanAssetContractAddress,\n            uint128 accumulatedInterest,\n            uint128 loanAmount,\n            uint256 collateralTokenId\n        );\n\n    /**\n     * @notice returns the info for this loan\n     * @dev this is a convenience method for other contracts that would prefer to have the \n     * Loan object not decomposed. \n     * @param loanId The id of the loan\n     * @return Loan struct corresponding to loanId\n     */\n    function loanInfoStruct(uint256 loanId) external view returns (Loan memory);\n\n    /**\n     * @notice returns the total amount owed for the loan, i.e. principal + interest\n     * @param loanId The loan id\n     */\n    function totalOwed(uint256 loanId) view external returns (uint256);\n\n    /**\n     * @notice returns the interest owed on the loan, in loan asset units\n     * @param loanId The loan id\n     */\n    function interestOwed(uint256 loanId) view external returns (uint256);\n\n    /**\n     * @notice returns the unix timestamp (seconds) of the loan end\n     * @param loanId The loan id\n     */\n    function loanEndSeconds(uint256 loanId) view external returns (uint256);\n}"
    },
    {
      "filename": "contracts/interfaces/INFTLoanFacilitator.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.12;\n\ninterface INFTLoanFacilitator {\n    /// @notice See loanInfo\n    struct Loan {\n        bool closed;\n        uint16 perAnumInterestRate;\n        uint32 durationSeconds;\n        uint40 lastAccumulatedTimestamp;\n        address collateralContractAddress;\n        address loanAssetContractAddress;\n        uint128 accumulatedInterest;\n        uint128 loanAmount;\n        uint256 collateralTokenId;\n    }\n\n    /**\n     * @notice The magnitude of SCALAR\n     * @dev 10^INTEREST_RATE_DECIMALS = 1 = 100%\n     */\n    function INTEREST_RATE_DECIMALS() external returns (uint8);\n\n    /**\n     * @notice The SCALAR for all percentages in the loan facilitator contract\n     * @dev Any interest rate passed to a function should already been multiplied by SCALAR\n     */\n    function SCALAR() external returns (uint256);\n\n    /**\n     * @notice The percent of the loan amount that the facilitator will take as a fee, scaled by SCALAR\n     * @dev Starts set to 1%. Can only be set to 0 - 5%. \n     */\n    function originationFeeRate() external returns (uint256);\n\n    /**\n     * @notice The lend ticket contract associated with this loan faciliator\n     * @dev Once set, cannot be modified\n     */\n    function lendTicketContract() external returns (address);\n\n    /**\n     * @notice The borrow ticket contract associated with this loan faciliator\n     * @dev Once set, cannot be modified\n     */\n    function borrowTicketContract() external returns (address);\n\n    /**\n     * @notice The percent improvement required of at least one loan term when buying out current lender \n     * a loan that already has a lender, scaled by SCALAR. \n     * E.g. setting this value to 100 (10%) means, when replacing a lender, the new loan terms must have\n     * at least 10% greater duration or loan amount or at least 10% lower interest rate. \n     * @dev Starts at 100 = 10%. Only owner can set. Cannot be set to 0.\n     */\n    function requiredImprovementRate() external returns (uint256);\n    \n    /**\n     * @notice Emitted when the loan is created\n     * @param id The id of the new loan, matches the token id of the borrow ticket minted in the same transaction\n     * @param minter msg.sender\n     * @param collateralTokenId The token id of the collateral NFT\n     * @param collateralContract The contract address of the collateral NFT\n     * @param maxInterestRate The max per anum interest rate, scaled by SCALAR\n     * @param loanAssetContract The contract address of the loan asset\n     * @param minLoanAmount mimimum loan amount\n     * @param minDurationSeconds minimum loan duration in seconds\n    */\n    event CreateLoan(\n        uint256 indexed id,\n        address indexed minter,\n        uint256 collateralTokenId,\n        address collateralContract,\n        uint256 maxInterestRate,\n        address loanAssetContract,\n        uint256 minLoanAmount,\n        uint256 minDurationSeconds\n        );\n\n    /** \n     * @notice Emitted when ticket is closed\n     * @param id The id of the ticket which has been closed\n     */\n    event Close(uint256 indexed id);\n\n    /** \n     * @notice Emitted when the loan is underwritten or re-underwritten\n     * @param id The id of the ticket which is being underwritten\n     * @param lender msg.sender\n     * @param interestRate The per anum interest rate, scaled by SCALAR, for the loan\n     * @param loanAmount The loan amount\n     * @param durationSeconds The loan duration in seconds \n     */\n    event Lend(\n        uint256 indexed id,\n        address indexed lender,\n        uint256 interestRate,\n        uint256 loanAmount,\n        uint256 durationSeconds\n    );\n\n    /**\n     * @notice Emitted when a loan is being re-underwritten, the current loan ticket holder is being bought out\n     * @param lender msg.sender\n     * @param replacedLoanOwner The current loan ticket holder\n     * @param interestEarned The amount of interest the loan has accrued from first lender to this buyout\n     * @param replacedAmount The loan amount prior to buyout\n     */    \n    event BuyoutLender(\n        uint256 indexed id,\n        address indexed lender,\n        address indexed replacedLoanOwner,\n        uint256 interestEarned,\n        uint256 replacedAmount\n    );\n    \n    /**\n     * @notice Emitted when loan is repaid\n     * @param id The loan id\n     * @param repayer msg.sender\n     * @param loanOwner The current holder of the lend ticket for this loan, token id matching the loan id\n     * @param interestEarned The total interest accumulated on the loan\n     * @param loanAmount The loan amount\n     */\n    event Repay(\n        uint256 indexed id,\n        address indexed repayer,\n        address indexed loanOwner,\n        uint256 interestEarned,\n        uint256 loanAmount\n    );\n\n    /**\n     * @notice Emitted when loan NFT collateral is seized \n     * @param id The ticket id\n     */\n    event SeizeCollateral(uint256 indexed id);\n\n     /**\n      * @notice Emitted when origination fees are withdrawn\n      * @dev only owner can call\n      * @param asset the ERC20 asset withdrawn\n      * @param amount the amount withdrawn\n      * @param to the address the withdrawn amount was sent to\n      */\n     event WithdrawOriginationFees(address asset, uint256 amount, address to);\n\n      /**\n      * @notice Emitted when originationFeeRate is updated\n      * @dev only owner can call, value is scaled by SCALAR, 100% = SCALAR\n      * @param feeRate the new origination fee rate\n      */\n     event UpdateOriginationFeeRate(uint32 feeRate);\n\n     /**\n      * @notice Emitted when requiredImprovementRate is updated\n      * @dev only owner can call, value is scaled by SCALAR, 100% = SCALAR\n      * @param improvementRate the new required improvementRate\n      */\n     event UpdateRequiredImprovementRate(uint256 improvementRate);\n\n    /**\n     * @notice (1) transfers the collateral NFT to the loan facilitator contract \n     * (2) creates the loan, populating loanInfo in the facilitator contract,\n     * and (3) mints a Borrow Ticket to mintBorrowTicketTo\n     * @dev loan duration or loan amount cannot be 0, \n     * this is done to protect borrowers from accidentally passing a default value\n     * and also because it creates odd lending and buyout behavior: possible to lend\n     * for 0 value or 0 duration, and possible to buyout with no improvement because, for example\n     * previousDurationSeconds + (previousDurationSeconds * requiredImprovementRate / SCALAR) <= durationSeconds\n     * evaluates to true if previousDurationSeconds is 0 and durationSeconds is 0.\n     * loanAssetContractAddress cannot be address(0), we check this because Solmate SafeTransferLib\n     * does not revert with address(0) and this could cause odd behavior.\n     * collateralContractAddress cannot be address(borrowTicket) or address(lendTicket).\n     * @param collateralTokenId The token id of the collateral NFT \n     * @param collateralContractAddress The contract address of the collateral NFT\n     * @param maxPerAnumInterest The maximum per anum interest rate for this loan, scaled by SCALAR\n     * @param minLoanAmount The minimum acceptable loan amount for this loan\n     * @param loanAssetContractAddress The address of the loan asset\n     * @param minDurationSeconds The minimum duration for this loan\n     * @param mintBorrowTicketTo An address to mint the Borrow Ticket corresponding to this loan to\n     * @return id of the created loan\n     */\n    function createLoan(\n            uint256 collateralTokenId,\n            address collateralContractAddress,\n            uint16 maxPerAnumInterest,\n            uint128 minLoanAmount,\n            address loanAssetContractAddress,\n            uint32 minDurationSeconds,\n            address mintBorrowTicketTo\n    ) external returns (uint256 id);\n\n    /**\n     * @notice Closes the loan, sends the NFT collateral to sendCollateralTo\n     * @dev Can only be called by the holder of the Borrow Ticket with tokenId\n     * matching the loanId. Can only be called if loan has not be underwritten,\n     * i.e. lastAccumulatedInterestTimestamp = 0\n     * @param loanId The loan id\n     * @param sendCollateralTo The address to send the collateral NFT to\n     */\n    function closeLoan(uint256 loanId, address sendCollateralTo) external;\n\n    /**\n     * @notice Lends, meeting or beating the proposed loan terms, \n     * transferring `amount` of the loan asset \n     * to the facilitator contract. If the loan has not yet been underwritten, \n     * a Lend Ticket is minted to `sendLendTicketTo`. If the loan has already been \n     * underwritten, then this is a buyout, and the Lend Ticket will be transferred\n     * from the current holder to `sendLendTicketTo`. Also in the case of a buyout, interestOwed()\n     * is transferred from the caller to the facilitator contract, in addition to `amount`, and\n     * totalOwed() is paid to the current Lend Ticket holder.\n     * @dev Loan terms must meet or beat loan terms. If a buyout, at least one loan term\n     * must be improved by at least 10%. E.g. 10% longer duration, 10% lower interest, \n     * 10% higher amount\n     * @param loanId The loan id\n     * @param interestRate The per anum interest rate, scaled by SCALAR\n     * @param amount The loan amount\n     * @param durationSeconds The loan duration in seconds\n     * @param sendLendTicketTo The address to send the Lend Ticket to\n     */\n    function lend(\n            uint256 loanId,\n            uint16 interestRate,\n            uint128 amount,\n            uint32 durationSeconds,\n            address sendLendTicketTo\n    ) external;\n\n    /**\n     * @notice repays and closes the loan, transferring totalOwed() to the current Lend Ticket holder\n     * and transferring the collateral NFT to the Borrow Ticket holder.\n     * @param loanId The loan id\n     */\n    function repayAndCloseLoan(uint256 loanId) external;\n\n    /**\n     * @notice Transfers the collateral NFT to `sendCollateralTo` and closes the loan.\n     * @dev Can only be called by Lend Ticket holder. Can only be called \n     * if block.timestamp > loanEndSeconds()\n     * @param loanId The loan id\n     * @param sendCollateralTo The address to send the collateral NFT to\n     */\n    function seizeCollateral(uint256 loanId, address sendCollateralTo) external;\n\n    /**\n     * @notice returns the info for this loan\n     * @param loanId The id of the loan\n     * @return closed Whether or not the ticket is closed\n     * @return perAnumInterestRate The per anum interest rate, scaled by SCALAR\n     * @return durationSeconds The loan duration in seconds\n     \n     * @return lastAccumulatedTimestamp The timestamp (in seconds) when interest was last accumulated, \n     * i.e. the timestamp of the most recent underwriting\n     * @return collateralContractAddress The contract address of the NFT collateral \n     * @return loanAssetContractAddress The contract address of the loan asset.\n     * @return accumulatedInterest The amount of interest accumulated on the loan prior to the current lender\n     * @return loanAmount The loan amount\n     * @return collateralTokenId The token ID of the NFT collateral\n     */\n    function loanInfo(uint256 loanId)\n        external \n        view \n        returns (\n            bool closed,\n            uint16 perAnumInterestRate,\n            uint32 durationSeconds,\n            uint40 lastAccumulatedTimestamp,\n            address collateralContractAddress,\n            address loanAssetContractAddress,\n            uint128 accumulatedInterest,\n            uint128 loanAmount,\n            uint256 collateralTokenId\n        );\n\n    /**\n     * @notice returns the info for this loan\n     * @dev this is a convenience method for other contracts that would prefer to have the \n     * Loan object not decomposed. \n     * @param loanId The id of the loan\n     * @return Loan struct corresponding to loanId\n     */\n    function loanInfoStruct(uint256 loanId) external view returns (Loan memory);\n\n    /**\n     * @notice returns the total amount owed for the loan, i.e. principal + interest\n     * @param loanId The loan id\n     */\n    function totalOwed(uint256 loanId) view external returns (uint256);\n\n    /**\n     * @notice returns the interest owed on the loan, in loan asset units\n     * @param loanId The loan id\n     */\n    function interestOwed(uint256 loanId) view external returns (uint256);\n\n    /**\n     * @notice returns the unix timestamp (seconds) of the loan end\n     * @param loanId The loan id\n     */\n    function loanEndSeconds(uint256 loanId) view external returns (uint256);\n}"
    },
    {
      "filename": "contracts/interfaces/INFTLoanFacilitator.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.12;\n\ninterface INFTLoanFacilitator {\n    /// @notice See loanInfo\n    struct Loan {\n        bool closed;\n        uint16 perAnumInterestRate;\n        uint32 durationSeconds;\n        uint40 lastAccumulatedTimestamp;\n        address collateralContractAddress;\n        address loanAssetContractAddress;\n        uint128 accumulatedInterest;\n        uint128 loanAmount;\n        uint256 collateralTokenId;\n    }\n\n    /**\n     * @notice The magnitude of SCALAR\n     * @dev 10^INTEREST_RATE_DECIMALS = 1 = 100%\n     */\n    function INTEREST_RATE_DECIMALS() external returns (uint8);\n\n    /**\n     * @notice The SCALAR for all percentages in the loan facilitator contract\n     * @dev Any interest rate passed to a function should already been multiplied by SCALAR\n     */\n    function SCALAR() external returns (uint256);\n\n    /**\n     * @notice The percent of the loan amount that the facilitator will take as a fee, scaled by SCALAR\n     * @dev Starts set to 1%. Can only be set to 0 - 5%. \n     */\n    function originationFeeRate() external returns (uint256);\n\n    /**\n     * @notice The lend ticket contract associated with this loan faciliator\n     * @dev Once set, cannot be modified\n     */\n    function lendTicketContract() external returns (address);\n\n    /**\n     * @notice The borrow ticket contract associated with this loan faciliator\n     * @dev Once set, cannot be modified\n     */\n    function borrowTicketContract() external returns (address);\n\n    /**\n     * @notice The percent improvement required of at least one loan term when buying out current lender \n     * a loan that already has a lender, scaled by SCALAR. \n     * E.g. setting this value to 100 (10%) means, when replacing a lender, the new loan terms must have\n     * at least 10% greater duration or loan amount or at least 10% lower interest rate. \n     * @dev Starts at 100 = 10%. Only owner can set. Cannot be set to 0.\n     */\n    function requiredImprovementRate() external returns (uint256);\n    \n    /**\n     * @notice Emitted when the loan is created\n     * @param id The id of the new loan, matches the token id of the borrow ticket minted in the same transaction\n     * @param minter msg.sender\n     * @param collateralTokenId The token id of the collateral NFT\n     * @param collateralContract The contract address of the collateral NFT\n     * @param maxInterestRate The max per anum interest rate, scaled by SCALAR\n     * @param loanAssetContract The contract address of the loan asset\n     * @param minLoanAmount mimimum loan amount\n     * @param minDurationSeconds minimum loan duration in seconds\n    */\n    event CreateLoan(\n        uint256 indexed id,\n        address indexed minter,\n        uint256 collateralTokenId,\n        address collateralContract,\n        uint256 maxInterestRate,\n        address loanAssetContract,\n        uint256 minLoanAmount,\n        uint256 minDurationSeconds\n        );\n\n    /** \n     * @notice Emitted when ticket is closed\n     * @param id The id of the ticket which has been closed\n     */\n    event Close(uint256 indexed id);\n\n    /** \n     * @notice Emitted when the loan is underwritten or re-underwritten\n     * @param id The id of the ticket which is being underwritten\n     * @param lender msg.sender\n     * @param interestRate The per anum interest rate, scaled by SCALAR, for the loan\n     * @param loanAmount The loan amount\n     * @param durationSeconds The loan duration in seconds \n     */\n    event Lend(\n        uint256 indexed id,\n        address indexed lender,\n        uint256 interestRate,\n        uint256 loanAmount,\n        uint256 durationSeconds\n    );\n\n    /**\n     * @notice Emitted when a loan is being re-underwritten, the current loan ticket holder is being bought out\n     * @param lender msg.sender\n     * @param replacedLoanOwner The current loan ticket holder\n     * @param interestEarned The amount of interest the loan has accrued from first lender to this buyout\n     * @param replacedAmount The loan amount prior to buyout\n     */    \n    event BuyoutLender(\n        uint256 indexed id,\n        address indexed lender,\n        address indexed replacedLoanOwner,\n        uint256 interestEarned,\n        uint256 replacedAmount\n    );\n    \n    /**\n     * @notice Emitted when loan is repaid\n     * @param id The loan id\n     * @param repayer msg.sender\n     * @param loanOwner The current holder of the lend ticket for this loan, token id matching the loan id\n     * @param interestEarned The total interest accumulated on the loan\n     * @param loanAmount The loan amount\n     */\n    event Repay(\n        uint256 indexed id,\n        address indexed repayer,\n        address indexed loanOwner,\n        uint256 interestEarned,\n        uint256 loanAmount\n    );\n\n    /**\n     * @notice Emitted when loan NFT collateral is seized \n     * @param id The ticket id\n     */\n    event SeizeCollateral(uint256 indexed id);\n\n     /**\n      * @notice Emitted when origination fees are withdrawn\n      * @dev only owner can call\n      * @param asset the ERC20 asset withdrawn\n      * @param amount the amount withdrawn\n      * @param to the address the withdrawn amount was sent to\n      */\n     event WithdrawOriginationFees(address asset, uint256 amount, address to);\n\n      /**\n      * @notice Emitted when originationFeeRate is updated\n      * @dev only owner can call, value is scaled by SCALAR, 100% = SCALAR\n      * @param feeRate the new origination fee rate\n      */\n     event UpdateOriginationFeeRate(uint32 feeRate);\n\n     /**\n      * @notice Emitted when requiredImprovementRate is updated\n      * @dev only owner can call, value is scaled by SCALAR, 100% = SCALAR\n      * @param improvementRate the new required improvementRate\n      */\n     event UpdateRequiredImprovementRate(uint256 improvementRate);\n\n    /**\n     * @notice (1) transfers the collateral NFT to the loan facilitator contract \n     * (2) creates the loan, populating loanInfo in the facilitator contract,\n     * and (3) mints a Borrow Ticket to mintBorrowTicketTo\n     * @dev loan duration or loan amount cannot be 0, \n     * this is done to protect borrowers from accidentally passing a default value\n     * and also because it creates odd lending and buyout behavior: possible to lend\n     * for 0 value or 0 duration, and possible to buyout with no improvement because, for example\n     * previousDurationSeconds + (previousDurationSeconds * requiredImprovementRate / SCALAR) <= durationSeconds\n     * evaluates to true if previousDurationSeconds is 0 and durationSeconds is 0.\n     * loanAssetContractAddress cannot be address(0), we check this because Solmate SafeTransferLib\n     * does not revert with address(0) and this could cause odd behavior.\n     * collateralContractAddress cannot be address(borrowTicket) or address(lendTicket).\n     * @param collateralTokenId The token id of the collateral NFT \n     * @param collateralContractAddress The contract address of the collateral NFT\n     * @param maxPerAnumInterest The maximum per anum interest rate for this loan, scaled by SCALAR\n     * @param minLoanAmount The minimum acceptable loan amount for this loan\n     * @param loanAssetContractAddress The address of the loan asset\n     * @param minDurationSeconds The minimum duration for this loan\n     * @param mintBorrowTicketTo An address to mint the Borrow Ticket corresponding to this loan to\n     * @return id of the created loan\n     */\n    function createLoan(\n            uint256 collateralTokenId,\n            address collateralContractAddress,\n            uint"
    }
  ]
}