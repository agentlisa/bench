{
  "Title": "[L04] OwnerChanger cannot renounce its role",
  "Content": "The role management scheme implemented in the [`Ownable` contract](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/Ownable.sol) does not include a way for [the `ownerChanger`](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/Ownable.sol#L6) to renounce the role they have been granted. This might become problematic in a scenario where the account wishes to renounce the role after the trusted device holding the private keys has been compromised.\n\n\nAlso, in the case where [the current `owner`](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/Ownable.sol#L5) may want to transfer its ownership with [the `transferOwnership` function](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/Ownable.sol#L26), the `ownerChanger` could reject every single transfer at his will by not calling [the `acceptTransferOwnership` function](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/Ownable.sol#L34), and as the `ownerChanger` role is not transferable, the `owner` role transfer operation could get compromised.\n\n\nConsider using multisig accounts for both roles to prevent that one of them becomes compromised, and adding the option to renounce the `ownerChanger` role if needed.\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/Ownable.sol",
      "content": "pragma solidity ^0.5.16;\r\n\r\n // Taking ideas from Open Zeppelin's Pausable contract\r\ncontract Ownable {\r\n    address public owner;\r\n    address public ownerChanger;\r\n    address public pendingOwner;\r\n\r\n    event OwnershipTransferRequested(address newPendingOwner);\r\n\r\n    event OwnershipTransferred(address oldOwner, address newOwner);\r\n\r\n    // The Ownable constructor sets the `ownerChanger` and the original `owner` of the contract.\r\n    constructor (address newOwnerChanger) public {\r\n        owner = msg.sender;\r\n        ownerChanger = newOwnerChanger;\r\n    }\r\n\r\n    // Modifier to make a function callable only by owner\r\n    modifier onlyOwner() {\r\n        require(msg.sender == owner, 'Sender should be Owner');\r\n        _;\r\n    }\r\n\r\n    // Allows the current owner to transfer control of the contract to a newOwner. (It should be accepted by OwnerChanger)\r\n    function transferOwnership(address newOwner) external onlyOwner {\r\n        require(newOwner != address(0),'New owner can not be zero address');\r\n        pendingOwner = newOwner;\r\n\r\n        emit OwnershipTransferRequested(newOwner);\r\n    }\r\n\r\n    // Owner changer can accept if owner call transferOwnership function\r\n    function acceptTransferOwnership () external {\r\n        require (msg.sender == ownerChanger, 'Sender should be ownerChanger');\r\n        require (pendingOwner != address(0), 'Pending Owner is empty');\r\n        address oldOwner = owner;\r\n        owner = pendingOwner;\r\n        pendingOwner = address(0);\r\n\r\n        emit OwnershipTransferred(oldOwner, pendingOwner);\r\n    }\r\n}"
    }
  ]
}