{
  "Title": "OpenZeppelin standard contracts were modified",
  "Content": "Additionally to copying OpenZeppelin’s contracts instead of installing them via NPM, some of them were modified.\n\n\nThe contract `BasicToken` was modified to add a state variable [`contractAddress`](https://github.com/waxio/wax-erc20-delivery-contract/blob/6c7098dd2522630d74c9600f678b3b28d58fa9aa/contracts/zeppelin-solidity/contracts/token/BasicToken.sol#L14), and the functions [`transfer`](https://github.com/waxio/wax-erc20-delivery-contract/blob/6c7098dd2522630d74c9600f678b3b28d58fa9aa/contracts/zeppelin-solidity/contracts/token/BasicToken.sol#L23), and [`transferFrom`](https://github.com/waxio/wax-erc20-delivery-contract/blob/6c7098dd2522630d74c9600f678b3b28d58fa9aa/contracts/zeppelin-solidity/contracts/token/StandardToken.sol#L26) in `StandardToken` were modified to require that the receiver of tokens is not the `WaxToken` contract itself.\n\n\nThis is not the way OpenZeppelin standard contracts should be used. Making changes to open-source libraries, instead of using them as is, can be dangerous and won’t allow you to integrate bug-fixes into the codebase easily.\n\n\nAdd these additional preconditions to the `WaxToken` contract, instead of OpenZeppelin’s contracts. For example, [override the `transfer` function](https://github.com/waxio/wax-erc20-delivery-contract/blob/6c7098dd2522630d74c9600f678b3b28d58fa9aa/contracts/WaxToken.sol#L50) adding the additional restriction and call `super.transfer(…)` within it. (Note: this has actually already been done, so it’s a matter of removing the modifications to OpenZeppelin’s contracts.)\n\n\n***Update:** Fixed in [`57d8603`](https://github.com/waxio/wax-erc20-delivery-contract/commit/57d8603638d813da17fb725374749e9d9f38b8dc).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/zeppelin-solidity/contracts/token/BasicToken.sol",
      "content": "pragma solidity ^0.4.11;\n\n\nimport './ERC20Basic.sol';\nimport '../math/SafeMath.sol';\n\n\n/**\n * @title Basic token\n * @dev Basic version of StandardToken, with no allowances.\n */\ncontract BasicToken is ERC20Basic {\n  using SafeMath for uint256;\n  address public contractAddress;\n\n  mapping(address => uint256) balances;\n\n  /**\n  * @dev transfer token for a specified address\n  * @param _to The address to transfer to.\n  * @param _value The amount to be transferred.\n  */\n  function transfer(address _to, uint256 _value) public returns (bool) {\n    require(_to != address(0));\n    require(_to != contractAddress);\n    require(_value <= balances[msg.sender]);\n\n    // SafeMath.sub will throw if there is not enough balance.\n    balances[msg.sender] = balances[msg.sender].sub(_value);\n    balances[_to] = balances[_to].add(_value);\n    Transfer(msg.sender, _to, _value);\n    return true;\n  }\n\n  /**\n  * @dev Gets the balance of the specified address.\n  * @param _owner The address to query the the balance of.\n  * @return An uint256 representing the amount owned by the passed address.\n  */\n  function balanceOf(address _owner) public constant returns (uint256 balance) {\n    return balances[_owner];\n  }\n\n}"
    },
    {
      "filename": "contracts/WaxToken.sol",
      "content": "pragma solidity ^0.4.13;\n\n\nimport \"./zeppelin-solidity/contracts/token/StandardToken.sol\";\nimport \"./zeppelin-solidity/contracts/lifecycle/Pausable.sol\";\n\n\n/**\n * @title WaxToken\n * @dev ERC20 Wax Token (WAX)\n *\n * WAX Tokens are divisible by 1e8 (100,000,000) base\n * units referred to as 'Grains'.\n *\n * WAX are displayed using 8 decimal places of precision.\n *\n * 1 WAX is equivalent to:\n *   100000000 == 1 * 10**8 == 1e8 == One Hundred Million Grains\n *\n * 1 Billion WAX (total supply) is equivalent to:\n *   100000000000000000 == 1000000000 * 10**8 == 1e17 == One Hundred Quadrillion Grains\n *\n * All initial WAX Grains are assigned to the creator of\n * this contract.\n *\n */\ncontract WaxToken is StandardToken, Pausable {\n\n  string public constant name = 'Wax Token';                          // Set the token name for display\n  string public constant symbol = 'WAX';                                 // Set the token symbol for display\n  uint8 public constant decimals = 8;                                  // Set the number of decimals for display\n  uint256 public constant INITIAL_SUPPLY = 1000000000 * 10**uint256(decimals);    // 1 Billion VEE specified in Grains\n\n  /**\n   * @dev WaxToken Constructor\n   * Runs only on initial contract creation.\n   */\n  function WaxToken() {\n    totalSupply = INITIAL_SUPPLY;                               // Set the total supply\n    balances[msg.sender] = INITIAL_SUPPLY;                      // Creator address is assigned all\n    contractAddress = this;\n    Transfer(0x0, msg.sender, INITIAL_SUPPLY);\n  }\n\n  /**\n   * @dev Transfer token for a specified address when not paused\n   * @param _to The address to transfer to.\n   * @param _value The amount to be transferred.\n   */\n  function transfer(address _to, uint256 _value) whenNotPaused returns (bool) {\n    require(_to != address(0));\n    require(_to != contractAddress);\n    return super.transfer(_to, _value);\n  }\n\n  /**\n   * @dev Transfer tokens from one address to another when not paused\n   * @param _from address The address which you want to send tokens from\n   * @param _to address The address which you want to transfer to\n   * @param _value uint256 the amount of tokens to be transferred\n   */\n  function transferFrom(address _from, address _to, uint256 _value) whenNotPaused returns (bool) {\n    require(_to != address(0));\n    require(_to != contractAddress);\n    return super.transferFrom(_from, _to, _value);\n  }\n\n  /**\n   * @dev Aprove the passed address to spend the specified amount of tokens on behalf of msg.sender when not paused.\n   * @param _spender The address which will spend the funds.\n   * @param _value The amount of tokens to be spent.\n   */\n  function approve(address _spender, uint256 _value) whenNotPaused returns (bool) {\n    return super.approve(_spender, _value);\n  }\n\n  function() payable {\n      revert();\n  }\n\n}"
    }
  ]
}