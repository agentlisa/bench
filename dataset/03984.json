{
  "Title": "[L02] Interfaces are missing functions present in their implementations",
  "Content": "Some interfaces are not fully matching their implementation. For example:\n\n\n* The [`IAccounts` interface](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/interfaces/IAccounts.sol#L3) is implemented by the [`Accounts` contract](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/Accounts.sol#L13). The implementation includes extra functions not declared in `IAccounts`: [`removeVoteSigner`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/Accounts.sol#L280), [`removeValidatorSigner`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/Accounts.sol#L289), and [`removeAttestationSigner`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/Accounts.sol#L298).\n* The [`IStableToken` interface](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/stability/interfaces/IStableToken.sol#L7) is implemented by the [`StableToken` contract](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/stability/StableToken.sol#L20). In a recent change to the `StableToken` implementation, the function [`debitFrom` was renamed to `debitGasFee`](https://github.com/celo-org/celo-monorepo/pull/2805/files#diff-9077d537b24cd178986feb7453d4bcc0L468) and the function [`creditTo` was renamed to `creditGasFee`](https://github.com/celo-org/celo-monorepo/pull/2805/files#diff-9077d537b24cd178986feb7453d4bcc0L486).  \n\nHowever, [in the interface these functions were just removed](https://github.com/celo-org/celo-monorepo/pull/2805/files#diff-c7abfa40848318538f5f04c89be2462aL10-L11), not renamed.\n* The [`IFreezer` interface](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/interfaces/IFreezer.sol#L3) is implemented by the [`Freezer` contract](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/Freezer.sol#L8). The interface is missing the declaration of the [`freeze`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/Freezer.sol#L19) and [`unfreeze`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/common/Freezer.sol#L27) functions.\n* The [`IReleaseGold` interface](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/governance/interfaces/IReleaseGold.sol#L3) is implemented by the [`ReleaseGold` contract](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/governance/ReleaseGold.sol#L12). The interface is missing the declaration of the [`setLiquidityProvision`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/governance/ReleaseGold.sol#L242), [`setMaxDistribution`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/governance/ReleaseGold.sol#L255), [`setBeneficiary`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/governance/ReleaseGold.sol#L271), [`authorizeValidationSigner`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/governance/ReleaseGold.sol#L466), and [`authorizeAttestationSigner`](https://github.com/celo-org/celo-monorepo/blob/db2e561e1f13220a98743a7999818e48a5089d13/packages/protocol/contracts/governance/ReleaseGold.sol#L484) functions.\n\n\nThese mismatches between the interface and its implementation are confusing. It can mean that there are problems with the modeling of the system or that the updates to the implemenations and interfaces got out of sync.\n\n\nConsider adding the missing functions to the corresponding interface, so there is one basic implementation that directly matches the interface specification. Alternatively, if there are reasons for these functions to be only in the implementations, for each case consider to add a new contract that inherits from the basic implementation, to move the extra functions to this contract, and to add to its docstrings the reason for extending the interface.\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "packages/protocol/contracts/common/interfaces/IAccounts.sol",
      "content": "pragma solidity ^0.5.3;\n\ninterface IAccounts {\n  function isAccount(address) external view returns (bool);\n  function voteSignerToAccount(address) external view returns (address);\n  function validatorSignerToAccount(address) external view returns (address);\n  function attestationSignerToAccount(address) external view returns (address);\n  function signerToAccount(address) external view returns (address);\n  function getValidatorSigner(address) external view returns (address);\n  function getAttestationSigner(address) external view returns (address);\n  function hasAuthorizedVoteSigner(address) external view returns (bool);\n  function hasAuthorizedValidatorSigner(address) external view returns (bool);\n  function hasAuthorizedAttestationSigner(address) external view returns (bool);\n\n  function setAccountDataEncryptionKey(bytes calldata) external;\n  function setMetadataURL(string calldata) external;\n  function setName(string calldata) external;\n  function setWalletAddress(address, uint8, bytes32, bytes32) external;\n  function setAccount(string calldata, bytes calldata, address, uint8, bytes32, bytes32) external;\n\n  function getDataEncryptionKey(address) external view returns (bytes memory);\n  function getWalletAddress(address) external view returns (address);\n  function getMetadataURL(address) external view returns (string memory);\n  function batchGetMetadataURL(address[] calldata)\n    external\n    view\n    returns (uint256[] memory, bytes memory);\n  function getName(address) external view returns (string memory);\n\n  function authorizeVoteSigner(address, uint8, bytes32, bytes32) external;\n  function authorizeValidatorSigner(address, uint8, bytes32, bytes32) external;\n  function authorizeAttestationSigner(address, uint8, bytes32, bytes32) external;\n  function createAccount() external returns (bool);\n}"
    },
    {
      "filename": "packages/protocol/contracts/stability/interfaces/IStableToken.sol",
      "content": "pragma solidity ^0.5.3;\n\n/**\n * @title This interface describes the functions specific to Celo Stable Tokens, and in the\n * absence of interface inheritance is intended as a companion to IERC20.sol and ICeloToken.sol.\n */\ninterface IStableToken {\n  function mint(address, uint256) external returns (bool);\n  function burn(uint256) external returns (bool);\n  function setInflationParameters(uint256, uint256) external;\n  function valueToUnits(uint256) external view returns (uint256);\n  function unitsToValue(uint256) external view returns (uint256);\n  function getInflationParameters() external view returns (uint256, uint256, uint256, uint256);\n\n  // NOTE: duplicated with IERC20.sol, remove once interface inheritance is supported.\n  function balanceOf(address) external view returns (uint256);\n}"
    },
    {
      "filename": "packages/protocol/contracts/common/interfaces/IFreezer.sol",
      "content": "pragma solidity ^0.5.3;\n\ninterface IFreezer {\n  function initialize() external;\n  function isFrozen(address) external view returns (bool);\n}"
    },
    {
      "filename": "packages/protocol/contracts/governance/interfaces/IReleaseGold.sol",
      "content": "pragma solidity ^0.5.3;\n\ninterface IReleaseGold {\n  function isRevoked() external view returns (bool);\n  function withdraw(uint256) external;\n  function refundAndFinalize() external;\n  function revoke() external;\n  function lockGold(uint256) external;\n  function unlockGold(uint256) external;\n  function relockGold(uint256, uint256) external;\n  function withdrawLockedGold(uint256) external;\n  function authorizeVoteSigner(address, uint8, bytes32, bytes32) external;\n  function createAccount() external;\n  function setAccount(string calldata, bytes calldata, address, uint8, bytes32, bytes32) external;\n  function setAccountName(string calldata) external;\n  function setAccountWalletAddress(address, uint8, bytes32, bytes32) external;\n  function setAccountDataEncryptionKey(bytes calldata) external;\n  function setAccountMetadataURL(string calldata) external;\n  function revokeActive(address, uint256, address, address, uint256) external;\n  function revokePending(address, uint256, address, address, uint256) external;\n\n  function getTotalBalance() external view returns (uint256);\n  function getRemainingTotalBalance() external view returns (uint256);\n  function getRemainingUnlockedBalance() external view returns (uint256);\n  function getRemainingLockedBalance() external view returns (uint256);\n  function getCurrentReleasedTotalAmount() external view returns (uint256);\n}"
    }
  ]
}