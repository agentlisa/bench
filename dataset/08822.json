{
  "Title": "[G-15] Use a more recent version of solidity",
  "Content": "\nUse a solidity version of at least 0.8.2 to get simple compiler automatic inlining\nUse a solidity version of at least 0.8.3 to get better struct packing and cheaper multiple storage reads\nUse a solidity version of at least 0.8.4 to get custom errors, which are cheaper at deployment than `revert()/require()` strings\nUse a solidity version of at least 0.8.10 to have external calls skip contract existence checks if the external call has a return value\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/contracts/core/connext/facets/upgrade-initializers/DiamondInit.sol   #1\n\n2:    pragma solidity ^0.8.0;\n```\n\n<https://github.com/code-423n4/2022-06-connext/blob/4dd6149748b635f95460d4c3924c7e3fb6716967/contracts/contracts/core/connext/facets/upgrade-initializers/DiamondInit.sol#L2>\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/reports/2022-06-connext",
  "Code": [
    {
      "filename": "contracts/contracts/core/connext/facets/upgrade-initializers/DiamondInit.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/******************************************************************************\\\n* Author: Nick Mudge <nick@perfectabstractions.com> (https://twitter.com/mudgen)\n* EIP-2535 Diamonds: https://eips.ethereum.org/EIPS/eip-2535\n*\n* Implementation of a diamond.\n/******************************************************************************/\n\nimport {IDiamondLoupe} from \"../../interfaces/IDiamondLoupe.sol\";\nimport {IDiamondCut} from \"../../interfaces/IDiamondCut.sol\";\nimport {IERC165} from \"../../interfaces/IERC165.sol\";\nimport {IWrapped} from \"../../interfaces/IWrapped.sol\";\nimport {ITokenRegistry} from \"../../interfaces/ITokenRegistry.sol\";\n\nimport {Executor} from \"../../helpers/Executor.sol\";\n\nimport {LibDiamond} from \"../../libraries/LibDiamond.sol\";\n\nimport {BaseConnextFacet} from \"../BaseConnextFacet.sol\";\n\nimport {IProposedOwnable} from \"../../../shared/interfaces/IProposedOwnable.sol\";\nimport {RelayerFeeRouter} from \"../../../relayer-fee/RelayerFeeRouter.sol\";\nimport {PromiseRouter} from \"../../../promise/PromiseRouter.sol\";\n\nimport {XAppConnectionManager} from \"../../../../nomad-core/contracts/XAppConnectionManager.sol\";\n\n// It is expected that this contract is customized if you want to deploy your diamond\n// with data from a deployment script. Use the init function to initialize state variables\n// of your diamond. Add parameters to the init funciton if you need to.\n\ncontract DiamondInit is BaseConnextFacet {\n  // You can add parameters to this function in order to pass in\n  // data to set your own state variables\n  function init(\n    uint256 _domain,\n    address _xAppConnectionManager,\n    address _tokenRegistry, // Nomad token registry\n    address _wrappedNative,\n    address _relayerFeeRouter,\n    address payable _promiseRouter\n  ) external {\n    // adding ERC165 data\n    LibDiamond.DiamondStorage storage ds = LibDiamond.diamondStorage();\n    ds.supportedInterfaces[type(IERC165).interfaceId] = true;\n    ds.supportedInterfaces[type(IDiamondCut).interfaceId] = true;\n    ds.supportedInterfaces[type(IDiamondLoupe).interfaceId] = true;\n    ds.supportedInterfaces[type(IProposedOwnable).interfaceId] = true;\n\n    // add your own state variables\n    // EIP-2535 specifies that the `diamondCut` function takes two optional\n    // arguments: address _init and bytes calldata _calldata\n    // These arguments are used to execute an arbitrary function using delegatecall\n    // in order to set state variables in the diamond during deployment or an upgrade\n    // More info here: https://eips.ethereum.org/EIPS/eip-2535#diamond-interface\n\n    if (!s.initialized) {\n      s.initialized = true;\n      // __XAppConnectionClient_initialize\n      s.xAppConnectionManager = XAppConnectionManager(_xAppConnectionManager);\n\n      // __ProposedOwnable_init\n\n      // __ReentrancyGuard_init_unchained\n      s._status = _NOT_ENTERED;\n\n      // ConnextHandler\n      s.domain = _domain;\n      s.nonce = 0;\n      s.relayerFeeRouter = RelayerFeeRouter(_relayerFeeRouter);\n      s.promiseRouter = PromiseRouter(_promiseRouter);\n      s.executor = new Executor(address(this));\n      s.tokenRegistry = ITokenRegistry(_tokenRegistry);\n      s.wrapper = IWrapped(_wrappedNative);\n      s.LIQUIDITY_FEE_NUMERATOR = 9995;\n      s.LIQUIDITY_FEE_DENOMINATOR = 10000;\n      s.maxRoutersPerTransfer = 5;\n    }\n  }\n}"
    }
  ]
}