{
  "Title": "Fee Collectors can not be removed",
  "Content": "The `MooniswapFactoryGovernance` contract [has an `isFeeCollector` mapping](https://github.com/1inch-exchange/mooniswap-v2/blob/b9c06335fb1d68b19054442547fc677f42795b44/contracts/governance/MooniswapFactoryGovernance.sol#L38). Fee collectors can be added by the `owner`, but there is no way for the `owner` to remove fee collectors.\n\n\nConsider providing a way for te `owner` to remove fee collectors.\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/governance/MooniswapFactoryGovernance.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.6.0;\n\nimport \"@openzeppelin/contracts/access/Ownable.sol\";\nimport \"@openzeppelin/contracts/utils/Pausable.sol\";\nimport \"../interfaces/IMooniswapFactoryGovernance.sol\";\nimport \"../libraries/ExplicitLiquidVoting.sol\";\nimport \"../libraries/MooniswapConstants.sol\";\nimport \"../libraries/SafeCast.sol\";\nimport \"../utils/BalanceAccounting.sol\";\nimport \"./BaseGovernanceModule.sol\";\n\n\ncontract MooniswapFactoryGovernance is IMooniswapFactoryGovernance, BaseGovernanceModule, BalanceAccounting, Ownable, Pausable {\n    using Vote for Vote.Data;\n    using ExplicitLiquidVoting for ExplicitLiquidVoting.Data;\n    using VirtualVote for VirtualVote.Data;\n    using SafeMath for uint256;\n    using SafeCast for uint256;\n\n    event DefaultFeeVoteUpdate(address indexed user, uint256 fee, bool isDefault, uint256 amount);\n    event DefaultSlippageFeeVoteUpdate(address indexed user, uint256 slippageFee, bool isDefault, uint256 amount);\n    event DefaultDecayPeriodVoteUpdate(address indexed user, uint256 decayPeriod, bool isDefault, uint256 amount);\n    event ReferralShareVoteUpdate(address indexed user, uint256 referralShare, bool isDefault, uint256 amount);\n    event GovernanceShareVoteUpdate(address indexed user, uint256 governanceShare, bool isDefault, uint256 amount);\n    event GovernanceWalletUpdate(address governanceWallet);\n    event FeeCollectorUpdate(address feeCollector);\n\n    ExplicitLiquidVoting.Data private _defaultFee;\n    ExplicitLiquidVoting.Data private _defaultSlippageFee;\n    ExplicitLiquidVoting.Data private _defaultDecayPeriod;\n    ExplicitLiquidVoting.Data private _referralShare;\n    ExplicitLiquidVoting.Data private _governanceShare;\n    address public override governanceWallet;\n    address public override feeCollector;\n\n    mapping(address => bool) public override isFeeCollector;\n\n    constructor(address _mothership) public BaseGovernanceModule(_mothership) {\n        _defaultFee.data.result = MooniswapConstants._DEFAULT_FEE.toUint104();\n        _defaultSlippageFee.data.result = MooniswapConstants._DEFAULT_SLIPPAGE_FEE.toUint104();\n        _defaultDecayPeriod.data.result = MooniswapConstants._DEFAULT_DECAY_PERIOD.toUint104();\n        _referralShare.data.result = MooniswapConstants._DEFAULT_REFERRAL_SHARE.toUint104();\n        _governanceShare.data.result = MooniswapConstants._DEFAULT_GOVERNANCE_SHARE.toUint104();\n    }\n\n    function shutdown() external onlyOwner {\n        _pause();\n    }\n\n    function isActive() external view override returns (bool) {\n        return !paused();\n    }\n\n    function shareParameters() external view override returns(uint256, uint256, address, address) {\n        return (_referralShare.data.current(), _governanceShare.data.current(), governanceWallet, feeCollector);\n    }\n\n    function defaults() external view override returns(uint256, uint256, uint256) {\n        return (_defaultFee.data.current(), _defaultSlippageFee.data.current(), _defaultDecayPeriod.data.current());\n    }\n\n    function defaultFee() external view override returns(uint256) {\n        return _defaultFee.data.current();\n    }\n\n    function defaultFeeVotes(address user) external view returns(uint256) {\n        return _defaultFee.votes[user].get(MooniswapConstants._DEFAULT_FEE);\n    }\n\n    function virtualDefaultFee() external view returns(uint104, uint104, uint48) {\n        return (_defaultFee.data.oldResult, _defaultFee.data.result, _defaultFee.data.time);\n    }\n\n    function defaultSlippageFee() external view override returns(uint256) {\n        return _defaultSlippageFee.data.current();\n    }\n\n    function defaultSlippageFeeVotes(address user) external view returns(uint256) {\n        return _defaultSlippageFee.votes[user].get(MooniswapConstants._DEFAULT_SLIPPAGE_FEE);\n    }\n\n    function virtualDefaultSlippageFee() external view returns(uint104, uint104, uint48) {\n        return (_defaultSlippageFee.data.oldResult, _defaultSlippageFee.data.result, _defaultSlippageFee.data.time);\n    }\n\n    function defaultDecayPeriod() external view override returns(uint256) {\n        return _defaultDecayPeriod.data.current();\n    }\n\n    function defaultDecayPeriodVotes(address user) external view returns(uint256) {\n        return _defaultDecayPeriod.votes[user].get(MooniswapConstants._DEFAULT_DECAY_PERIOD);\n    }\n\n    function virtualDefaultDecayPeriod() external view returns(uint104, uint104, uint48) {\n        return (_defaultDecayPeriod.data.oldResult, _defaultDecayPeriod.data.result, _defaultDecayPeriod.data.time);\n    }\n\n    function referralShare() external view override returns(uint256) {\n        return _referralShare.data.current();\n    }\n\n    function referralShareVotes(address user) external view returns(uint256) {\n        return _referralShare.votes[user].get(MooniswapConstants._DEFAULT_REFERRAL_SHARE);\n    }\n\n    function virtualReferralShare() external view returns(uint104, uint104, uint48) {\n        return (_referralShare.data.oldResult, _referralShare.data.result, _referralShare.data.time);\n    }\n\n    function governanceShare() external view override returns(uint256) {\n        return _governanceShare.data.current();\n    }\n\n    function governanceShareVotes(address user) external view returns(uint256) {\n        return _governanceShare.votes[user].get(MooniswapConstants._DEFAULT_GOVERNANCE_SHARE);\n    }\n\n    function virtualGovernanceShare() external view returns(uint104, uint104, uint48) {\n        return (_governanceShare.data.oldResult, _governanceShare.data.result, _governanceShare.data.time);\n    }\n\n    function setGovernanceWallet(address newGovernanceWallet) external onlyOwner {\n        governanceWallet = newGovernanceWallet;\n        isFeeCollector[newGovernanceWallet] = true;\n        emit GovernanceWalletUpdate(newGovernanceWallet);\n    }\n\n    function setFeeCollector(address newFeeCollector) external onlyOwner {\n        feeCollector = newFeeCollector;\n        isFeeCollector[newFeeCollector] = true;\n        emit FeeCollectorUpdate(newFeeCollector);\n    }\n\n    function defaultFeeVote(uint256 vote) external {\n        require(vote <= MooniswapConstants._MAX_FEE, \"Fee vote is too high\");\n        _defaultFee.updateVote(msg.sender, _defaultFee.votes[msg.sender], Vote.init(vote), balanceOf(msg.sender), MooniswapConstants._DEFAULT_FEE, _emitDefaultFeeVoteUpdate);\n    }\n\n    function discardDefaultFeeVote() external {\n       _defaultFee.updateVote(msg.sender, _defaultFee.votes[msg.sender], Vote.init(), balanceOf(msg.sender), MooniswapConstants._DEFAULT_FEE, _emitDefaultFeeVoteUpdate);\n    }\n\n    function defaultSlippageFeeVote(uint256 vote) external {\n        require(vote <= MooniswapConstants._MAX_SLIPPAGE_FEE, \"Slippage fee vote is too high\");\n        _defaultSlippageFee.updateVote(msg.sender, _defaultSlippageFee.votes[msg.sender], Vote.init(vote), balanceOf(msg.sender), MooniswapConstants._DEFAULT_SLIPPAGE_FEE, _emitDefaultSlippageFeeVoteUpdate);\n    }\n\n   function discardDefaultSlippageFeeVote() external {\n        _defaultSlippageFee.updateVote(msg.sender, _defaultSlippageFee.votes[msg.sender], Vote.init(), balanceOf(msg.sender), MooniswapConstants._DEFAULT_SLIPPAGE_FEE, _emitDefaultSlippageFeeVoteUpdate);\n    }\n\n    function defaultDecayPeriodVote(uint256 vote) external {\n        require(vote <= MooniswapConstants._MAX_DECAY_PERIOD, \"Decay period vote is too high\");\n        require(vote >= MooniswapConstants._MIN_DECAY_PERIOD, \"Decay period vote is too low\");\n        _defaultDecayPeriod.updateVote(msg.sender, _defaultDecayPeriod.votes[msg.sender], Vote.init(vote), balanceOf(msg.sender), MooniswapConstants._DEFAULT_DECAY_PERIOD, _emitDefaultDecayPeriodVoteUpdate);\n    }\n\n    function discardDefaultDecayPeriodVote() external {\n        _defaultDecayPeriod.updateVote(msg.sender, _defaultDecayPeriod.votes[msg.sender], Vote.init(), balanceOf(msg.sender), MooniswapConstants._DEFAULT_DECAY_PERIOD, _emitDefaultDecayPeriodVoteUpdate);\n    }\n\n    function referralShareVote(uint256 vote) external {\n        require(vote <= MooniswapConstants._MAX_SHARE, \"Referral share vote is too high\");\n        require(vote >= MooniswapConstants._MIN_REFERRAL_SHARE, \"Referral share vote is too low\");\n        _referralShare.updateVote(msg.sender, _referralShare.votes[msg.sender], Vote.init(vote), balanceOf(msg.sender), MooniswapConstants._DEFAULT_REFERRAL_SHARE, _emitReferralShareVoteUpdate);\n    }\n\n    function discardReferralShareVote() external {\n        _referralShare.updateVote(msg.sender, _referralShare.votes[msg.sender], Vote.init(), balanceOf(msg.sender), MooniswapConstants._DEFAULT_REFERRAL_SHARE, _emitReferralShareVoteUpdate);\n    }\n\n    function governanceShareVote(uint256 vote) external {\n        require(vote <= MooniswapConstants._MAX_SHARE, \"Gov share vote is too high\");\n        _governanceShare.updateVote(msg.sender, _governanceShare.votes[msg.sender], Vote.init(vote), balanceOf(msg.sender), MooniswapConstants._DEFAULT_GOVERNANCE_SHARE, _emitGovernanceShareVoteUpdate);\n    }\n\n    function discardGovernanceShareVote() external {\n        _governanceShare.updateVote(msg.sender, _governanceShare.votes[msg.sender], Vote.init(), balanceOf(msg.sender), MooniswapConstants._DEFAULT_GOVERNANCE_SHARE, _emitGovernanceShareVoteUpdate);\n    }\n\n    function _notifyStakeChanged(address account, uint256 newBalance) internal override {\n        uint256 balance = _set(account, newBalance);\n        if (newBalance == balance) {\n            return;\n        }\n\n        _defaultFee.updateBalance(account, _defaultFee.votes[account], balance, newBalance, MooniswapConstants._DEFAULT_FEE, _emitDefaultFeeVoteUpdate);\n        _defaultSlippageFee.updateBalance(account, _defaultSlippageFee.votes[account], balance, newBalance, MooniswapConstants._DEFAULT_SLIPPAGE_FEE, _emitDefaultSlippageFeeVoteUpdate);\n        _defaultDecayPeriod.updateBalance(account, _defaultDecayPeriod.votes[account], balance, newBalance, MooniswapConstants._DEFAULT_DECAY_PERIOD, _emitDefaultDecayPeriodVoteUpdate);\n        _referralShare.updateBalance(account, _referralShare.votes[account], balance, newBalance, MooniswapConstants._DEFAULT_REFERRAL_SHARE, _emitReferralShareVoteUpdate);\n        _governanceShare.updateBalance(account, _governanceShare.votes[account], balance, newBalance, MooniswapConstants._DEFAULT_GOVERNANCE_SHARE, _emitGovernanceShareVoteUpdate);\n    }\n\n    function _emitDefaultFeeVoteUpdate(address user, uint256 newDefaultFee, bool isDefault, uint256 balance) private {\n        emit DefaultFeeVoteUpdate(user, newDefaultFee, isDefault, balance);\n    }\n\n    function _emitDefaultSlippageFeeVoteUpdate(address user, uint256 newDefaultSlippageFee, bool isDefault, uint256 balance) private {\n        emit DefaultSlippageFeeVoteUpdate(user, newDefaultSlippageFee, isDefault, balance);\n    }\n\n    function _emitDefaultDecayPeriodVoteUpdate(address user, uint256 newDefaultDecayPeriod, bool isDefault, uint256 balance) private {\n        emit DefaultDecayPeriodVoteUpdate(user, newDefaultDecayPeriod, isDefault, balance);\n    }\n\n    function _emitReferralShareVoteUpdate(address user, uint256 newReferralShare, bool isDefault, uint256 balance) private {\n        emit ReferralShareVoteUpdate(user, newReferralShare, isDefault, balance);\n    }\n\n    function _emitGovernanceShareVoteUpdate(address user, uint256 newGovernanceShare, bool isDefault, uint256 balance) private {\n        emit GovernanceShareVoteUpdate(user, newGovernanceShare, isDefault, balance);\n    }\n}"
    }
  ]
}