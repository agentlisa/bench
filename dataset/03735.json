{
  "Title": "[M01] Lack of event emission after sensitive action",
  "Content": "The [`_initialize` function](https://github.com/graphprotocol/contracts/blob/d51553b3d70c61108852f0ffe1ed249254c91e9a/contracts/governance/Governed.sol#L31) of the `Governed` contract does not emit the [`NewOwnership` event](https://github.com/graphprotocol/contracts/blob/d51553b3d70c61108852f0ffe1ed249254c91e9a/contracts/governance/Governed.sol#L18) after setting the value of the `governor` to be the `_initGovernor`.\n\n\nConsider emitting events after sensitive changes occur to facilitate tracking and notify off-chain clients following the contractsâ€™ activity.\n\n\n**Update:** *Fixed in [PR462](https://github.com/graphprotocol/contracts/pull/463) at commit [`1714b78d1243a824f36106539b34f8a79ebf14f3`](https://github.com/graphprotocol/contracts/pull/463/commits/1714b78d1243a824f36106539b34f8a79ebf14f3).*\n\n\n",
  "Impact": "MEDIUM",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/governance/Governed.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.7.3;\n\n/**\n * @title Graph Governance contract\n * @dev All contracts that will be owned by a Governor entity should extend this contract.\n */\ncontract Governed {\n    // -- State --\n\n    address public governor;\n    address public pendingGovernor;\n\n    // -- Events --\n\n    event NewPendingOwnership(address indexed from, address indexed to);\n    event NewOwnership(address indexed from, address indexed to);\n\n    /**\n     * @dev Check if the caller is the governor.\n     */\n    modifier onlyGovernor {\n        require(msg.sender == governor, \"Only Governor can call\");\n        _;\n    }\n\n    /**\n     * @dev Initialize the governor to the contract caller.\n     */\n    function _initialize(address _initGovernor) internal {\n        governor = _initGovernor;\n    }\n\n    /**\n     * @dev Admin function to begin change of governor. The `_newGovernor` must call\n     * `acceptOwnership` to finalize the transfer.\n     * @param _newGovernor Address of new `governor`\n     */\n    function transferOwnership(address _newGovernor) external onlyGovernor {\n        require(_newGovernor != address(0), \"Governor must be set\");\n\n        address oldPendingGovernor = pendingGovernor;\n        pendingGovernor = _newGovernor;\n\n        emit NewPendingOwnership(oldPendingGovernor, pendingGovernor);\n    }\n\n    /**\n     * @dev Admin function for pending governor to accept role and update governor.\n     * This function must called by the pending governor.\n     */\n    function acceptOwnership() external {\n        require(\n            pendingGovernor != address(0) && msg.sender == pendingGovernor,\n            \"Caller must be pending governor\"\n        );\n\n        address oldGovernor = governor;\n        address oldPendingGovernor = pendingGovernor;\n\n        governor = pendingGovernor;\n        pendingGovernor = address(0);\n\n        emit NewOwnership(oldGovernor, governor);\n        emit NewPendingOwnership(oldPendingGovernor, pendingGovernor);\n    }\n}"
    }
  ]
}