{
  "Title": "Incomplete Module Access Control",
  "Content": "The `ModuleInstallationSystem` allows anyone to install any module. Since this [makes an external call](https://github.com/latticexyz/mud/blob/12a9eb1afb18a7f7cb43d774cabb2d5af7c74e6b/packages/world/src/modules/core/implementations/ModuleInstallationSystem.sol#L28) to the module, it does not provide any additional functionality. Instead, it is simply a convenient way to execute several related operations atomically. However, it can [overwrite any record](https://github.com/latticexyz/mud/blob/12a9eb1afb18a7f7cb43d774cabb2d5af7c74e6b/packages/world/src/modules/core/implementations/ModuleInstallationSystem.sol#L36) in the `InstalledModules` table, which doesn't have any subsequent effects in the current codebase.\n\n\nConsider whether the `InstalledModules` table should use the module address (along with the arguments hash) instead of the module name as the record key. This is so that it identifies the action that was taken more directly and is more resistant to being overwritten. Alternatively, consider whether the `InstalledModules` table should be removed entirely.\n\n\n***Update:** Resolved in [pull request #2168](https://github.com/latticexyz/mud/pull/2168).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "packages/world/src/modules/core/implementations/ModuleInstallationSystem.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity >=0.8.21;\n\nimport { IModule, MODULE_INTERFACE_ID } from \"../../../IModule.sol\";\nimport { System } from \"../../../System.sol\";\nimport { AccessControl } from \"../../../AccessControl.sol\";\nimport { WorldContextProviderLib } from \"../../../WorldContext.sol\";\nimport { ResourceAccess } from \"../../../codegen/tables/ResourceAccess.sol\";\nimport { InstalledModules } from \"../../../codegen/tables/InstalledModules.sol\";\nimport { requireInterface } from \"../../../requireInterface.sol\";\n\n/**\n * @title Module Installation System\n * @dev A system contract to handle the installation of (non-root) modules in the World.\n */\ncontract ModuleInstallationSystem is System {\n  /**\n   * @notice Installs a module into the World under a specified namespace.\n   * @dev Validates the given module against the IModule interface and delegates the installation process.\n   * The module is then registered in the InstalledModules table.\n   * @param module The module to be installed.\n   * @param args Arguments for the module installation.\n   */\n  function installModule(IModule module, bytes memory args) public {\n    // Require the provided address to implement the IModule interface\n    requireInterface(address(module), MODULE_INTERFACE_ID);\n\n    WorldContextProviderLib.callWithContextOrRevert({\n      msgSender: _msgSender(),\n      msgValue: 0,\n      target: address(module),\n      callData: abi.encodeCall(IModule.install, (args))\n    });\n\n    // Register the module in the InstalledModules table\n    InstalledModules._set(module.getName(), keccak256(args), address(module));\n  }\n}"
    }
  ]
}