{
  "Title": "[H-03] Adversary can block `claimAuction()` due to push-strategy to transfer assets to multiple bidders",
  "Content": "\n`claimAuction()` implements a push-strategy instead of a pull-strategy for returning the bidders funds.\n\nThis gives the opportunity for an adversary to DOS the function, locking all funds from other participants.\n\nThis finding differs from the automated findings report [M-01](https://github.com/code-423n4/2023-10-nextgen/blob/main/bot-report.md#m-01-unchecked-return-value-of-low-level-calldelegatecall), and [L-18](https://github.com/code-423n4/2023-10-nextgen/blob/main/bot-report.md#l-18-gas-griefingtheft-is-possible-on-an-unsafe-external-call), as it has a different root cause, can't be prevented with any of the mitigations from the bot, and also highlights the actual High impact of the issue.\n\n### Impact\n\n- Prevents other bidders from receiving their bids back.\n- Prevents the token owner from receiving earnings.\n- Prevents the bidder winner from receiving the NFT.\n\nAll Ether from the auction can be lost as there is no alternate way of recovering it.\n\nThis also breaks one of the [main invariants of the protocol](https://github.com/code-423n4/2023-10-nextgen#main-invariants):\n\n> Properties that should NEVER be broken under any circumstance:\n>\n> -   **The highest bidder will receive the token after an auction finishes**, **the owner of the token will receive the funds** and **all other participants will get refunded**.\n\n### Proof of Concept\n\nAn adversary can create bids for as little as 1 wei, as there is no minimum limitation: [AuctionDemo.sol#L58](https://github.com/code-423n4/2023-10-nextgen/blob/main/smart-contracts/AuctionDemo.sol#L58). With that, it can participate in as many auctions as they want to grief all auctions.\n\nAll non-winning bidders that didn't cancel their bid before the auction ended will receive their bids back during `claimAuction()`:\n\n```solidity\n    function claimAuction(uint256 _tokenid) public WinnerOrAdminRequired(_tokenid,this.claimAuction.selector){\n        /// ...\n->      for (uint256 i=0; i< auctionInfoData[_tokenid].length; i ++) {\n            if (auctionInfoData[_tokenid][i].bidder == highestBidder && auctionInfoData[_tokenid][i].bid == highestBid && auctionInfoData[_tokenid][i].status == true) {\n                IERC721(gencore).safeTransferFrom(ownerOfToken, highestBidder, _tokenid);\n                (bool success, ) = payable(owner()).call{value: highestBid}(\"\");\n                emit ClaimAuction(owner(), _tokenid, success, highestBid);\n            } else if (auctionInfoData[_tokenid][i].status == true) {\n->              (bool success, ) = payable(auctionInfoData[_tokenid][i].bidder).call{value: auctionInfoData[_tokenid][i].bid}(\"\");\n                emit Refund(auctionInfoData[_tokenid][i].bidder, _tokenid, success, highestBid);\n            } else {}\n        }\n    }\n```\n\n[AuctionDemo.sol#L116](https://github.com/code-423n4/2023-10-nextgen/blob/main/smart-contracts/AuctionDemo.sol#L116)\n\nThe contracts call the bidders with some `value`. If the receiver is a contract, it can execute arbitrary code. A malicious bidder can exploit this to make the `claimAuction()` always revert, and so no funds to other participants be paid back.\n\nWith the current implementation, a gas bomb can be implemented to perform the attack. [L-18](https://github.com/code-423n4/2023-10-nextgen/blob/main/bot-report.md#l-18-gas-griefingtheft-is-possible-on-an-unsafe-external-call) \n from the automated findings report suggests the use of `excessivelySafeCall()` to prevent it, but it limits the functionality of legit contract receivers, and eventually preventing them from receiving the funds. In addition, the finding doesn't showcase the High severity of the issue and may be neglected.\n\n[M-01](https://github.com/code-423n4/2023-10-nextgen/blob/main/bot-report.md#m-01-unchecked-return-value-of-low-level-calldelegatecall) from the automated findings report points out the lack of a check of the `success` of the calls. If the function reverts when the call was not successful, the adversary can make a callback on its contract `receive()` function to always revert to perform this same attack. In addition, this finding also doesn't showcase the High severity of the issue.\n\nUltimately the way to prevent this attack is to separate the transfer of each individual bidder to a separate function.\n\n### Recommended Mitigation Steps\n\nCreate a separate function for each bidder to claim their funds back (such as the cancel bids functions are implemented).\n\n### Assessed type\n\nETH-Transfer\n\n**[a2rocket (NextGen) acknowledged and commented via duplicate issue #1703](https://github.com/code-423n4/2023-10-nextgen-findings/issues/1703#issuecomment-1825374235):**\n> There are several ways to do this; we will introduce an additional `claimingFunction`.\n\n**[0xsomeone (judge) commented](https://github.com/code-423n4/2023-10-nextgen-findings/issues/734#issuecomment-1839381558):**\n > The Warden specifies a way in which an auction can be sabotaged entirely in its claim operation by gas griefing.\n> \n> While the finding has been identified as [L-18](https://github.com/code-423n4/2023-10-nextgen/blob/main/bot-report.md#l-18-gas-griefingtheft-is-possible-on-an-unsafe-external-call) in the automated findings report, it may indeed be neglected and inadequately encompasses the severity of this flaw. \n> \n> As the Warden clearly illustrates, all funds in the auction will be permanently lost and in an easily accessible fashion by simply either consuming all gas in meaningless operations or gas-bombing via an arbitrarily large payload being returned.\n> \n> This particular submission was selected as best-for-report due to its acknowledgment of automated findings issues, precisely & correctly specifying the impact of the exhibit, and providing a PoC that demonstrates the problem.\n> \n> The C4 Supreme Court verdict [did not finalize on issues based entirely on automated findings](https://docs.google.com/document/d/1Y2wJVt0d2URv8Pptmo7JqNd0DuPk_qF9EPJAj3iSQiE/edit#heading=h.vljs3xbfn8cj) and as such, I will deem this exhibit a valid high submission given its accessibility and 2-tier upgrade from the automated findings report (`L` to `H`).\n\n***\n\n",
  "Impact": "HIGH",
  "Source": "https://code4rena.com/reports/2023-10-nextgen",
  "Code": [
    {
      "filename": "bot-report.md",
      "content": "```bash\n# # # # # # # # # # # # # # # # # # # # # #\n#                                         #\n#             |\\_/|                       #\n#             | O O                       #\n#             |   <>              _       #\n#             |  _/\\------____ ((| |))    #\n#             |               `--' |      #\n#         ____|_       ___|   |___.'      #\n#        /_/_____/____/_______|           #\n#    _   _                           _    #\n#   | | | |                         | |   #\n#   | |_| |  ___   _   _  _ __    __| |   #\n#   |  _  | / _ \\ | | | || '_ \\  / _` |   #\n#   | | | || (_) || |_| || | | || (_| |   #\n#   \\_| |_/ \\___/  \\__,_||_| |_| \\__,_|   #\n#                                         #\n# # # # # # # # # # # # # # # # # # # # # #\n```\n\n\n## Summary\n\n---\n\n### High Risk Issues\n|Id|Title|Instances|\n|:--:|:------|:--:|\n|[[H-01]](#h-01-permanent-dos-due-to-non-shrinking-array-usage-in-an-unbounded-loop)| Permanent DoS due to non-shrinking array usage in an unbounded loop | 4 |\n\nTotal: 4 instances over 1 issues.\n\n### Medium Risk Issues\n|Id|Title|Instances|\n|:--:|:------|:--:|\n|[[M-01]](#m-01-unchecked-return-value-of-low-level-calldelegatecall)| Unchecked return value of low-level `call()/delegatecall()` | 11 |\n|[[M-02]](#m-02-user-funds-sent-in-excess-are-not-refunded)| User funds sent in excess are not refunded | 3 |\n|[[M-03]](#m-03-centralization-issue-caused-by-admin-privileges)| Centralization issue caused by admin privileges | 1 |\n\nTotal: 15 instances over 3 issues.\n\n### Low Risk Issues\n|Id|Title|Instances|\n|:--:|:------|:--:|\n|[[L-01]](#l-01-execution-at-deadlines-should-be-allowed)| Execution at deadlines should be allowed | 3 |\n|[[L-02]](#l-02-missing-checks-in-constructorinitialize)| Missing checks in constructor/initialize | 3 |\n|[[L-03]](#l-03-missing-checks-for-state-variable-assignments)| Missing checks for state variable assignments | 31 |\n|[[L-04]](#l-04-payable-function-does-not-transfer-eth)| `payable` function does not transfer ETH | 1 |\n|[[L-05]](#l-05-functions-calling-contracts-with-transfer-hooks-are-missing-reentrancy-guards)| Functions calling contracts with transfer hooks are missing reentrancy guards | 1 |\n|[[L-06]](#l-06-nft-ownership-doesnt-support-hard-forks)| NFT ownership doesn't support hard forks | 1 |\n|[[L-07]](#l-07-missing-disallowlist-for-erc721)| Missing disallowlist for `ERC721` | 1 |\n|[[L-08]](#l-08-array-lengths-not-checked)| Array lengths not checked | 2 |\n|[[L-09]](#l-09-avoid-shadowing-state-variables)| Avoid shadowing state variables | 1 |\n|[[L-10]](#l-10-subtraction-may-underflow-if-multiplication-is-too-large)| Subtraction may underflow if multiplication is too large | 2 |\n|[[L-11]](#l-11-code-does-not-follow-the-best-practice-of-check-effects-interaction)| Code does not follow the best practice of check-effects-interaction | 22 |\n|[[L-12]](#l-12-missing-limits-when-setting-minmax-amounts)| Missing limits when setting min/max amounts | 12 |\n|[[L-13]](#l-13-owner-can-renounce-ownership)| Owner can renounce ownership | 6 |\n|[[L-14]](#l-14-external-calls-in-an-unbounded-loop-can-result-in-a-dos)| External calls in an unbounded loop can result in a DoS | 3 |\n|[[L-15]](#l-15-use-of-ownership-with-a-single-step-rather-than-double)| Use of ownership with a single step rather than double | 7 |\n|[[L-16]](#l-16-use-of-abiencodepacked-with-dynamic-types-inside-keccak256)| Use of `abi.encodePacked` with dynamic types inside `keccak256` | 1 |\n|[[L-17]](#l-17-loss-of-precision-on-division)| Loss of precision on division | 8 |\n|[[L-18]](#l-18-gas-griefingtheft-is-possible-on-an-unsafe-external-call)| Gas griefing/theft is possible on an unsafe external call | 8 |\n|[[L-19]](#l-19-arrays-can-grow-in-size-without-a-way-to-shrink-them)| Arrays can grow in size without a way to shrink them | 1 |\n|[[L-20]](#l-20-onlyowner-functions-not-accessible-if-owner-renounces-ownership)| `onlyOwner` functions not accessible if `owner` renounces ownership | 1 |\n|[[L-21]](#l-21-no-access-control-on-receivepayable-fallback)| No access control on `receive/payable fallback` | 1 |\n|[[L-22]](#l-22-unusedempty-receivefallback)| Unused/empty `receive`/`fallback` | 1 |\n|[[L-23]](#l-23-missing-checks-for-address0-in-constructorinitializers)| Missing checks for `address(0)` in constructor/initializers | 16 |\n|[[L-24]](#l-24-missing-checks-for-address0-when-updating-state-variables)| Missing checks for `address(0)` when updating state variables | 17 |\n|[[L-25]](#l-25-consider-using-erc721a-instead-of-erc721)| Consider using `ERC721A` instead of `ERC721` | 1 |\n\nTotal: 151 instances over 25 issues.\n\n### Non Critical Issues\n|Id|Title|Instances|\n|:--:|:------|:--:|\n|[[N-01]](#n-01-custom-error-should-be-used-rather-than-requireassert)| Custom `error` should be used rather than `require`/`assert` | 84 |\n|[[N-02]](#n-02-high-cyclomatic-complexity)| High cyclomatic complexity | 1 |\n|[[N-03]](#n-03-missing-events-in-sensitive-functions)| Missing events in sensitive functions | 23 |\n|[[N-04]](#n-04-missing-events-in-initializers)| Missing events in initializers | 2 |\n|[[N-05]](#n-05-setters-should-prevent-re-setting-the-same-value)| Setters should prevent re-setting the same value | 19 |\n|[[N-06]](#n-06-usage-of-intuint-is-discouraged)| Usage of `int/uint` is discouraged | 25 |\n|[[N-07]](#n-07-named-imports-of-parent-contracts-are-missing)| Named imports of parent contracts are missing | 6 |\n|[[N-08]](#n-08-unused-arguments-should-be-removed-or-implemented)| Unused arguments should be removed or implemented | 3 |\n|[[N-09]](#n-09-ownable-is-not-used-anywhere)| `Ownable` is not used anywhere | 6 |\n|[[N-10]](#n-10-contracts-with-only-utility-functions-should-be-libraries)| Contracts with only utility functions should be libraries | 1 |\n|[[N-11]](#n-11-hardcoded-address-should-be-avoided)| Hardcoded `address` should be avoided | 5 |\n|[[N-12]](#n-12-enum-values-should-be-used-in-place-of-constant-array-indexes)| Enum values should be used in place of constant array indexes | 11 |\n|[[N-13]](#n-13-variable-initialization-with-zero-value)| Variable initialization with zero value | 11 |\n|[[N-14]](#n-14-consider-adding-emergency-stop-functionality)| Consider adding emergency-stop functionality | 6 |\n|[[N-15]](#n-15-duplicated-requireif-statements-should-be-refactored)| Duplicated `require/if` statements should be refactored | 11 |\n|[[N-16]](#n-16-some-functions-contain-the-same-exact-logic)| Some functions contain the same exact logic | 14 |\n|[[N-17]](#n-17-unbounded-loop-may-run-out-of-gas)| Unbounded loop may run out of gas | 6 |\n|[[N-18]](#n-18-public-functions-not-called-internally)| Public functions not called internally | 75 |\n|[[N-19]](#n-19-large-multiples-of-ten-should-use-scientific-notation)| Large multiples of ten should use scientific notation | 4 |\n|[[N-20]](#n-20-missingmalformed-underscores-for-large-numeric-literals)| Missing/malformed underscores for large numeric literals | 5 |\n|[[N-21]](#n-21-mixed-usage-of-intuint-with-int256uint256)| Mixed usage of `int`/`uint` with `int256`/`uint256` | 25 |\n|[[N-22]](#n-22-missing-timelock-in-critical-functions)| Missing timelock in critical functions | 34 |\n|[[N-23]](#n-23-use-transfer-libraries-instead-of-low-level-calls)| Use transfer libraries instead of low level calls | 11 |\n|[[N-24]](#n-24-use-of-non-named-numeric-constants)| Use of non-named numeric constants | 30 |\n|[[N-25]](#n-25-complex-math-should-be-split-into-multiple-steps)| Complex math should be split into multiple steps | 5 |\n|[[N-26]](#n-26-control-structures-do-not-comply-with-best-practices)| Control structures do not comply with best practices | 3 |\n|[[N-27]](#n-27-use-of-floating-pragma)| Use of floating pragma | 8 |\n|[[N-28]](#n-28-no-checks-for-empty-bytes)| No checks for empty bytes | 3 |\n|[[N-29]](#n-29-use-of-abiencodepacked-instead-of-bytesconcatstringconcat)| Use of `abi.encodePacked` instead of `bytes.concat`/`string.concat` | 4 |\n|[[N-30]](#n-30-contract-functions-should-use-an-interface)| Contract functions should use an `interface` | 102 |\n|[[N-31]](#n-31-requirerevert-without-any-message)| `require`/`revert` without any message | 10 |\n|[[N-32]](#n-32-else-block-is-not-required)| `else` block is not required | 6 |\n|[[N-33]](#n-33-multiple-addressid-mappings-can-be-combined-into-a-single-mapping-of-an-addressid-to-a-struct-for-readability)| Multiple `address`/ID mappings can be combined into a single mapping of an `address`/ID to a `struct`, for readability | 12 |\n|[[N-34]](#n-34-lack-of-specific-import-identifier)| Lack of specific `import` identifier | 32 |\n|[[N-35]](#n-35-imports-should-be-organized-more-systematically)| Imports should be organized more systematically | 4 |\n|[[N-36]](#n-36-event-is-missing-msgsender-parameter)| Event is missing `msg.sender` parameter | 7 |\n|[[N-37]](#n-37-top-level-declarations-should-be-separated-by-at-least-two-lines)| Top-level declarations should be separated by at least two lines | 10 |\n|[[N-38]](#n-38-use-a-struct-to-encapsulate-multiple-function-parameters)| Use a struct to encapsulate multiple function parameters | 18 |\n|[[N-39]](#n-39-returning-a-struct-instead-of-returning-many-variables-is-better)| Returning a struct instead of returning many variables is better | 6 |\n|[[N-40]](#n-40-events-may-be-emitted-out-of-order-due-to-reentrancy)| Events may be emitted out of order due to reentrancy | 3 |\n|[[N-41]](#n-41-use-a-modifier-instead-of-require-to-check-for-msgsender)| Use a `modifier` instead of `require` to check for `msg.sender` | 13 |\n|[[N-42]](#n-42-dont-use-uppercase-for-non-constantimmutable-variables)| Don't use uppercase for non `constant`/`immutable` variables | 1 |\n|[[N-43]](#n-43-constants-in-comparisons-should-appear-on-the-left-side)| Constants in comparisons should appear on the left side | 19 |\n|[[N-44]](#n-44-consider-using-delete-instead-of-assigning-zerofalse-to-clear-values)| Consider using `delete` instead of assigning zero/false to clear values | 6 |\n|[[N-45]](#n-45-use-a-ternary-statement-instead-of-ifelse-when-appropriate)| Use a ternary statement instead of `if`/`else` when appropriate | 1 |\n|[[N-46]](#n-46-consider-using-named-mappings)| Consider using named mappings | 48 |\n|[[N-47]](#n-47-layout-order-does-not-comply-with-best-practices)| Layout order does not comply with best practices | 7 |\n|[[N-48]](#n-48-mapping-definitions-do-not-comply-with-best-practices)| `mapping` definitions do not comply with best practices | 40 |\n|[[N-49]](#n-49-function-visibility-order-does-not-comply-with-best-practices)| Function visibility order does not comply with best practices | 56 |\n|[[N-50]](#n-50-long-functions-should-be-refactored-into-multiple-functions)| Long functions should be refactored into multiple functions | 1 |\n|[[N-51]](#n-51-strings-should-use-double-quotes-rather-than-single-quotes)| Strings should use double quotes rather than single quotes | 4 |\n|[[N-52]](#n-52-lines-are-too-long)| Lines are too long | 117 |\n|[[N-53]](#n-53-some-variables-have-a-implicit-default-visibility)| Some variables have a implicit default visibility | 6 |\n|[[N-54]](#n-54-consider-adding-a-blockdeny-list)| Consider adding a block/deny-list | 6 |\n|[[N-55]](#n-55-use-of-override-is-unnecessary)| Use of `override` is unnecessary | 3 |\n|[[N-56]](#n-56-typos-in-comments)| Typos in comments | 3 |\n|[[N-57]](#n-57-contracts-should-have-full-test-coverage)| Contracts should have full test coverage | - |\n|[[N-58]](#n-58-large-or-complicated-code-bases-should-implement-invariant-tests)| Large or complicated code bases should implement invariant tests | - |\n|[[N-59]](#n-59-codebase-should-implement-formal-verification-testing)| Codebase should implement formal verification testing | - |\n|[[N-60]](#n-60-inconsistent-spacing-in-comments)| Inconsistent spacing in comments | 2 |\n|[[N-61]](#n-61-state-variables-should-include-comments)| State variables should include comments | 30 |\n|[[N-62]](#n-62-use-inheritdoc-for-overridden-functions)| Use `@inheritdoc` for overridden functions | 4 |\n|[[N-63]](#n-63-some-contract-names-dont-follow-the-solidity-naming-conventions)| Some contract names don't follow the Solidity naming conventions | 2 |\n|[[N-64]](#n-64-struct-names-dont-follow-the-solidity-naming-convention)| Struct names don't follow the Solidity naming convention | 8 |\n|[[N-65]](#n-65-modifier-names-dont-follow-the-solidity-naming-convention)| Modifier names don't follow the Solidity naming convention | 10 |\n|[[N-66]](#n-66-variable-names-dont-follow-the-solidity-naming-convention)| Variable names don't follow the Solidity naming convention | 15 |\n|[[N-67]](#n-67-enum-names-dont-follow-the-solidity-naming-convention)| Enum names don't follow the Solidity naming convention | 8 |\n|[[N-68]](#n-68-missing-underscore-prefix-for-non-external-functions)| Missing underscore prefix for non-external functions | 4 |\n|[[N-69]](#n-69-missing-underscore-prefix-for-non-external-variables)| Missing underscore prefix for non-external variables | 28 |\n|[[N-70]](#n-70-missing-natspec-from-contract-declarations)| Missing NatSpec from contract declarations | 8 |\n|[[N-71]](#n-71-missing-natspec-author-from-contract-declaration)| Missing NatSpec `@author` from contract declaration | 8 |\n|[[N-72]](#n-72-missing-natspec-dev-from-contract-declaration)| Missing NatSpec `@dev` from contract declaration | 8 |\n|[[N-73]](#n-73-missing-natspec-notice-from-contract-declaration)| Missing NatSpec `@notice` from contract declaration | 8 |\n|[[N-74]](#n-74-missing-natspec-title-from-contract-declaration)| Missing NatSpec `@title` from contract declaration | 8 |\n|[[N-75]](#n-75-missing-natspec-from-event-declaration)| Missing NatSpec from event declaration | 8 |\n|[[N-76]](#n-76-missing-natspec-dev-from-event-declaration)| Missing NatSpec `@dev` from event declaration | 8 |\n|[[N-77]](#n-77-missing-natspec-notice-from-event-declaration)| Missing NatSpec `@notice` from event declaration | 8 |\n|[[N-78]](#n-78-missing-natspec-param-from-event-declaration)| Missing NatSpec `@param` from event declaration | 8 |\n|[[N-79]](#n-79-missing-natspec-from-modifiers-definitions)| Missing NatSpec from modifiers definitions | 10 |\n|[[N-80]](#n-80-missing-natspec-dev-from-modifier-declaration)| Missing NatSpec `@dev` from modifier declaration | 10 |\n|[[N-81]](#n-81-missing-natspec-notice-from-modifier-declaration)| Missing NatSpec `@notice` from modifier declaration | 10 |\n|[[N-82]](#n-82-missing-natspec-param-from-modifier-declaration)| Missing NatSpec `@param` from modifier declaration | 9 |\n|[[N-83]](#n-83-missing-natspec-from-function-definitions)| Missing NatSpec from function definitions | 110 |\n|[[N-84]](#n-84-missing-natspec-dev-from-function-declaration)| Missing NatSpec `@dev` from function declaration | 110 |\n|[[N-85]](#n-85-missing-natspec-notice-from-function-declaration)| Missing NatSpec `@notice` from function declaration | 110 |\n|[[N-86]](#n-86-missing-natspec-param-from-function-declaration)| Missing NatSpec `@param` from function declaration | 110 |\n|[[N-87]](#n-87-incomplete-natspec-return-from-function-declaration)| Incomplete NatSpec `@return` from function declaration | 46 |\n\nTotal: 1690 instances over 87 issues.\n\n### Gas Optimizations\n|Id|Title|Instances|Gas Saved|\n|:--:|:------|:--:|---:|\n|[[G-01]](#g-01-state-variables-can-be-packed-into-fewer-storage-slots)| State variables can be packed into fewer storage slots | 1 | 20,000 |\n|[[G-02]](#g-02-structs-can-be-packed-into-fewer-storage-slots)| Structs can be packed into fewer storage slots | 3 | 60,000 |\n|[[G-03]](#g-03-structs-can-be-modified-to-fit-in-fewer-storage-slots)| Structs can be modified to fit in fewer storage slots | 1 | 20,000 |\n|[[G-04]](#g-04-multiple-mappings-that-share-an-id-can-be-combined-into-a-single-mapping-of-id--struct)| Multiple `mapping`s that share an ID can be combined into a single `mapping` of ID / `struct` | 12 | 391,340 |\n|[[G-05]](#g-05-state-variables-access-within-a-loop)| State variables access within a loop | 9 | 2,385 |\n|[[G-06]](#g-06-state-variables-only-set-in-the-constructor-should-be-declared-immutable)| State variables only set in the constructor should be declared `immutable` | 5 | 100,000 |\n|[[G-07]](#g-07-cache-state-variables-with-stack-variables)| Cache state variables with stack variables | 9 | 6,100 |\n|[[G-08]](#g-08-low-level-call-can-be-optimized-with-assembly)| Low level `call` can be optimized with assembly | 11 | 2,728 |\n|[[G-09]](#g-09-use-of-memory-instead-of-calldata-for-immutable-arguments)| Use of `memory` instead of `calldata` for immutable arguments | 13 | 8,384 |\n|[[G-10]](#g-10-avoid-updating-storage-when-the-value-hasnt-changed)| Avoid updating storage when the value hasn't changed | 19 | 13,300 |\n|[[G-11]](#g-11-use-of-emit-inside-a-loop)| Use of `emit` inside a loop | 3 | 3,078 |\n|[[G-12]](#g-12-shortcircuit-rules-can-be-be-used-to-optimize-some-gas-usage)| Shortcircuit rules can be be used to optimize some gas usage | 2 | 4,200 |\n|[[G-13]](#g-13-cache-multiple-accesses-of-a-mappingarray)| Cache multiple accesses of a mapping/array | 46 | 8,400 |\n|[[G-14]](#g-14-redundant-state-variable-getters)| Redundant state variable getters | 2 | - |\n|[[G-15]](#g-15-using-bool-for-storage-incurs-overhead)| Using `bool` for storage incurs overhead | 13 | 222,300 |\n|[[G-16]](#g-16-custom-errors-cost-less-than-requireassert)| Custom `error`s cost less than `require`/`assert` | 84 | 2,436 |\n|[[G-17]](#g-17-consider-activating-via-ir-for-deploying)| Consider activating `via-ir` for deploying | - | - |\n|[[G-18]](#g-18-function-calls-should-be-cached-instead-of-re-calling-the-function)| Function calls should be cached instead of re-calling the function | 11 | - |\n|[[G-19]](#g-19-functions-that-revert-when-called-by-normal-users-can-be-payable)| Functions that revert when called by normal users can be `payable` | 43 | 903 |\n|[[G-20]](#g-20-array-length-is-not-cached)| Array `length` is not cached | 8 | 24 |\n|[[G-21]](#g-21-caching-global-variables-is-more-expensive-than-using-the-actual-variable)| Caching global variables is more expensive than using the actual variable | 1 | 12 |\n|[[G-22]](#g-22-add-unchecked-blocks-for-subtractions-where-the-operands-cannot-underflow)| Add `unchecked` blocks for subtractions where the operands cannot underflow | 1 | 85 |\n|[[G-23]](#g-23-add-unchecked-blocks-for-divisions-where-the-operands-cannot-overflow)| Add `unchecked` blocks for divisions where the operands cannot overflow | 13 | 2,067 |\n|[[G-24]](#g-24-empty-blocks-should-be-removed-or-emit-something)| Empty blocks should be removed or emit something | 1 | 4,006 |\n|[[G-25]](#g-25-usage-of-uintsints-smaller-than-32-bytes-256-bits-incurs-overhead)| Usage of `uints`/`ints` smaller than 32 bytes (256 bits) incurs overhead | 13 | 78 |\n|[[G-26]](#g-26-stack-variable-cost-less-while-used-in-emiting-event)| Stack variable cost less while used in emiting event | 6 | 54 |\n|[[G-27]](#g-27-using-pre-instead-of-post-incrementsdecrements)| Using pre instead of post increments/decrements | 10 | 10 |\n|[[G-28]](#g-28-avoid-using-msgsender-if-not-supporting-eip-2771)| Avoid using `_msgSender` if not supporting `EIP-2771` | 2 | 32 |\n|[[G-29]](#g-29--costs-less-gas-than)| `>=`/`<=` costs less gas than `>`/`<` | 24 | 72 |\n|[[G-30]](#g-30-internalprivate-functions-only-called-once-can-be-inlined-to-save-gas)| `internal/private` functions only called once can be inlined to save gas | 1 | 20 |\n|[[G-31]](#g-31-boolean-comparison-with-boolean-literals-is-unnecessary)| Boolean comparison with boolean literals is unnecessary | 69 | 621 |\n|[[G-32]](#g-32-function-names-can-be-optimized)| Function names can be optimized | 8 | 176 |\n|[[G-33]](#g-33-using-delete-instead-of-setting-mappingstruct-to-0-saves-gas)| Using `delete` instead of setting mapping/struct to 0 saves gas | 2 | 10 |\n|[[G-34]](#g-34-use-of--is-cheaper-for-mappings)| Use of `+=` is cheaper for mappings | 8 | 320 |\n|[[G-35]](#g-35-constructors-can-be-marked-payable)| Constructors can be marked `payable` | 7 | 147 |\n|[[G-36]](#g-36-long-revert-strings)| Long revert strings | 7 | 126 |\n|[[G-37]](#g-37-splitting-require-statements-that-use--saves-gas)| Splitting `require` statements that use `&&` saves gas | 12 | 36 |\n|[[G-38]](#g-38-nesting-if-statements-that-use--saves-gas)| Nesting `if` statements that use `&&` saves gas | 11 | 330 |\n|[[G-39]](#g-39-lack-of-unchecked-in-loops)| Lack of `unchecked` in loops | 10 | 600 |\n|[[G-40]](#g-40-uint-comparison-with-zero-can-be-cheaper)| `uint` comparison with zero can be cheaper | 6 | 24 |\n|[[G-41]](#g-41-use-assembly-to-write-hashes)| Use assembly to write hashes | 8 | 960 |\n|[[G-42]](#g-42-use-assembly-to-validate-msgsender)| Use assembly to validate `msg.sender` | 25 | 300 |\n|[[G-43]](#g-43-use-assembly-to-write-address-storage-values)| Use assembly to write `address` storage values | 32 | 2,368 |\n|[[G-44]](#g-44-use-assembly-to-emit-an-event)| Use assembly to emit an `event` | 12 | 456 |\n\nTotal: 584 instances over 44 issues with an estimate of **878,488 gas** saved.\n\n### Disputed Issues\n|Id|Title|Instances|\n|:--:|:------|:--:|\n|[[D-01]](#d-01-its-possible-to-mint-to-address0)| It's possible to mint to `address(0)` | 1 |\n|[[D-02]](#d-02-use-an-already-existing-ownable-implementation)| Use an already existing `Ownable` implementation | 7 |\n|[[D-03]](#d-03-using-thisfn-wastes-gas)| Using `this.<fn>()` wastes gas | 39 |\n|[[D-04]](#d-04-some-functions-do-not-work-correctly-with-fee-on-transfer-tokens)| Some functions do not work correctly with fee-on-transfer tokens | 2 |\n|[[D-05]](#d-05-blocknumber-has-a-different-behaviour-on-different-chains)| `block.number` has a different behaviour on different chains | 3 |\n|[[D-06]](#d-06-wrong-address-when-deploying-on-multiple-chains)| Wrong `address` when deploying on multiple chains | 6 |\n|[[D-07]](#d-07-hardcoded-address-should-be-avoided)| Hardcoded `address` should be avoided | 9 |\n|[[D-08]](#d-08-enum-values-should-be-used-in-place-of-constant-array-indexes)| Enum values should be used in place of constant array indexes | 427 |\n|[[D-09]](#d-09-time-related-variables-should-use-time-units-instead-of-numbers)| Time related variables should use time units instead of numbers | 4 |\n|[[D-10]](#d-10-upgradeable-contract-is-missing-a-constructor-that-disables-initialization)| Upgradeable contract is missing a constructor that disables initialization | 8 |\n|[[D-11]](#d-11-upgradeable-contract-is-missing-a-gap-storage-variable)| Upgradeable contract is missing a gap storage variable | 8 |\n|[[D-12]](#d-12-selfbalance-is-cheaper-than-addressthisbalance)| `selfbalance()` is cheaper than `address(this).balance` | 2 |\n|[[D-13]](#d-13-initializers-could-be-front-run)| Initializers could be front-run | 2 |\n|[[D-14]](#d-14-modifier-order-does-not-comply-with-best-practices)| Modifier order does not comply with best practices | - |\n\nTotal: 518 instances over 14 issues.\n\n## High Risk Issues\n\n---\n\n### [H-01] Permanent DoS due to non-shrinking array usage in an unbounded loop\n\nThere are some arrays that can grow indefinitely in size, as they never shrink. When these arrays are used in unbounded loops, they may lead to a permanent denial-of-service (DoS) of these functions.\n\n**POC**:\n\n1. Attacker calls `participateToAuction` N times with dust amounts until `returnHighestBid` reverts (out of gas)\n2. When `claimAuction` is called by `WinnerOrAdminRequired`, the transaction will fail, as it calls `returnHighestBid`. As a result, `claimAuction` will be permanently DoS.\n\n*There are 4 instances of this issue.*\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/AuctionDemo.sol",
      "content": "// @audit function returnHighestBid is vulnerable as length grows in size but never shrinks\n69: \t\t            for (uint256 i=0; i< auctionInfoData[_tokenid].length; i++) {\n\n60: \t\t        auctionInfoData[_tokenid].push(newBid);\n\n// @audit function returnHighestBidder is vulnerable as length grows in size but never shrinks\n90: \t\t        for (uint256 i=0; i< auctionInfoData[_tokenid].length; i++) {\n\n60: \t\t        auctionInfoData[_tokenid].push(newBid);\n\n// @audit function claimAuction is vulnerable as length grows in size but never shrinks\n110: \t\t        for (uint256 i=0; i< auctionInfoData[_tokenid].length; i ++) {\n\n60: \t\t        auctionInfoData[_tokenid].push(newBid);\n\n// @audit function cancelAllBids is vulnerable as length grows in size but never shrinks\n136: \t\t        for (uint256 i=0; i<auctionInfoData[_tokenid].length; i++) {\n\n60: \t\t        auctionInfoData[_tokenid].push(newBid);\n```\n[[69](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L69), [90](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L90), [110](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L110), [136](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L136)]\n\n\n---\n\n## Medium Risk Issues\n\n---\n\n### [M-01] Unchecked return value of low-level `call()/delegatecall()`\n\nThe `call/delegatecall` function returns a boolean value indicating whether the call was successful. However, it is important to note that this return value is not being checked in the current implementation.\n\nAs a result, there is a possibility that the call wasn't successful, while the transaction continues without reverting.\n\n*There are 11 instances of this issue.*\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/AuctionDemo.sol",
      "content": "113: \t\t                (bool success, ) = payable(owner()).call{value: highestBid}(\"\");\n\n116: \t\t                (bool success, ) = payable(auctionInfoData[_tokenid][i].bidder).call{value: auctionInfoData[_tokenid][i].bid}(\"\");\n\n128: \t\t        (bool success, ) = payable(auctionInfoData[_tokenid][index].bidder).call{value: auctionInfoData[_tokenid][index].bid}(\"\");\n\n139: \t\t                (bool success, ) = payable(auctionInfoData[_tokenid][i].bidder).call{value: auctionInfoData[_tokenid][i].bid}(\"\");\n```\n[[113](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L113), [116](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L116), [128](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L128), [139](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/AuctionDemo.sol#L139)]\n\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/MinterContract.sol",
      "content": "434: \t\t        (bool success1, ) = payable(collectionArtistPrimaryAddresses[colId].primaryAdd1).call{value: artistRoyalties1}(\"\");\n\n435: \t\t        (bool success2, ) = payable(collectionArtistPrimaryAddresses[colId].primaryAdd2).call{value: artistRoyalties2}(\"\");\n\n436: \t\t        (bool success3, ) = payable(collectionArtistPrimaryAddresses[colId].primaryAdd3).call{value: artistRoyalties3}(\"\");\n\n437: \t\t        (bool success4, ) = payable(tm1).call{value: teamRoyalties1}(\"\");\n\n438: \t\t        (bool success5, ) = payable(tm2).call{value: teamRoyalties2}(\"\");\n\n464: \t\t        (bool success, ) = payable(admin).call{value: balance}(\"\");\n```\n[[434](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L434), [435](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L435), [436](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L436), [437](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L437), [438](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L438), [464](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L464)]\n\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/RandomizerRNG.sol",
      "content": "82: \t\t        (bool success, ) = payable(admin).call{value: balance}(\"\");\n```\n[[82](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/RandomizerRNG.sol#L82)]\n\n\n---\n\n### [M-02] User funds sent in excess are not refunded\n\nThese functions lack a refund mechanism for excess Ether sent by the caller, resulting in locked funds within the contract. To rectify this, the function should be modified to implement a refund for any surplus amount.\n\n*There are 3 instances of this issue.*\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/MinterContract.sol",
      "content": "233: \t\t        require(msg.value >= (getPrice(col) * _numberOfTokens), \"Wrong ETH\");\n234: \t\t        for(uint256 i = 0; i < _numberOfTokens; i++) {\n235: \t\t            uint256 mintIndex = gencore.viewTokensIndexMin(col) + gencore.viewCirSupply(col);\n236: \t\t            gencore.mint(mintIndex, mintingAddress, _mintTo, tokData, _saltfun_o, col, phase);\n237: \t\t        }\n238: \t\t        collectionTotalAmount[col] = collectionTotalAmount[col] + msg.value;\n\n266: \t\t        require(msg.value >= getPrice(_mintCollectionID), \"Wrong ETH\");\n267: \t\t        uint256 mintIndex = gencore.viewTokensIndexMin(_mintCollectionID) + gencore.viewCirSupply(_mintCollectionID);\n268: \t\t        // burn and mint token\n269: \t\t        address burner = msg.sender;\n270: \t\t        gencore.burnToMint(mintIndex, _burnCollectionID, _tokenId, _mintCollectionID, _saltfun_o, burner);\n271: \t\t        collectionTotalAmount[_mintCollectionID] = collectionTotalAmount[_mintCollectionID] + msg.value;\n\n361: \t\t        require(msg.value >= (getPrice(col) * 1), \"Wrong ETH\");\n362: \t\t        uint256 mintIndex = gencore.viewTokensIndexMin(col) + gencore.viewCirSupply(col);\n363: \t\t        gencore.mint(mintIndex, mintingAddress, ownerOfToken, tokData, _saltfun_o, col, phase);\n364: \t\t        collectionTotalAmount[col] = collectionTotalAmount[col] + msg.value;\n```\n[[233-238](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L233-L238), [266-271](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L266-L271), [361-364](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L361-L364)]\n\n\n---\n\n### [M-03] Centralization issue caused by admin privileges\n\nThere are priviliged roles that are a single point of failure, who can use critical functions, posing a centralization issue.\n\n*There is 1 instance of this issue.*\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/NextGenAdmins.sol",
      "content": "38: \t\t    function registerAdmin(address _admin, bool _status) public onlyOwner {\n```\n[[38](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/NextGenAdmins.sol#L38)]\n\n\n---\n\n## Low Risk Issues\n\n---\n\n### [L-01] Execution at deadlines should be allowed\n\nThe condition may be wrong in these cases, as when `block.timestamp` is equal to the compared `>` or `<` variable these blocks will not be executed.\n\n*There are 3 instances of this issue.*\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/MinterContract.sol",
      "content": "540: \t\t        } else if (collectionPhases[_collectionId].salesOption == 2 && block.timestamp > collectionPhases[_collectionId].allowlistStartTime && block.timestamp < collectionPhases[_collectionId].publicEndTime){\n\n540: \t\t        } else if (collectionPhases[_collectionId].salesOption == 2 && block.timestamp > collectionPhases[_collectionId].allowlistStartTime && block.timestamp < collectionPhases[_collectionId].publicEndTime){\n```\n[[540](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L540), [540](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/MinterContract.sol#L540)]\n\n\n\n```solidity"
    },
    {
      "filename": "smart-contracts/NextGenCore.sol",
      "content": "308: \t\t        require (block.timestamp > IMinterContract(minterContract).getEndTime(_collectionID) + collectionAdditionalData[_collectionID].setFinalSupplyTimeAfterMint, \"Time has not passed\");\n```\n[[308](https://github.com/code-423n4/2023-10-nextgen/blob/08a56bacd286ee52433670f3bb73a0e4a4525dd4/smart-contracts/NextGenCore.sol#L308)]\n\n\n---\n\n### [L-02] Missing checks in constructor/initialize\n\nThere are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.\n\n*There are 3 instances of this issue.*\n\n\n```solidit"
    }
  ]
}