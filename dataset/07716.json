{
  "Title": "[G-09] `require()` or `revert()` statements that check input arguments should be at the top of the function",
  "Content": "\nChecks that involve constants should come before checks that involve state variables, function calls, and calculations. By doing these checks first, the function is able to revert before wasting a Gcoldsload (2100 gas*) in a function that may ultimately revert in the unhappy case.\n\n- [Pool.sol#L71-L72](https://github.com/code-423n4/2022-11-non-fungible/blob/main/contracts/Pool.sol#L71-L72)\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/reports/2022-11-non-fungible",
  "Code": [
    {
      "filename": "contracts/Pool.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.17;\n\nimport \"@openzeppelin/contracts-upgradeable/proxy/utils/UUPSUpgradeable.sol\";\nimport \"@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol\";\n\nimport \"./interfaces/IPool.sol\";\n\n/**\n * @title Pool\n * @dev ETH pool; funds can only be transferred by Exchange or Swap\n */\ncontract Pool is IPool, OwnableUpgradeable, UUPSUpgradeable {\n    // required by the OZ UUPS module\n    function _authorizeUpgrade(address) internal override onlyOwner {}\n\n    address private constant EXCHANGE = 0x707531c9999AaeF9232C8FEfBA31FBa4cB78d84a;\n    // TODO: set proper address before deployment\n    address private constant SWAP = 0x707531c9999AaeF9232C8FEfBA31FBa4cB78d84a;\n\n    mapping(address => uint256) private _balances;\n\n    event Transfer(address indexed from, address indexed to, uint256 amount);\n\n    /**\n     * @dev receive deposit function\n     */\n    receive() external payable {\n        deposit();\n    }\n\n    /**\n     * @dev deposit ETH into pool\n     */\n    function deposit() public payable {\n        _balances[msg.sender] += msg.value;\n        emit Transfer(msg.sender, address(0), msg.value);\n    }\n\n    /**\n     * @dev withdraw ETH from pool\n     * @param amount Amount to withdraw\n     */\n    function withdraw(uint256 amount) public {\n        require(_balances[msg.sender] >= amount);\n        _balances[msg.sender] -= amount;\n        (bool success,) = payable(msg.sender).call{value: amount}(\"\");\n        require(success);\n        emit Transfer(address(0), msg.sender, amount);\n    }\n\n    /**\n     * @dev transferFrom Transfer balances within pool; only callable by Swap and Exchange\n     * @param from Pool fund sender\n     * @param to Pool fund recipient\n     * @param amount Amount to transfer\n     */\n    function transferFrom(address from, address to, uint256 amount)\n        public\n        returns (bool)\n    {\n        if (msg.sender != EXCHANGE && msg.sender != SWAP) {\n            revert('Caller is not authorized to transfer');\n        }\n        _transfer(from, to, amount);\n\n        return true;\n    }\n\n    function _transfer(address from, address to, uint256 amount) private {\n        require(_balances[from] >= amount);\n        require(to != address(0));\n        _balances[from] -= amount;\n        _balances[to] += amount;\n\n        emit Transfer(from, to, amount);\n    }\n\n    function balanceOf(address user) public view returns (uint256) {\n        return _balances[user];\n    }\n\n    function totalSupply() public view returns (uint256) {\n        return address(this).balance;\n    }\n}"
    }
  ]
}