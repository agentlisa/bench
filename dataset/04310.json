{
  "Title": "[L05] Lookup key strings are not centrally defined",
  "Content": "Known UMA contracts are tracked in the [`interfacesImplemented` mapping](https://github.com/UMAprotocol/protocol/blob/9d403ddb5f2f07194daefe7da51e0e0a6306f2c4/core/contracts/oracle/implementation/Finder.sol#L13) of the `Finder` contract. New entries can be added by a privileged address via the [`changeImplementationAddress`](https://github.com/UMAprotocol/protocol/blob/9d403ddb5f2f07194daefe7da51e0e0a6306f2c4/core/contracts/oracle/implementation/Finder.sol#L24) function, and the [`getImplementationAddress`](https://github.com/UMAprotocol/protocol/blob/9d403ddb5f2f07194daefe7da51e0e0a6306f2c4/core/contracts/oracle/implementation/Finder.sol#L37) function acts as a public getter to query the registry providing a string-type key. While this registry is used by several different contracts to get the addresses of legitimate UMA contracts, the strings used as keys to query the registry are not centrally defined. The identified strings are: `\"Oracle\"`, `\"IdentifierWhitelist\"`, `\"Store\"`, `\"FinancialContractsAdmin\"` and `\"Registry\"`.\n\n\nThis issue does not pose a security risk, but the approach taken is error-prone and difficult to maintain. Therefore, consider factoring out all mentioned constant strings to a single library, which can be then imported in the necessary contracts. This will ease maintenance and make the code more resilient to future changes.\n\n\n**Update:** *Fixed in [PR#1241](https://github.com/UMAprotocol/protocol/pull/1241) and [PR#1320](https://github.com/UMAprotocol/protocol/pull/1320). The code base uses the new `OracleInterfaces` library to reference contracts within the system.*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "core/contracts/oracle/implementation/Finder.sol",
      "content": "pragma solidity ^0.6.0;\n\nimport \"@openzeppelin/contracts/ownership/Ownable.sol\";\n\nimport \"../interfaces/FinderInterface.sol\";\n\n\n/**\n * @title Provides addresses of the live contracts implementing certain interfaces.\n * @dev Examples of interfaces with implementations that Finder locates are the Oracle and Store interfaces.\n */\ncontract Finder is FinderInterface, Ownable {\n    mapping(bytes32 => address) public interfacesImplemented;\n\n    event InterfaceImplementationChanged(bytes32 indexed interfaceName, address indexed newImplementationAddress);\n\n    /**\n     * @notice Updates the address of the contract that implements `interfaceName`.\n     * @param interfaceName bytes32 of the interface name that is either changed or registered.\n     * @param implementationAddress address of the implementation contract.\n     */\n    // TODO(#969) Remove once prettier-plugin-solidity can handle the \"override\" keyword\n    // prettier-ignore\n    function changeImplementationAddress(bytes32 interfaceName, address implementationAddress) external override onlyOwner {\n        interfacesImplemented[interfaceName] = implementationAddress;\n\n        emit InterfaceImplementationChanged(interfaceName, implementationAddress);\n    }\n\n    /**\n     * @notice Gets the address of the contract that implements the given `interfaceName`.\n     * @param interfaceName queried interface.\n     * @return implementationAddress address of the defined interface.\n     */\n    // TODO(#969) Remove once prettier-plugin-solidity can handle the \"override\" keyword\n    // prettier-ignore\n    function getImplementationAddress(bytes32 interfaceName) external override view returns (address implementationAddress) {\n        implementationAddress = interfacesImplemented[interfaceName];\n        require(implementationAddress != address(0x0), \"No implementation for interface found\");\n    }\n}"
    }
  ]
}