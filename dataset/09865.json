{
  "Title": "[M-08] `BURNER_ROLE` can burn any amount of EthErc20 from an arbitrary address",
  "Content": "_Submitted by cccz, also found by 0x1f8b_\n\n### Impact\n\nSame as  <https://github.com/code-423n4/2022-01-livepeer-findings/issues/194>\n\n        function forceBurn(address account, uint256 amount) external override {\n            require(hasRole(BURNER_ROLE, _msgSender()), \"BURNER role is required\");\n            _burn(account, amount);\n        }\n\nUsing the forceBurn() function of EthErc20, an address with BURNER_ROLE can burn an arbitrary amount of tokens from any address.\n\nWe believe this is unnecessary and poses a serious centralization risk.\n\n### Proof of Concept\n\n<https://github.com/skalenetwork/ima-c4-audit/blob/main/contracts/schain/tokens/EthErc20.sol#L64-L67>\n\n### Recommended Mitigation Steps\n\nUpdate forceBurn function for only owner can burn his tokens.\n\n\n**[cstrangedk (SKALE) disputed and commented](https://github.com/code-423n4/2022-02-skale-findings/issues/16#issuecomment-1058516461):**\n > Issue is acknowledged and work is pending on the roadmap.  SKALE chain owners must carefully manage BURNER_ROLE, and end-users carefully monitor role.\n\n**[GalloDaSballo (judge) commented](https://github.com/code-423n4/2022-02-skale-findings/issues/16#issuecomment-1143855354):**\n > This finding boils down to the flexibility of the role system against a more immutable address being set on the constructor, ultimately the role is contingent on configuration and as such I believe the finding to be valid and of medium severity.\n> \n> In the majority of configurations this will be a non-issue, however end users may want to monitor how roles are set and how they change over time to avoid their tokens being burned\n\n\n\n***\n\n",
  "Impact": "MEDIUM",
  "Source": "https://code4rena.com/contests/2022-02-skale-contest",
  "Code": [
    {
      "filename": "contracts/schain/tokens/EthErc20.sol",
      "content": "// SPDX-License-Identifier: AGPL-3.0-only\n\n/**\n *   EthErc20.sol - SKALE Interchain Messaging Agent\n *   Copyright (C) 2019-Present SKALE Labs\n *   @author Artem Payvin\n *\n *   SKALE IMA is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU Affero General Public License as published\n *   by the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   SKALE IMA is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU Affero General Public License for more details.\n *\n *   You should have received a copy of the GNU Affero General Public License\n *   along with SKALE IMA.  If not, see <https://www.gnu.org/licenses/>.\n */\n\npragma solidity 0.8.6;\n\nimport \"@openzeppelin/contracts-upgradeable/access/AccessControlEnumerableUpgradeable.sol\";\nimport \"@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20BurnableUpgradeable.sol\";\nimport \"@skalenetwork/ima-interfaces/schain/tokens/IEthErc20.sol\";\n\n\n/**\n * @title EthErc20\n * @dev ERC20 token that represents ETH on mainnet.\n */\ncontract EthErc20 is AccessControlEnumerableUpgradeable, ERC20BurnableUpgradeable, IEthErc20 {\n\n    /**\n     * @dev id of a role that allows token minting.\n     */\n    bytes32 public constant MINTER_ROLE = keccak256(\"MINTER_ROLE\");\n\n    /**\n     * @dev id of a role that allows token burning.\n     */\n    bytes32 public constant BURNER_ROLE = keccak256(\"BURNER_ROLE\");\n\n    /**\n     * @dev Mint tokens.\n     * \n     * Requirements:\n     * \n     * - sender must be granted with {MINTER_ROLE}.\n     */\n    function mint(address account, uint256 amount) external override {\n        require(hasRole(MINTER_ROLE, _msgSender()), \"MINTER role is required\");\n        _mint(account, amount);\n    }\n\n    /**\n     * @dev Burn tokens for any account.\n     * \n     * Requirements:\n     * \n     * - sender must be granted with {BURNER_ROLE}.\n     */\n    function forceBurn(address account, uint256 amount) external override {\n        require(hasRole(BURNER_ROLE, _msgSender()), \"BURNER role is required\");\n        _burn(account, amount);\n    }\n\n    /**\n     * @dev Is called once during contract deployment.\n     */\n    function initialize(address tokenManagerEthAddress)\n        external\n        override\n        initializer\n    {\n        AccessControlEnumerableUpgradeable.__AccessControlEnumerable_init();\n        ERC20Upgradeable.__ERC20_init(\"ERC20 Ether Clone\", \"ETHC\");\n        ERC20BurnableUpgradeable.__ERC20Burnable_init();        \n        _setupRole(DEFAULT_ADMIN_ROLE, msg.sender);\n        _setupRole(MINTER_ROLE, tokenManagerEthAddress);\n        _setupRole(BURNER_ROLE, tokenManagerEthAddress);\n    }\n}"
    }
  ]
}