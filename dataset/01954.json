{
  "Title": "M-7: Minting inconsistencies on FootiumPlayer and FootiumClub",
  "Content": "# Issue M-7: Minting inconsistencies on FootiumPlayer and FootiumClub \n\nSource: https://github.com/sherlock-audit/2023-04-footium-judging/issues/342 \n\n## Found by \n0xAsen, 0xHati, 0xLook, 0xPkhatri, 0xRobocop, 0xStalin, 0xeix, 0xhacksmithh, BAHOZ, Bauchibred, Bauer, Dug, GalloDaSballo, Koolex, PTolev, Phantasmagoria, TheNaubit, Tricko, ali\\_shehab, cergyk, chaithanya\\_gali, ctf\\_sec, cuthalion0x, deadrxsezzz, descharre, indijanc, jasonxiale, kiki\\_dev, lewisbroadhurst, nzm\\_, oualidpro, sashik\\_eth, shame, shogoki, tsueti\\_, tsvetanovv, wzrdk3lly\n## Summary\n\nThe `FootiumClub.sol` contract when minting uses `_mint()` instead of `_safeMint()` which can cause to mint a club to a contract who does not support nfts. On the other hand `FootiumPlayer.sol` uses `_safeMint()`.\n\n## Vulnerability Detail\n\nSee summary.\n\n## Impact\n\n`FootiumClub.sol` might mint a club NFT to a contract that cannot handle nfts.\n\n## Code Snippet\n\nhttps://github.com/sherlock-audit/2023-04-footium/blob/main/footium-eth-shareable/contracts/FootiumClub.sol#L65\n\n## Tool used\n\nManual Review\n\n## Recommendation\n\nUse `_safeMint()` as in FootiumPlayer.\n\n\n",
  "Impact": "MEDIUM",
  "Source": "https://app.sherlock.xyz/audits/contests/71",
  "Code": [
    {
      "filename": "footium-eth-shareable/contracts/FootiumClub.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.16;\n\nimport {ERC721Upgradeable, IERC721Upgradeable} from \"@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol\";\nimport {AccessControlUpgradeable} from \"@openzeppelin/contracts-upgradeable/access/AccessControlUpgradeable.sol\";\nimport {OwnableUpgradeable} from \"@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol\";\nimport {PausableUpgradeable} from \"@openzeppelin/contracts-upgradeable/security/PausableUpgradeable.sol\";\nimport {ReentrancyGuardUpgradeable} from \"@openzeppelin/contracts-upgradeable/security/ReentrancyGuardUpgradeable.sol\";\nimport {FootiumEscrow} from \"./FootiumEscrow.sol\";\n\n/**\n * @title Footium Football Club\n * @notice An NFT football club.\n */\ncontract FootiumClub is\n    ERC721Upgradeable,\n    AccessControlUpgradeable,\n    PausableUpgradeable,\n    ReentrancyGuardUpgradeable,\n    OwnableUpgradeable\n{\n    /* Storage */\n\n    bytes32 public constant MINTER_ROLE = keccak256(\"MINTER_ROLE\");\n\n    string private _base;\n    mapping(uint256 => FootiumEscrow) public clubToEscrow;\n\n    /* Events */\n\n    event EscrowDeployed(\n        uint256 indexed tokenId,\n        FootiumEscrow indexed escrowAddress\n    );\n\n    /**\n     * @dev Initializes the FootiumClub contract.\n     * @param baseURI Footium Club  token base metadata URI.\n     */\n    function initialize(string memory baseURI) external initializer {\n        __ERC721_init(\"FootiumClub\", \"FFC\");\n        __AccessControl_init();\n        __Pausable_init();\n        __ReentrancyGuard_init();\n        __Ownable_init();\n\n        _base = baseURI;\n        _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);\n    }\n\n    /** @notice Mints a Footium football club\n     * @dev Only accounts with the minting role can mint new clubs.\n     * @param to The address that will receive the club.\n     * @param tokenId The ID of the club to be minted.\n     */\n    function safeMint(address to, uint256 tokenId)\n        external\n        onlyRole(MINTER_ROLE)\n        nonReentrant\n        whenNotPaused\n    {\n        FootiumEscrow escrow = new FootiumEscrow(address(this), tokenId);\n        clubToEscrow[tokenId] = escrow;\n\n        _mint(to, tokenId);\n\n        emit EscrowDeployed(tokenId, escrow);\n    }\n\n    /**\n     * @notice Sets the base metadata URI.\n     * @param baseURI New base metadata URI to be set.\n     * @dev Only the contract owner can set a new URI.\n     */\n    function setBaseURI(string calldata baseURI) public onlyOwner {\n        _base = baseURI;\n    }\n\n    /**\n     * @notice Unpause the contract\n     * @dev Only owner address allowed.\n     */\n    function activateContract() external onlyOwner {\n        _unpause();\n    }\n\n    /**\n     * @notice Pause the contract\n     * @dev Only owner address allowed.\n     */\n    function pauseContract() external onlyOwner {\n        _pause();\n    }\n\n    function _baseURI() internal view override returns (string memory) {\n        return _base;\n    }\n\n    /**\n     * @dev See {IERC165-supportsInterface}.\n     */\n    function supportsInterface(bytes4 interfaceId)\n        public\n        view\n        override(ERC721Upgradeable, AccessControlUpgradeable)\n        returns (bool)\n    {\n        return super.supportsInterface(interfaceId);\n    }\n}"
    }
  ]
}