{
  "Title": "No validation of the address variable during initialization",
  "Content": "##### Description\nAt the lines \nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L61\nand\nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#70\nchanges variables without validations on same addresses and zero address.\n\n##### Recommendation\nIt is recommended to add validation on same addresses and zero addresses:\n\nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L61\n```solidity=\nrequire((fxRootSender != _fxRootSender) && (fxRootSender != address(0x0)));\n```\nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L70\n```solidity=\nrequire((fxChild != _fxChild) && (fxChild != address(0x0)));\n```\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/PolygonBridgeExecutor.sol",
      "content": "//SPDX-License-Identifier: Unlicense\npragma solidity 0.7.5;\npragma abicoder v2;\n\nimport './interfaces/IFxMessageProcessor.sol';\nimport './BridgeExecutorBase.sol';\n\ncontract PolygonBridgeExecutor is BridgeExecutorBase, IFxMessageProcessor {\n  address private _fxRootSender;\n  address private _fxChild;\n\n  event FxRootSenderUpdate(address previousFxRootSender, address newFxRootSender);\n  event FxChildUpdate(address previousFxChild, address newFxChild);\n\n  modifier onlyFxChild() {\n    require(msg.sender == _fxChild, 'UNAUTHORIZED_CHILD_ORIGIN');\n    _;\n  }\n\n  constructor(\n    address fxRootSender,\n    address fxChild,\n    uint256 delay,\n    uint256 gracePeriod,\n    uint256 minimumDelay,\n    uint256 maximumDelay,\n    address guardian\n  ) BridgeExecutorBase(delay, gracePeriod, minimumDelay, maximumDelay, guardian) {\n    _fxRootSender = fxRootSender;\n    _fxChild = fxChild;\n  }\n\n  /// @inheritdoc IFxMessageProcessor\n  function processMessageFromRoot(\n    uint256 stateId,\n    address rootMessageSender,\n    bytes calldata data\n  ) external override onlyFxChild {\n    require(rootMessageSender == _fxRootSender, 'UNAUTHORIZED_ROOT_ORIGIN');\n\n    address[] memory targets;\n    uint256[] memory values;\n    string[] memory signatures;\n    bytes[] memory calldatas;\n    bool[] memory withDelegatecalls;\n\n    (targets, values, signatures, calldatas, withDelegatecalls) = abi.decode(\n      data,\n      (address[], uint256[], string[], bytes[], bool[])\n    );\n\n    _queue(targets, values, signatures, calldatas, withDelegatecalls);\n  }\n\n  /**\n   * @dev Update the expected address of contract originating a cross-chain tranasaction\n   * @param fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function updateFxRootSender(address fxRootSender) external onlyThis {\n    emit FxRootSenderUpdate(_fxRootSender, fxRootSender);\n    _fxRootSender = fxRootSender;\n  }\n\n  /**\n   * @dev Update the address of the FxChild contract\n   * @param fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function updateFxChild(address fxChild) external onlyThis {\n    emit FxChildUpdate(_fxChild, fxChild);\n    _fxChild = fxChild;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxRootSender\n   * @return fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function getFxRootSender() external view returns (address) {\n    return _fxRootSender;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxChild\n   * @return fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function getFxChild() external view returns (address) {\n    return _fxChild;\n  }\n}"
    },
    {
      "filename": "contracts/PolygonBridgeExecutor.sol",
      "content": "//SPDX-License-Identifier: Unlicense\npragma solidity 0.7.5;\npragma abicoder v2;\n\nimport './interfaces/IFxMessageProcessor.sol';\nimport './BridgeExecutorBase.sol';\n\ncontract PolygonBridgeExecutor is BridgeExecutorBase, IFxMessageProcessor {\n  address private _fxRootSender;\n  address private _fxChild;\n\n  event FxRootSenderUpdate(address previousFxRootSender, address newFxRootSender);\n  event FxChildUpdate(address previousFxChild, address newFxChild);\n\n  modifier onlyFxChild() {\n    require(msg.sender == _fxChild, 'UNAUTHORIZED_CHILD_ORIGIN');\n    _;\n  }\n\n  constructor(\n    address fxRootSender,\n    address fxChild,\n    uint256 delay,\n    uint256 gracePeriod,\n    uint256 minimumDelay,\n    uint256 maximumDelay,\n    address guardian\n  ) BridgeExecutorBase(delay, gracePeriod, minimumDelay, maximumDelay, guardian) {\n    _fxRootSender = fxRootSender;\n    _fxChild = fxChild;\n  }\n\n  /// @inheritdoc IFxMessageProcessor\n  function processMessageFromRoot(\n    uint256 stateId,\n    address rootMessageSender,\n    bytes calldata data\n  ) external override onlyFxChild {\n    require(rootMessageSender == _fxRootSender, 'UNAUTHORIZED_ROOT_ORIGIN');\n\n    address[] memory targets;\n    uint256[] memory values;\n    string[] memory signatures;\n    bytes[] memory calldatas;\n    bool[] memory withDelegatecalls;\n\n    (targets, values, signatures, calldatas, withDelegatecalls) = abi.decode(\n      data,\n      (address[], uint256[], string[], bytes[], bool[])\n    );\n\n    _queue(targets, values, signatures, calldatas, withDelegatecalls);\n  }\n\n  /**\n   * @dev Update the expected address of contract originating a cross-chain tranasaction\n   * @param fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function updateFxRootSender(address fxRootSender) external onlyThis {\n    emit FxRootSenderUpdate(_fxRootSender, fxRootSender);\n    _fxRootSender = fxRootSender;\n  }\n\n  /**\n   * @dev Update the address of the FxChild contract\n   * @param fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function updateFxChild(address fxChild) external onlyThis {\n    emit FxChildUpdate(_fxChild, fxChild);\n    _fxChild = fxChild;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxRootSender\n   * @return fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function getFxRootSender() external view returns (address) {\n    return _fxRootSender;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxChild\n   * @return fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function getFxChild() external view returns (address) {\n    return _fxChild;\n  }\n}"
    },
    {
      "filename": "contracts/PolygonBridgeExecutor.sol",
      "content": "//SPDX-License-Identifier: Unlicense\npragma solidity 0.7.5;\npragma abicoder v2;\n\nimport './interfaces/IFxMessageProcessor.sol';\nimport './BridgeExecutorBase.sol';\n\ncontract PolygonBridgeExecutor is BridgeExecutorBase, IFxMessageProcessor {\n  address private _fxRootSender;\n  address private _fxChild;\n\n  event FxRootSenderUpdate(address previousFxRootSender, address newFxRootSender);\n  event FxChildUpdate(address previousFxChild, address newFxChild);\n\n  modifier onlyFxChild() {\n    require(msg.sender == _fxChild, 'UNAUTHORIZED_CHILD_ORIGIN');\n    _;\n  }\n\n  constructor(\n    address fxRootSender,\n    address fxChild,\n    uint256 delay,\n    uint256 gracePeriod,\n    uint256 minimumDelay,\n    uint256 maximumDelay,\n    address guardian\n  ) BridgeExecutorBase(delay, gracePeriod, minimumDelay, maximumDelay, guardian) {\n    _fxRootSender = fxRootSender;\n    _fxChild = fxChild;\n  }\n\n  /// @inheritdoc IFxMessageProcessor\n  function processMessageFromRoot(\n    uint256 stateId,\n    address rootMessageSender,\n    bytes calldata data\n  ) external override onlyFxChild {\n    require(rootMessageSender == _fxRootSender, 'UNAUTHORIZED_ROOT_ORIGIN');\n\n    address[] memory targets;\n    uint256[] memory values;\n    string[] memory signatures;\n    bytes[] memory calldatas;\n    bool[] memory withDelegatecalls;\n\n    (targets, values, signatures, calldatas, withDelegatecalls) = abi.decode(\n      data,\n      (address[], uint256[], string[], bytes[], bool[])\n    );\n\n    _queue(targets, values, signatures, calldatas, withDelegatecalls);\n  }\n\n  /**\n   * @dev Update the expected address of contract originating a cross-chain tranasaction\n   * @param fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function updateFxRootSender(address fxRootSender) external onlyThis {\n    emit FxRootSenderUpdate(_fxRootSender, fxRootSender);\n    _fxRootSender = fxRootSender;\n  }\n\n  /**\n   * @dev Update the address of the FxChild contract\n   * @param fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function updateFxChild(address fxChild) external onlyThis {\n    emit FxChildUpdate(_fxChild, fxChild);\n    _fxChild = fxChild;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxRootSender\n   * @return fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function getFxRootSender() external view returns (address) {\n    return _fxRootSender;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxChild\n   * @return fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function getFxChild() external view returns (address) {\n    return _fxChild;\n  }\n}"
    },
    {
      "filename": "contracts/PolygonBridgeExecutor.sol",
      "content": "//SPDX-License-Identifier: Unlicense\npragma solidity 0.7.5;\npragma abicoder v2;\n\nimport './interfaces/IFxMessageProcessor.sol';\nimport './BridgeExecutorBase.sol';\n\ncontract PolygonBridgeExecutor is BridgeExecutorBase, IFxMessageProcessor {\n  address private _fxRootSender;\n  address private _fxChild;\n\n  event FxRootSenderUpdate(address previousFxRootSender, address newFxRootSender);\n  event FxChildUpdate(address previousFxChild, address newFxChild);\n\n  modifier onlyFxChild() {\n    require(msg.sender == _fxChild, 'UNAUTHORIZED_CHILD_ORIGIN');\n    _;\n  }\n\n  constructor(\n    address fxRootSender,\n    address fxChild,\n    uint256 delay,\n    uint256 gracePeriod,\n    uint256 minimumDelay,\n    uint256 maximumDelay,\n    address guardian\n  ) BridgeExecutorBase(delay, gracePeriod, minimumDelay, maximumDelay, guardian) {\n    _fxRootSender = fxRootSender;\n    _fxChild = fxChild;\n  }\n\n  /// @inheritdoc IFxMessageProcessor\n  function processMessageFromRoot(\n    uint256 stateId,\n    address rootMessageSender,\n    bytes calldata data\n  ) external override onlyFxChild {\n    require(rootMessageSender == _fxRootSender, 'UNAUTHORIZED_ROOT_ORIGIN');\n\n    address[] memory targets;\n    uint256[] memory values;\n    string[] memory signatures;\n    bytes[] memory calldatas;\n    bool[] memory withDelegatecalls;\n\n    (targets, values, signatures, calldatas, withDelegatecalls) = abi.decode(\n      data,\n      (address[], uint256[], string[], bytes[], bool[])\n    );\n\n    _queue(targets, values, signatures, calldatas, withDelegatecalls);\n  }\n\n  /**\n   * @dev Update the expected address of contract originating a cross-chain tranasaction\n   * @param fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function updateFxRootSender(address fxRootSender) external onlyThis {\n    emit FxRootSenderUpdate(_fxRootSender, fxRootSender);\n    _fxRootSender = fxRootSender;\n  }\n\n  /**\n   * @dev Update the address of the FxChild contract\n   * @param fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function updateFxChild(address fxChild) external onlyThis {\n    emit FxChildUpdate(_fxChild, fxChild);\n    _fxChild = fxChild;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxRootSender\n   * @return fxRootSender contract originating a cross-chain tranasaction - likely the aave governance executor\n   **/\n  function getFxRootSender() external view returns (address) {\n    return _fxRootSender;\n  }\n\n  /**\n   * @dev Get the address currently stored as fxChild\n   * @return fxChild the address of the contract used to foward cross-chain transactions on Polygon\n   **/\n  function getFxChild() external view returns (address) {\n    return _fxChild;\n  }\n}"
    }
  ]
}