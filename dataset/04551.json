{
  "Title": "Merchant address can beÂ null",
  "Content": "A [`MerchantSubscription`](https://github.com/ChainXcom/coinfix.io-smart-contracts/blob/75edd659ce96c88fe2784f3e767d6617787e8b7c/merchant_subscription/MerchantSubscription.sol#L83) contract can be instantiated with the null address as the `merchant` parameter. Such an instance will never be able to be activated or function at all. Consider adding a sanity check in the constructor to require that the `merchant` parameter is different from `0x0`. This will also be in line with the principle of [failing as early and loudly as possible](https://blog.zeppelin.solutions/onward-with-ethereum-smart-contract-security-97a827e47702#14aa).  \n\n***Update:** Fixed in [this](https://github.com/ChainXcom/coinfix.io-smart-contracts/commit/c02c083173fee08fb6e8e20ff854e5fbbbe9ed55) commit by checking `merchantÂ != 0x0`.*\n\n\n",
  "Impact": "MEDIUM",
  "Source": "",
  "Code": [
    {
      "filename": "merchant_subscription/MerchantSubscription.sol",
      "content": "pragma solidity ^0.4.11;\n\n\nlibrary SafeMath {\n\tfunction add(uint256 a, uint256 b) internal constant returns (uint256) {\n\t\tuint256 c = a + b;\n\t\tassert(c >= a && c >= b);\n\t\treturn c;\n\t}\n\n\tfunction sub(uint256 a, uint256 b) internal constant returns (uint256) {\n\t\tassert(b <= a);\n\t\treturn a - b;\n\t}\n}\n\n\ncontract MerchantSubscription {\n\tstruct Status {\n\tbool isActive;\n\tbool isClosed;\n\tbool isPaused;\n\t}\n\n\t/* DATA */\n\n\taddress public merchant;\n\n\taddress public owner;\n\n\taddress public pendingOwner;\n\n\tStatus public status = Status(false, false, false);\n\n\tuint public amount = 0;\n\n\tstring public name;\n\n\tstring public version = '1.0.3';\n\n\n\t/* EVENTS */\n\n\tevent SubscriptionPaymentMade(address customer, uint amount);\n\n\tevent WithdrawalMade(address merchant, address owner, uint amount);\n\n\tevent OwnerChanged(address to);\n\n\tevent SubscriptionPaused();\n\n\tevent SubscriptionResumed();\n\n\tevent SubscriptionClosed();\n\n\tevent SubscriptionActivated();\n\n\t/* MODIFIERS */\n\n\tmodifier onlyOwner {\n\t\trequire(msg.sender == owner);\n\t\t_;\n\t}\n\n\tmodifier onlyPendingOwner {\n\t\trequire(msg.sender == pendingOwner);\n\t\t_;\n\t}\n\n\tmodifier onlyMerchant {\n\t\trequire(msg.sender == merchant);\n\t\t_;\n\t}\n\n\tmodifier allowDeposit {\n\t\trequire(!status.isClosed && !status.isPaused && status.isActive);\n\t\t_;\n\t}\n\n\t/* FUNCTIONS */\n\n\t/* constructor - setup merchant address */\n\tfunction MerchantSubscription(address _merchant, string _name) {\n\t\tmerchant = _merchant;\n\t\towner = msg.sender;\n\t\tname = _name;\n\t}\n\n\t/* function that is called whenever anyone sends funds to a contract */\n\tfunction() allowDeposit payable {\n\t\tamount = SafeMath.add(amount, msg.value);\n\n\t\tSubscriptionPaymentMade(msg.sender, msg.value);\n\t}\n\n\tfunction withdrawal(uint withdrawalAmount) onlyOwner public {\n\t\trequire(withdrawalAmount <= amount);\n\n\t\tamount = SafeMath.sub(amount, withdrawalAmount);\n\n\t\tmerchant.transfer(withdrawalAmount);\n\n\t\tWithdrawalMade(merchant, owner, withdrawalAmount);\n\t}\n\n\tfunction activate() onlyMerchant public {\n\t\trequire(!status.isActive);\n\n\t\tstatus.isActive = true;\n\n\t\tSubscriptionActivated();\n\t}\n\n\tfunction pause() onlyOwner public {\n\t\trequire(!status.isPaused);\n\n\t\tstatus.isPaused = true;\n\n\t\tSubscriptionPaused();\n\t}\n\n\tfunction resume() onlyOwner public {\n\t\trequire(status.isPaused);\n\n\t\tstatus.isPaused = false;\n\n\t\tSubscriptionResumed();\n\t}\n\n\tfunction close() onlyOwner public {\n\t\trequire(!status.isClosed);\n\n\t\tstatus.isClosed = true;\n\n\t\tSubscriptionClosed();\n\t}\n\n\tfunction transferOwnership(address newOwner) onlyOwner public {\n\t\trequire(newOwner != owner);\n\n\t\tpendingOwner = newOwner;\n\t}\n\n\tfunction claimOwnership() onlyPendingOwner {\n\t\towner = pendingOwner;\n\t\tpendingOwner = 0x0;\n\n\t\tOwnerChanged(owner);\n\t}\n}"
    }
  ]
}