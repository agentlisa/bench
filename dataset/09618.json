{
  "Title": "[08] Unused functions and modifiers",
  "Content": "\nThese functions are noted as for backward compatibility, but not used anywhere, should probably be removed.\n\n### Proof of Concept\n\n[CoreRef.sol#L10](https://github.com/code-423n4/2022-03-volt/blob/main/contracts/refs/CoreRef.sol#L10)<br>\n\nUnused functions:\n\n*   \\_burnVoltHeld\n\nUnused modifiers:\n\n*   onlyVolt\n*   hasAnyOfFiveRoles\n*   hasAnyOfFourRoles\n*   hasAnyOfThreeRoles\n*   onlyGovernorOrGuardianOrAdmin\n*   ifMinterSelf\n\n### Recommended Mitigation Steps\n\nRemove these unused functions and modifiers.\n\n\n\n***\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2022-03-volt",
  "Code": [
    {
      "filename": "contracts/refs/CoreRef.sol",
      "content": "// SPDX-License-Identifier: GPL-3.0-or-later\npragma solidity ^0.8.4;\n\nimport \"./ICoreRef.sol\";\nimport \"@openzeppelin/contracts/security/Pausable.sol\";\n\n/// @title A Reference to Core\n/// @author Fei Protocol\n/// @notice defines some modifiers and utilities around interacting with Core\nabstract contract CoreRef is ICoreRef, Pausable {\n    ICore private immutable _core;\n    IVolt private immutable _volt;\n    IERC20 private immutable _vcon;\n\n    /// @notice a role used with a subset of governor permissions for this contract only\n    bytes32 public override CONTRACT_ADMIN_ROLE;\n\n    constructor(address coreAddress) {\n        _core = ICore(coreAddress);\n\n        _volt = ICore(coreAddress).volt();\n        _vcon = ICore(coreAddress).vcon();\n\n        _setContractAdminRole(ICore(coreAddress).GOVERN_ROLE());\n    }\n\n    function _initialize() internal {} // no-op for backward compatibility\n\n    modifier ifMinterSelf() {\n        if (_core.isMinter(address(this))) {\n            _;\n        }\n    }\n\n    modifier onlyMinter() {\n        require(_core.isMinter(msg.sender), \"CoreRef: Caller is not a minter\");\n        _;\n    }\n\n    modifier onlyBurner() {\n        require(_core.isBurner(msg.sender), \"CoreRef: Caller is not a burner\");\n        _;\n    }\n\n    modifier onlyPCVController() {\n        require(\n            _core.isPCVController(msg.sender),\n            \"CoreRef: Caller is not a PCV controller\"\n        );\n        _;\n    }\n\n    modifier onlyGovernorOrAdmin() {\n        require(\n            _core.isGovernor(msg.sender) || isContractAdmin(msg.sender),\n            \"CoreRef: Caller is not a governor or contract admin\"\n        );\n        _;\n    }\n\n    modifier onlyGovernor() {\n        require(\n            _core.isGovernor(msg.sender),\n            \"CoreRef: Caller is not a governor\"\n        );\n        _;\n    }\n\n    modifier onlyGuardianOrGovernor() {\n        require(\n            _core.isGovernor(msg.sender) || _core.isGuardian(msg.sender),\n            \"CoreRef: Caller is not a guardian or governor\"\n        );\n        _;\n    }\n\n    modifier onlyGovernorOrGuardianOrAdmin() {\n        require(\n            _core.isGovernor(msg.sender) ||\n                _core.isGuardian(msg.sender) ||\n                isContractAdmin(msg.sender),\n            \"CoreRef: Caller is not governor or guardian or admin\"\n        );\n        _;\n    }\n\n    // Named onlyTribeRole to prevent collision with OZ onlyRole modifier\n    modifier onlyTribeRole(bytes32 role) {\n        require(_core.hasRole(role, msg.sender), \"UNAUTHORIZED\");\n        _;\n    }\n\n    // Modifiers to allow any combination of roles\n    modifier hasAnyOfTwoRoles(bytes32 role1, bytes32 role2) {\n        require(\n            _core.hasRole(role1, msg.sender) ||\n                _core.hasRole(role2, msg.sender),\n            \"UNAUTHORIZED\"\n        );\n        _;\n    }\n\n    modifier hasAnyOfThreeRoles(\n        bytes32 role1,\n        bytes32 role2,\n        bytes32 role3\n    ) {\n        require(\n            _core.hasRole(role1, msg.sender) ||\n                _core.hasRole(role2, msg.sender) ||\n                _core.hasRole(role3, msg.sender),\n            \"UNAUTHORIZED\"\n        );\n        _;\n    }\n\n    modifier hasAnyOfFourRoles(\n        bytes32 role1,\n        bytes32 role2,\n        bytes32 role3,\n        bytes32 role4\n    ) {\n        require(\n            _core.hasRole(role1, msg.sender) ||\n                _core.hasRole(role2, msg.sender) ||\n                _core.hasRole(role3, msg.sender) ||\n                _core.hasRole(role4, msg.sender),\n            \"UNAUTHORIZED\"\n        );\n        _;\n    }\n\n    modifier hasAnyOfFiveRoles(\n        bytes32 role1,\n        bytes32 role2,\n        bytes32 role3,\n        bytes32 role4,\n        bytes32 role5\n    ) {\n        require(\n            _core.hasRole(role1, msg.sender) ||\n                _core.hasRole(role2, msg.sender) ||\n                _core.hasRole(role3, msg.sender) ||\n                _core.hasRole(role4, msg.sender) ||\n                _core.hasRole(role5, msg.sender),\n            \"UNAUTHORIZED\"\n        );\n        _;\n    }\n\n    modifier onlyVolt() {\n        require(msg.sender == address(_volt), \"CoreRef: Caller is not VOLT\");\n        _;\n    }\n\n    /// @notice sets a new admin role for this contract\n    function setContractAdminRole(bytes32 newContractAdminRole)\n        external\n        override\n        onlyGovernor\n    {\n        _setContractAdminRole(newContractAdminRole);\n    }\n\n    /// @notice returns whether a given address has the admin role for this contract\n    function isContractAdmin(address _admin)\n        public\n        view\n        override\n        returns (bool)\n    {\n        return _core.hasRole(CONTRACT_ADMIN_ROLE, _admin);\n    }\n\n    /// @notice set pausable methods to paused\n    function pause() public override onlyGuardianOrGovernor {\n        _pause();\n    }\n\n    /// @notice set pausable methods to unpaused\n    function unpause() public override onlyGuardianOrGovernor {\n        _unpause();\n    }\n\n    /// @notice address of the Core contract referenced\n    /// @return ICore implementation address\n    function core() public view override returns (ICore) {\n        return _core;\n    }\n\n    /// @notice address of the Fei contract referenced by Core\n    /// @return IFei implementation address\n    function volt() public view override returns (IVolt) {\n        return _volt;\n    }\n\n    /// @notice address of the Tribe contract referenced by Core\n    /// @return IERC20 implementation address\n    function vcon() public view override returns (IERC20) {\n        return _vcon;\n    }\n\n    /// @notice volt balance of contract\n    /// @return volt amount held\n    function voltBalance() public view override returns (uint256) {\n        return _volt.balanceOf(address(this));\n    }\n\n    /// @notice vcon balance of contract\n    /// @return vcon amount held\n    function vconBalance() public view override returns (uint256) {\n        return _vcon.balanceOf(address(this));\n    }\n\n    function _burnVoltHeld() internal {\n        _volt.burn(voltBalance());\n    }\n\n    function _mintVolt(address to, uint256 amount) internal virtual {\n        if (amount != 0) {\n            _volt.mint(to, amount);\n        }\n    }\n\n    function _setContractAdminRole(bytes32 newContractAdminRole) internal {\n        bytes32 oldContractAdminRole = CONTRACT_ADMIN_ROLE;\n        CONTRACT_ADMIN_ROLE = newContractAdminRole;\n        emit ContractAdminRoleUpdate(\n            oldContractAdminRole,\n            newContractAdminRole\n        );\n    }\n}"
    }
  ]
}