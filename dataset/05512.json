{
  "Title": "[11] `RendererBase` does not need to define a virtual `contractURI()` function",
  "Content": "\nhttps://github.com/code-423n4/2023-10-party/blob/b23c65d62a20921c709582b0b76b387f2bb9ebb5/contracts/renderers/RendererBase.sol#L26\n\nThe `RendererBase` abstract contract defines a `function contractURI() virtual` function. This definition is unnecessary, because `RendererBase` is an abstract child of `IERC721Renderer`, and this condition is sufficient to enforce at compile-time the presence of an implementation in its children.\n\nConsider removing it.\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2023-10-party",
  "Code": [
    {
      "filename": "contracts/renderers/RendererBase.sol",
      "content": "// SPDX-License-Identifier: GPL-3.0\npragma solidity 0.8.20;\n\nimport { Strings } from \"../utils/vendor/Strings.sol\";\nimport { Color } from \"../utils/LibRenderer.sol\";\nimport { Party } from \"contracts/party/Party.sol\";\nimport { IGlobals } from \"../globals/IGlobals.sol\";\nimport { IFont } from \"./fonts/IFont.sol\";\nimport { IERC721Renderer } from \"./IERC721Renderer.sol\";\nimport { RendererStorage } from \"./RendererStorage.sol\";\n\nabstract contract RendererBase is IERC721Renderer {\n    using Strings for uint256;\n    using Strings for string;\n\n    IGlobals immutable _GLOBALS;\n    RendererStorage immutable _storage;\n    IFont immutable _font;\n\n    constructor(IGlobals globals, RendererStorage rendererStorage, IFont font) {\n        _GLOBALS = globals;\n        _storage = rendererStorage;\n        _font = font;\n    }\n\n    function contractURI() external view virtual returns (string memory);\n\n    function getCustomizationChoices() internal view returns (bool isDarkMode, Color color) {\n        // Get the customization preset ID chosen by the crowdfund or party instance.\n        uint256 presetId = _storage.getPresetFor(address(this));\n\n        if (presetId == 0) {\n            // Preset ID 0 is reserved. It is used to indicate to party instances\n            // to use the same customization preset as the crowdfund.\n            (bool success, bytes memory result) = address(this).staticcall(\n                // Call mintAuthority\n                abi.encodeWithSignature(\"mintAuthority()\")\n            );\n\n            if (success && result.length == 32) {\n                address crowdfund = abi.decode(result, (address));\n                // Should return the crowdfund used to create the party, if the\n                // party was created conventionally. Use the customization\n                // preset chosen during crowdfund initialization.\n                presetId = _storage.getPresetFor(crowdfund);\n                // If the preset ID is still 0 (this shouldn't happen), fallback\n                // to the default customization options.\n                if (presetId == 0) return (false, Color.DEFAULT);\n            } else {\n                // Fallback to the default customization options. May happen if\n                // called from a non-party contract (e.g. a crowdfund contract,\n                // although this shouldn't happen).\n                return (false, Color.DEFAULT);\n            }\n        }\n\n        // Get the customization data for the preset chosen.\n        bytes memory customizationData = _storage.customizationPresets(presetId);\n        if (customizationData.length == 0) {\n            // If the customization preset doesn't exist, fallback to the\n            // default customization options.\n            return (false, Color.DEFAULT);\n        }\n\n        // Check version number. Fallback to default if using different version.\n        if (abi.decode(customizationData, (uint8)) == 1) {\n            (, isDarkMode, color) = abi.decode(customizationData, (uint8, bool, Color));\n        } else {\n            // Fallback to the default customization options.\n            return (false, Color.DEFAULT);\n        }\n    }\n}"
    }
  ]
}