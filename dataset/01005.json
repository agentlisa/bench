{
  "Title": "Incorrect Parent Initializer in BridgedToken",
  "Content": "The `BridgedToken` contract inherits from `ERC20PermitUpgradeable`, however, it [calls `__EIP712_init`](https://github.com/Consensys/linea-contracts/blob/f08c1906855198e2dc0413a47dcb38291b7087e5/contracts/tokenBridge/BridgedToken.sol#L31) instead of calling its parent initializer `__ERC20Permit_init`. Consider calling `__ERC20Permit_init` to follow best practices and remain compatible with any future changes to the `ERC20PermitUpgradeable` contract's codebase.\n\n\n***Update:** Resolved at commit [bb3691b](https://github.com/Consensys/linea-contracts-fix/commit/bb3691b67101e5cc9839b781af861defa81a2986#diff-25f3d0fec85d77ddb3f064f0d83dd452e62c913e4d3a558253315cd533998265R152).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/tokenBridge/BridgedToken.sol",
      "content": "// SPDX-License-Identifier: AGPL-3.0\npragma solidity ^0.8.19;\n\nimport { ERC20PermitUpgradeable } from \"@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20PermitUpgradeable.sol\";\n\n/**\n * @title BridgedToken Contract\n * @notice ERC20 token created when a native token is bridged to a target chain.\n */\ncontract BridgedToken is ERC20PermitUpgradeable {\n  address public bridge;\n  uint8 public _decimals;\n  /**\n   * @notice Initializes the BridgedToken contract.\n   * @dev Disables OpenZeppelin's initializer mechanism for safety.\n   */\n\n  /// @dev Keep free storage slots for future implementation updates to avoid storage collision.\n  uint256[50] private __gap;\n\n  error OnlyBridge(address bridgeAddress);\n\n  /// @dev Disable constructor for safety\n  /// @custom:oz-upgrades-unsafe-allow constructor\n  constructor() {\n    _disableInitializers();\n  }\n\n  function initialize(string memory _tokenName, string memory _tokenSymbol, uint8 _tokenDecimals) external initializer {\n    __ERC20_init(_tokenName, _tokenSymbol);\n    __EIP712_init(_tokenName, \"1\");\n    bridge = msg.sender;\n    _decimals = _tokenDecimals;\n  }\n\n  /// @dev Ensures call come from the bridge.\n  modifier onlyBridge() {\n    if (msg.sender != bridge) revert OnlyBridge(bridge);\n    _;\n  }\n\n  /**\n   * @dev Called by the bridge to mint tokens during a bridge transaction.\n   * @param _recipient The address to receive the minted tokens.\n   * @param _amount The amount of tokens to mint.\n   */\n  function mint(address _recipient, uint256 _amount) external onlyBridge {\n    _mint(_recipient, _amount);\n  }\n\n  /**\n   * @dev Called by the bridge to burn tokens during a bridge transaction.\n   * @dev User should first have allowed the bridge to spend tokens on their behalf.\n   * @param _account The account from which tokens will be burned.\n   * @param _amount The amount of tokens to burn.\n   */\n  function burn(address _account, uint256 _amount) external onlyBridge {\n    _spendAllowance(_account, msg.sender, _amount);\n    _burn(_account, _amount);\n  }\n\n  /**\n   * @dev Overrides ERC20 default function to support tokens with different decimals.\n   * @return The number of decimal.\n   */\n  function decimals() public view override returns (uint8) {\n    return _decimals;\n  }\n}"
    }
  ]
}