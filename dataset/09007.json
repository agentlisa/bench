{
  "Title": "[M-02] `VeloGovernor`: `proposalNumerator` and team are updated by team, not governance",
  "Content": "_Submitted by cccz_\n\nsetProposalNumerator and setTeam functions of the VeloGovernor contract can only be called by team without allowing governance to call.\n\n### Proof of Concept\n\n[VeloGovernor.sol#L44-L48](https://github.com/code-423n4/2022-05-velodrome/blob/7fda97c570b758bbfa7dd6724a336c43d4041740/contracts/contracts/VeloGovernor.sol#L44-L48)<br>\n\n### Recommended Mitigation Steps\n\nAllow governance to call setProposalNumerator and setTeam functions.\n\n**[pooltypes (Velodrome) acknowledged](https://github.com/code-423n4/2022-05-velodrome-findings/issues/28)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-05-velodrome-findings/issues/28#issuecomment-1166649382):**\n > I really dislike how the finding is phrased as the variable `team` doesn't mean much by itself.\n> \n> That said the finding has validity in that the Governance Contract should be calling to change the `proposalNumerator` so a check should probably be for `address(this)`.\n\n\n\n***\n\n",
  "Impact": "MEDIUM",
  "Source": "https://code4rena.com/reports/2022-05-velodrome",
  "Code": [
    {
      "filename": "contracts/contracts/VeloGovernor.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.13;\n\nimport {IGovernor} from \"@openzeppelin/contracts/governance/IGovernor.sol\";\nimport {IVotes} from \"@openzeppelin/contracts/governance/utils/IVotes.sol\";\n\nimport {L2Governor} from \"./governance/L2Governor.sol\";\nimport {L2GovernorCountingSimple} from \"./governance/L2GovernorCountingSimple.sol\";\nimport {L2GovernorVotes} from \"./governance/L2GovernorVotes.sol\";\nimport {L2GovernorVotesQuorumFraction} from \"./governance/L2GovernorVotesQuorumFraction.sol\";\n\ncontract VeloGovernor is\n    L2Governor,\n    L2GovernorCountingSimple,\n    L2GovernorVotes,\n    L2GovernorVotesQuorumFraction\n{\n    address public team;\n    uint256 public constant MAX_PROPOSAL_NUMERATOR = 50; // max 5%\n    uint256 public constant PROPOSAL_DENOMINATOR = 1000;\n    uint256 public proposalNumerator = 2; // start at 0.02%\n\n    constructor(IVotes _ve)\n        L2Governor(\"Velodrome Governor\")\n        L2GovernorVotes(_ve)\n        L2GovernorVotesQuorumFraction(4) // 4%\n    {\n        team = msg.sender;\n    }\n\n    function votingDelay() public pure override(IGovernor) returns (uint256) {\n        return 15 minutes; // 1 block\n    }\n\n    function votingPeriod() public pure override(IGovernor) returns (uint256) {\n        return 1 weeks;\n    }\n\n    function setTeam(address newTeam) external {\n        require(msg.sender == team, \"not team\");\n        team = newTeam;\n    }\n\n    function setProposalNumerator(uint256 numerator) external {\n        require(msg.sender == team, \"not team\");\n        require(numerator <= MAX_PROPOSAL_NUMERATOR, \"numerator too high\");\n        proposalNumerator = numerator;\n    }\n\n    function proposalThreshold()\n        public\n        view\n        override(L2Governor)\n        returns (uint256)\n    {\n        return\n            (token.getPastTotalSupply(block.timestamp) * proposalNumerator) /\n            PROPOSAL_DENOMINATOR;\n    }\n}"
    }
  ]
}