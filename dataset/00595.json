{
  "Title": "Missing Import of Events, Structs, and Enums from Contract to ABI",
  "Content": "The [`renderSystemInterface` function](https://github.com/latticexyz/mud/blob/f6133591a86eb169a7b1b2b8d342733a887af610/packages/world/ts/node/render-solidity/renderSystemInterface.ts#L16-L27) automatically generates an interface from the corresponding contract. The function takes the imports, the contract name, functions, function prefix, and errors into account. However, it does not include events, structs, and enums. It is worth noting that since the interface is generated from the System file, the System cannot inherit its own interface. Thus, the duplicate definition does not lead to a conflict. One advantage of generating all the interfaces is that the `IWorld` interface will fail to compile if there are conflicting function signatures or errors across the different systems. This feature can be extended to the other structures as well.\n\n\nConsider also including the events, structs, and enums to ensure the generation of a complete interface.\n\n\n***Update:** Partially resolved inÂ [pull request #2194](https://github.com/latticexyz/mud/pull/2194). The Lattice Labs team stated:*\n\n\n\n> *We [played around with this](https://github.com/latticexyz/mud/pull/2171) but decided against these changes:*\n> \n> \n> * *It does not make sense for us to copy over structs/enums into system interfaces because they end up being treated as different types in Solidity. It's best to define+import them from a common place outside of systems.*\n> * *We do not want to encourage defining events in systems because they create side effects with potentially unexpected results depending on the context in which the system was called (`call` vs `delegatecall`). We did make a small adjustment to only include errors in interfaces when they are actually used (rather than including them if they are found in the file).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "packages/world/ts/node/render-solidity/renderSystemInterface.ts",
      "content": "import { renderArguments, renderList, renderedSolidityHeader, renderImports } from \"@latticexyz/common/codegen\";\nimport { RenderSystemInterfaceOptions } from \"./types\";\n\nexport function renderSystemInterface(options: RenderSystemInterfaceOptions) {\n  const { imports, name, functionPrefix, functions, errors } = options;\n\n  return `\n    ${renderedSolidityHeader}\n\n    ${renderImports(imports)}\n\n    /**\n     * @title ${name}\n     * @dev This interface is automatically generated from the corresponding system contract. Do not edit manually.\n     */\n    interface ${name} {\n      ${renderList(errors, ({ name, parameters }) => `error ${name}(${renderArguments(parameters)});`)}\n\n      ${renderList(\n        functions,\n        ({ name, parameters, stateMutability, returnParameters }) => `\n          function ${functionPrefix}${name}(\n            ${renderArguments(parameters)}\n          ) external ${stateMutability} ${renderReturnParameters(returnParameters)};\n        `\n      )}\n    }\n  `;\n}\n\nfunction renderReturnParameters(returnParameters: string[]) {\n  if (returnParameters.length > 0) {\n    return `returns (${renderArguments(returnParameters)})`;\n  } else {\n    return \"\";\n  }\n}"
    }
  ]
}