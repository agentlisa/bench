{
  "Title": "[G-07] Unnecessary variable in `BridgeInitializationHelper.sol`",
  "Content": "\n**Function `requestDeployTransaction`:**\nVariable `deployCalldata` is used only once, which means it doesn't need to be declared at all. The code snippet below can be changed from:\n\n[File: ethereum/contracts/common/AllowList.sol](https://github.com/code-423n4/2023-10-zksync/blob/1fb4649b612fac7b4ee613df6f6b7d921ddd6b0d/code/contracts/ethereum/contracts/bridge/libraries/BridgeInitializationHelper.sol#L37-L49)\n\n```\n        bytes memory deployCalldata = abi.encodeCall(\n            IL2ContractDeployer.create2,\n            (bytes32(0), _bytecodeHash, _constructorData)\n        );\n        _zkSync.requestL2Transaction{value: _deployTransactionFee}(\n            L2_DEPLOYER_SYSTEM_CONTRACT_ADDR,\n            0,\n            deployCalldata,\n            DEPLOY_L2_BRIDGE_COUNTERPART_GAS_LIMIT,\n            REQUIRED_L2_GAS_PRICE_PER_PUBDATA,\n            _factoryDeps,\n            msg.sender\n        );\n```\n\nTo:\n\n```\n        _zkSync.requestL2Transaction{value: _deployTransactionFee}(\n            L2_DEPLOYER_SYSTEM_CONTRACT_ADDR,\n            0,\n            abi.encodeCall(\n            IL2ContractDeployer.create2,\n            (bytes32(0), _bytecodeHash, _constructorData)\n        ),\n            DEPLOY_L2_BRIDGE_COUNTERPART_GAS_LIMIT,\n            REQUIRED_L2_GAS_PRICE_PER_PUBDATA,\n            _factoryDeps,\n            msg.sender\n        );\n```\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/reports/2023-10-zksync",
  "Code": [
    {
      "filename": "code/contracts/ethereum/contracts/bridge/libraries/BridgeInitializationHelper.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.13;\n\nimport \"../../zksync/interfaces/IZkSync.sol\";\nimport \"../../vendor/AddressAliasHelper.sol\";\nimport \"../../common/libraries/L2ContractHelper.sol\";\nimport {L2_DEPLOYER_SYSTEM_CONTRACT_ADDR} from \"../../common/L2ContractAddresses.sol\";\nimport \"../../common/interfaces/IL2ContractDeployer.sol\";\n\n/// @author Matter Labs\n/// @custom:security-contact security@matterlabs.dev\n/// @dev A helper library for initializing L2 bridges in zkSync L2 network.\nlibrary BridgeInitializationHelper {\n    /// @dev The L2 gas limit for requesting L1 -> L2 transaction of deploying L2 bridge instance.\n    /// @dev It is big enough to deploy any contract, so we can use the same value for all bridges.\n    /// NOTE: this constant will be accurately calculated in the future.\n    uint256 constant DEPLOY_L2_BRIDGE_COUNTERPART_GAS_LIMIT = $(DEPLOY_L2_BRIDGE_COUNTERPART_GAS_LIMIT);\n\n    /// @dev The default l2GasPricePerPubdata to be used in bridges.\n    uint256 constant REQUIRED_L2_GAS_PRICE_PER_PUBDATA = $(REQUIRED_L2_GAS_PRICE_PER_PUBDATA);\n\n    /// @notice Requests L2 transaction that will deploy a contract with a given bytecode hash and constructor data.\n    /// NOTE: it is always used to deploy via create2 with ZERO salt\n    /// @param _zkSync The address of the zkSync contract\n    /// @param _deployTransactionFee The fee that will be paid for the L1 -> L2 transaction\n    /// @param _bytecodeHash The hash of the bytecode of the contract to be deployed\n    /// @param _constructorData The data to be passed to the contract constructor\n    /// @param _factoryDeps A list of raw bytecodes that are needed for deployment\n    function requestDeployTransaction(\n        IZkSync _zkSync,\n        uint256 _deployTransactionFee,\n        bytes32 _bytecodeHash,\n        bytes memory _constructorData,\n        bytes[] memory _factoryDeps\n    ) internal returns (address deployedAddress) {\n        bytes memory deployCalldata = abi.encodeCall(\n            IL2ContractDeployer.create2,\n            (bytes32(0), _bytecodeHash, _constructorData)\n        );\n        _zkSync.requestL2Transaction{value: _deployTransactionFee}(\n            L2_DEPLOYER_SYSTEM_CONTRACT_ADDR,\n            0,\n            deployCalldata,\n            DEPLOY_L2_BRIDGE_COUNTERPART_GAS_LIMIT,\n            REQUIRED_L2_GAS_PRICE_PER_PUBDATA,\n            _factoryDeps,\n            msg.sender\n        );\n\n        deployedAddress = L2ContractHelper.computeCreate2Address(\n            // Apply the alias to the address of the bridge contract, to get the `msg.sender` in L2.\n            AddressAliasHelper.applyL1ToL2Alias(address(this)),\n            bytes32(0), // Zero salt\n            _bytecodeHash,\n            keccak256(_constructorData)\n        );\n    }\n}"
    }
  ]
}