{
  "Title": "[M-04] `LSP8Burnable` extension incorrectly inherits `LSP8IdentifiableDigitalAssetCore`",
  "Content": "\nThe `LSP8Burnable` contract inherits from `LSP8IdentifiableDigitalAssetCore`:\n\n[LSP8Burnable.sol#L15](https://github.com/code-423n4/2023-06-lukso/blob/main/contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8Burnable.sol#L15)\n\n```solidity\nabstract contract LSP8Burnable is LSP8IdentifiableDigitalAssetCore {\n```\n\nHowever, LSP8 extensions are supposed to inherit `LSP8IdentifiableDigitalAsset` instead. This can be inferred by looking at [`LSP8CappedSupply.sol`](https://github.com/code-423n4/2023-06-lukso/blob/main/contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8CappedSupply.sol), [`LSP8CompatibleERC721.sol`](https://github.com/code-423n4/2023-06-lukso/blob/main/contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8CompatibleERC721.sol) and [`LSP8Enumerable.sol`](https://github.com/code-423n4/2023-06-lukso/blob/main/contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8Enumerable.sol):\n\n[LSP8CappedSupply.sol#L13](https://github.com/code-423n4/2023-06-lukso/blob/main/contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8CappedSupply.sol#L13)\n\n```solidity\nabstract contract LSP8CappedSupply is LSP8IdentifiableDigitalAsset {\n```\n\nAdditionally, the `LSP8BurnableInitAbstract.sol` file is missing in the repository.\n\n### Impact\n\nAs `LSP8Burnable` does not inherit `LSP8IdentifiableDigitalAsset`, a developer who implements their LSP8 token using `LSP8Burnable` will face the following issues:\n\n*   All functionality from `LSP4DigitalAssetMetadata` will be unavailable.\n*   As `LSP8Burnable` does not contain a `supportsInterface()` function, it will be incompatible with contracts that use [ERC-165](https://eips.ethereum.org/EIPS/eip-165).\n\n### Recommended Mitigation\n\nThe `LSP8Burnable` contract should inherit `LSP8IdentifiableDigitalAsset` instead:\n\n[LSP8Burnable.sol#L15](https://github.com/code-423n4/2023-06-lukso/blob/main/contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8Burnable.sol#L15)\n\n```diff\n-   abstract contract LSP8Burnable is LSP8IdentifiableDigitalAssetCore {\n+   abstract contract LSP8Burnable is LSP8IdentifiableDigitalAsset {\n```\n\nSecondly, add a `LSP8BurnableInitAbstract.sol` file that contains an implementation of `LSP8Burnable` which can be used in proxies.\n\n**[CJ42 (LUKSO) confirmed](https://github.com/code-423n4/2023-06-lukso-findings/issues/120#issuecomment-1649867493)**\n\n***\n\n",
  "Impact": "MEDIUM",
  "Source": "https://code4rena.com/reports/2023-06-lukso",
  "Code": [
    {
      "filename": "contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8Burnable.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.4;\n\nimport {\n    LSP8IdentifiableDigitalAssetCore\n} from \"../LSP8IdentifiableDigitalAssetCore.sol\";\n\n// errors\nimport {LSP8NotTokenOperator} from \"../LSP8Errors.sol\";\n\n/**\n * @dev LSP8 extension that allows token holders to destroy both\n * their own tokens and those that they have an allowance for as an operator.\n */\nabstract contract LSP8Burnable is LSP8IdentifiableDigitalAssetCore {\n    function burn(bytes32 tokenId, bytes memory data) public {\n        if (!_isOperatorOrOwner(msg.sender, tokenId)) {\n            revert LSP8NotTokenOperator(tokenId, msg.sender);\n        }\n        _burn(tokenId, data);\n    }\n}"
    },
    {
      "filename": "contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8CappedSupply.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.4;\n\n// modules\nimport {\n    LSP8IdentifiableDigitalAsset\n} from \"../LSP8IdentifiableDigitalAsset.sol\";\n\n/**\n * @dev LSP8 extension, adds token supply cap.\n */\nabstract contract LSP8CappedSupply is LSP8IdentifiableDigitalAsset {\n    // --- Errors\n    error LSP8CappedSupplyRequired();\n    error LSP8CappedSupplyCannotMintOverCap();\n\n    // --- Storage\n    uint256 private immutable _tokenSupplyCap;\n\n    /**\n     * @notice Sets the token max supply\n     * @param tokenSupplyCap_ The Token max supply\n     */\n    constructor(uint256 tokenSupplyCap_) {\n        if (tokenSupplyCap_ == 0) {\n            revert LSP8CappedSupplyRequired();\n        }\n\n        _tokenSupplyCap = tokenSupplyCap_;\n    }\n\n    // --- Token queries\n\n    /**\n     * @dev Returns the number of tokens that can be minted.\n     * @return The token max supply\n     */\n    function tokenSupplyCap() public view virtual returns (uint256) {\n        return _tokenSupplyCap;\n    }\n\n    // --- Transfer functionality\n\n    /**\n     * @dev Mints `tokenId` and transfers it to `to`.\n     *\n     * Requirements:\n     *\n     * - `tokenSupplyCap() - totalSupply()` must be greater than zero.\n     * - `tokenId` must not exist.\n     * - `to` cannot be the zero address.\n     *\n     * Emits a {Transfer} event.\n     */\n    function _mint(\n        address to,\n        bytes32 tokenId,\n        bool allowNonLSP1Recipient,\n        bytes memory data\n    ) internal virtual override {\n        if (totalSupply() + 1 > tokenSupplyCap()) {\n            revert LSP8CappedSupplyCannotMintOverCap();\n        }\n\n        super._mint(to, tokenId, allowNonLSP1Recipient, data);\n    }\n}"
    },
    {
      "filename": "contracts/LSP8IdentifiableDigitalAsset/extensions/LSP8Burnable.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.4;\n\nimport {\n    LSP8IdentifiableDigitalAssetCore\n} from \"../LSP8IdentifiableDigitalAssetCore.sol\";\n\n// errors\nimport {LSP8NotTokenOperator} from \"../LSP8Errors.sol\";\n\n/**\n * @dev LSP8 extension that allows token holders to destroy both\n * their own tokens and those that they have an allowance for as an operator.\n */\nabstract contract LSP8Burnable is LSP8IdentifiableDigitalAssetCore {\n    function burn(bytes32 tokenId, bytes memory data) public {\n        if (!_isOperatorOrOwner(msg.sender, tokenId)) {\n            revert LSP8NotTokenOperator(tokenId, msg.sender);\n        }\n        _burn(tokenId, data);\n    }\n}"
    }
  ]
}