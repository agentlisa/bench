{
  "Title": "[M-04] [WP-M0] `MINTER_ROLE` can be granted by the deployer of L2LivepeerToken and mint arbitrary amount of tokens",
  "Content": "_Submitted by WatchPug_.\n\n<https://github.com/livepeer/arbitrum-lpt-bridge/blob/ebf68d11879c2798c5ec0735411b08d0bea4f287/contracts/L2/token/LivepeerToken.sol#L23-L30>\n\n```solidity\nfunction mint(address _to, uint256 _amount)\n    external\n    override\n    onlyRole(MINTER_ROLE)\n{\n    _mint(_to, _amount);\n    emit Mint(_to, _amount);\n}\n```\n\nUsing the `mint()` function of `L2LivepeerToken`, an address with `MINTER_ROLE` can burn an arbitrary amount of tokens.\n\nIf the private key of the deployer or an address with the `MINTER_ROLE` is compromised, the attacker will be able to mint an unlimited amount of LPT tokens.\n\nWe believe this is unnecessary and poses a serious centralization risk.\n\n#### Recommendation\n\nConsider removing the `MINTER_ROLE`, make the `L2LivepeerToken` only mintable by the owner, and make the L2Minter contract to be the owner and therefore the only minter.\n\n**[yondonfu (Livepeer) acknowledged](https://github.com/code-423n4/2022-01-livepeer-findings/issues/193#issuecomment-1019660423):**\n > Planning on keeping the role since the L2LPTGateway needs to be given minting rights as well in addition to the L2 Minter.\n\n\n\n",
  "Impact": "MEDIUM",
  "Source": "https://code4rena.com/reports/2022-01-livepeer",
  "Code": [
    {
      "filename": "contracts/L2/token/LivepeerToken.sol",
      "content": "//SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport {AccessControl} from \"@openzeppelin/contracts/access/AccessControl.sol\";\nimport {ERC20, ERC20Permit} from \"@openzeppelin/contracts/token/ERC20/extensions/draft-ERC20Permit.sol\";\nimport {ILivepeerToken} from \"./ILivepeerToken.sol\";\n\ncontract LivepeerToken is ILivepeerToken, AccessControl, ERC20Permit {\n    bytes32 public constant MINTER_ROLE = keccak256(\"MINTER_ROLE\");\n    bytes32 public constant BURNER_ROLE = keccak256(\"BURNER_ROLE\");\n\n    constructor() ERC20(\"Livepeer Token\", \"LPT\") ERC20Permit(\"Livepeer Token\") {\n        _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\n        _setRoleAdmin(MINTER_ROLE, DEFAULT_ADMIN_ROLE);\n        _setRoleAdmin(BURNER_ROLE, DEFAULT_ADMIN_ROLE);\n    }\n\n    /**\n     * @dev Function to mint tokens\n     * @param _to The address that will receive the minted tokens.\n     * @param _amount The amount of tokens to mint.\n     */\n    function mint(address _to, uint256 _amount)\n        external\n        override\n        onlyRole(MINTER_ROLE)\n    {\n        _mint(_to, _amount);\n        emit Mint(_to, _amount);\n    }\n\n    /**\n     * @dev Burns a specific amount of the sender's tokens\n     * @param _amount The amount of tokens to be burned\n     */\n    function burn(address _from, uint256 _amount)\n        external\n        override\n        onlyRole(BURNER_ROLE)\n    {\n        _burn(_from, _amount);\n        emit Burn(_from, _amount);\n    }\n}"
    }
  ]
}