{
  "Title": "[N-04] Check that none of the `authorities` is zero address",
  "Content": "The [`PartyFactory.createParty`](https://github.com/code-423n4/2023-04-party/blob/440aafacb0f15d037594cebc85fd471729bcb6d9/contracts/party/PartyFactory.sol#L18-L45) function should check that the `authorities` array contains addresses that are not the zero address.  \n\nI mention this because in the previous version of the `PartyFactory` contract, there was only one `authority` and it was checked to not be the zero address such as to ensure that governance NFTs can be minted:  \n\n[Link](https://github.com/PartyDAO/party-protocol/blob/3313c24c85d7429346af939897c19deeef7952f5/contracts/party/PartyFactory.sol#L33-L35)  \n```solidity\nif (authority == address(0)) {\n    revert InvalidAuthorityError(authority);\n}\n```\n\nHowever now it is only checked that the `authorities` array is not empty:  \n\n[Link](https://github.com/code-423n4/2023-04-party/blob/440aafacb0f15d037594cebc85fd471729bcb6d9/contracts/party/PartyFactory.sol#L26-L28)  \n```solidity\nif (authorities.length == 0) {\n    revert NoAuthorityError();\n}\n```\n\nI think you should check that there is no zero address in this array. The current check is not sufficient when compared to what has been checked previously. The current check is weaker.  \n\n**[0xble (Party) confirmed](https://github.com/code-423n4/2023-04-party-findings/issues/14#issuecomment-1515456383)**\n\n\n\n***\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2023-04-party",
  "Code": [
    {
      "filename": "contracts/party/PartyFactory.sol",
      "content": "// SPDX-License-Identifier: GPL-3.0\npragma solidity 0.8.17;\n\nimport \"../globals/IGlobals.sol\";\nimport \"../globals/LibGlobals.sol\";\nimport \"../tokens/IERC721.sol\";\nimport \"../utils/Proxy.sol\";\nimport \"../renderers/RendererStorage.sol\";\n\nimport \"./Party.sol\";\nimport \"./IPartyFactory.sol\";\n\n/// @notice Factory used to deploy new proxified `Party` instances.\ncontract PartyFactory is IPartyFactory {\n    error NoAuthorityError();\n\n    /// @inheritdoc IPartyFactory\n    function createParty(\n        Party partyImpl,\n        address[] memory authorities,\n        Party.PartyOptions memory opts,\n        IERC721[] memory preciousTokens,\n        uint256[] memory preciousTokenIds\n    ) external returns (Party party) {\n        // Ensure an authority is set to mint governance NFTs.\n        if (authorities.length == 0) {\n            revert NoAuthorityError();\n        }\n        // Deploy a new proxified `Party` instance.\n        Party.PartyInitData memory initData = Party.PartyInitData({\n            options: opts,\n            preciousTokens: preciousTokens,\n            preciousTokenIds: preciousTokenIds,\n            authorities: authorities\n        });\n        party = Party(\n            payable(\n                new Proxy(\n                    Implementation(address(partyImpl)),\n                    abi.encodeCall(Party.initialize, (initData))\n                )\n            )\n        );\n        emit PartyCreated(party, opts, preciousTokens, preciousTokenIds, msg.sender);\n    }\n}"
    },
    {
      "filename": "contracts/party/PartyFactory.sol",
      "content": "// SPDX-License-Identifier: GPL-3.0\npragma solidity 0.8.17;\n\nimport \"../globals/IGlobals.sol\";\nimport \"../globals/LibGlobals.sol\";\nimport \"../tokens/IERC721.sol\";\nimport \"../utils/Proxy.sol\";\nimport \"../renderers/RendererStorage.sol\";\n\nimport \"./Party.sol\";\nimport \"./IPartyFactory.sol\";\n\n/// @notice Factory used to deploy new proxified `Party` instances.\ncontract PartyFactory is IPartyFactory {\n    error InvalidAuthorityError(address authority);\n\n    /// @inheritdoc IPartyFactory\n    IGlobals public immutable GLOBALS;\n\n    // Set the `Globals` contract.\n    constructor(IGlobals globals) {\n        GLOBALS = globals;\n    }\n\n    /// @inheritdoc IPartyFactory\n    function createParty(\n        address authority,\n        Party.PartyOptions memory opts,\n        IERC721[] memory preciousTokens,\n        uint256[] memory preciousTokenIds\n    ) external returns (Party party) {\n        // Ensure a valid authority is set to mint governance NFTs.\n        if (authority == address(0)) {\n            revert InvalidAuthorityError(authority);\n        }\n        // Deploy a new proxified `Party` instance.\n        Party.PartyInitData memory initData = Party.PartyInitData({\n            options: opts,\n            preciousTokens: preciousTokens,\n            preciousTokenIds: preciousTokenIds,\n            mintAuthority: authority\n        });\n        party = Party(\n            payable(\n                new Proxy(\n                    GLOBALS.getImplementation(LibGlobals.GLOBAL_PARTY_IMPL),\n                    abi.encodeCall(Party.initialize, (initData))\n                )\n            )\n        );\n        emit PartyCreated(party, opts, preciousTokens, preciousTokenIds, msg.sender);\n    }\n}"
    },
    {
      "filename": "contracts/party/PartyFactory.sol",
      "content": "// SPDX-License-Identifier: GPL-3.0\npragma solidity 0.8.17;\n\nimport \"../globals/IGlobals.sol\";\nimport \"../globals/LibGlobals.sol\";\nimport \"../tokens/IERC721.sol\";\nimport \"../utils/Proxy.sol\";\nimport \"../renderers/RendererStorage.sol\";\n\nimport \"./Party.sol\";\nimport \"./IPartyFactory.sol\";\n\n/// @notice Factory used to deploy new proxified `Party` instances.\ncontract PartyFactory is IPartyFactory {\n    error NoAuthorityError();\n\n    /// @inheritdoc IPartyFactory\n    function createParty(\n        Party partyImpl,\n        address[] memory authorities,\n        Party.PartyOptions memory opts,\n        IERC721[] memory preciousTokens,\n        uint256[] memory preciousTokenIds\n    ) external returns (Party party) {\n        // Ensure an authority is set to mint governance NFTs.\n        if (authorities.length == 0) {\n            revert NoAuthorityError();\n        }\n        // Deploy a new proxified `Party` instance.\n        Party.PartyInitData memory initData = Party.PartyInitData({\n            options: opts,\n            preciousTokens: preciousTokens,\n            preciousTokenIds: preciousTokenIds,\n            authorities: authorities\n        });\n        party = Party(\n            payable(\n                new Proxy(\n                    Implementation(address(partyImpl)),\n                    abi.encodeCall(Party.initialize, (initData))\n                )\n            )\n        );\n        emit PartyCreated(party, opts, preciousTokens, preciousTokenIds, msg.sender);\n    }\n}"
    }
  ]
}