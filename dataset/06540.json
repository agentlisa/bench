{
  "Title": "[11] VULNERABILITIES IN VERSION 4.7.3 OF `@openzeppelin/contracts` AND `@openzeppelin/contracts-upgradeable`",
  "Content": "As shown in the following code in `package.json`, version 4.7.3 of `@openzeppelin/contracts` and `@openzeppelin/contracts-upgradeable` are used. As described in https://security.snyk.io/package/npm/@openzeppelin%2Fcontracts/4.7.3 and https://security.snyk.io/package/npm/@openzeppelin%2Fcontracts-upgradeable/4.7.3, this version of `@openzeppelin/contracts` and `@openzeppelin/contracts-upgradeable` has the Missing Authorization, DOS, and Improper Input Validation vulnerabilities. To reduce the potential attack surface and be more future-proofed, please consider upgrading these packages to at least version 4.9.1.\n\nhttps://github.com/ethereum-optimism/optimism/blob/086d7fb67d2b7e0d1a31042e3772eac0649bfcb9/packages/contracts-bedrock/package.json#L55-L61\n```solidity\n  \"dependencies\": {\n    ...\n    \"@openzeppelin/contracts\": \"4.7.3\",\n    \"@openzeppelin/contracts-upgradeable\": \"4.7.3\",\n    ...\n  },\n```\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2023-05-base",
  "Code": [
    {
      "filename": "packages/contracts-bedrock/package.json",
      "content": "{\n  \"name\": \"@eth-optimism/contracts-bedrock\",\n  \"version\": \"0.13.2\",\n  \"description\": \"Contracts for Optimism Specs\",\n  \"main\": \"dist/index\",\n  \"types\": \"dist/index\",\n  \"license\": \"MIT\",\n  \"files\": [\n    \"dist/**/*.js\",\n    \"dist/**/*.d.ts\",\n    \"dist/types/**/*.ts\",\n    \"artifacts/contracts/**/*.json\",\n    \"deployments/**/*.json\",\n    \"contracts/**/*.sol\"\n  ],\n  \"scripts\": {\n    \"bindings\": \"cd ../../op-bindings && make\",\n    \"build:forge\": \"forge build\",\n    \"build:with-metadata\": \"FOUNDRY_PROFILE=echidna yarn build:forge\",\n    \"build:differential\": \"go build -o ./scripts/differential-testing/differential-testing ./scripts/differential-testing\",\n    \"build:fuzz\": \"(cd test-case-generator && go build ./cmd/fuzz.go)\",\n    \"prebuild\": \"yarn ts-node scripts/verify-foundry-install.ts\",\n    \"build\": \"hardhat compile && yarn autogen:artifacts && yarn build:ts && yarn typechain\",\n    \"build:ts\": \"tsc -p tsconfig.build.json\",\n    \"autogen:artifacts\": \"ts-node scripts/generate-artifacts.ts\",\n    \"autogen:invariant-docs\": \"ts-node scripts/invariant-doc-gen.ts\",\n    \"deploy\": \"hardhat deploy\",\n    \"test\": \"yarn build:differential && yarn build:fuzz && forge test\",\n    \"coverage\": \"yarn build:differential && yarn build:fuzz && forge coverage\",\n    \"coverage:lcov\": \"yarn build:differential && yarn build:fuzz && forge coverage --report lcov\",\n    \"gas-snapshot\": \"yarn build:differential && yarn build:fuzz && forge snapshot --no-match-test 'testDiff|testFuzz|invariant|generateArtifact'\",\n    \"storage-snapshot\": \"./scripts/storage-snapshot.sh\",\n    \"validate-deploy-configs\": \"hardhat compile && hardhat generate-deploy-config && ./scripts/validate-deploy-configs.sh\",\n    \"validate-spacers\": \"hardhat compile && hardhat validate-spacers\",\n    \"slither\": \"./scripts/slither.sh\",\n    \"slither:triage\": \"TRIAGE_MODE=1 ./scripts/slither.sh\",\n    \"clean\": \"rm -rf ./dist ./artifacts ./forge-artifacts ./cache ./tsconfig.tsbuildinfo ./tsconfig.build.tsbuildinfo ./src/contract-artifacts.ts ./test-case-generator/fuzz\",\n    \"lint:ts:check\": \"eslint . --max-warnings=0\",\n    \"lint:forge-tests:check\": \"ts-node scripts/forge-test-names.ts\",\n    \"lint:contracts:check\": \"yarn solhint -f table 'contracts/**/*.sol' && yarn prettier --check 'contracts/**/*.sol' && yarn lint:forge-tests:check\",\n    \"lint:check\": \"yarn lint:contracts:check && yarn lint:ts:check\",\n    \"lint:ts:fix\": \"eslint --fix .\",\n    \"lint:contracts:fix\": \"yarn solhint --fix 'contracts/**/*.sol' && yarn prettier --write 'contracts/**/*.sol'\",\n    \"lint:fix\": \"yarn lint:contracts:fix && yarn lint:ts:fix\",\n    \"lint\": \"yarn lint:fix && yarn lint:check\",\n    \"typechain\": \"typechain --target ethers-v5 --out-dir dist/types --glob 'artifacts/!(build-info)/**/+([a-zA-Z0-9_]).json'\",\n    \"echidna:aliasing\": \"echidna-test --contract EchidnaFuzzAddressAliasing --config ./echidna.yaml .\",\n    \"echidna:burn:gas\": \"echidna-test --contract EchidnaFuzzBurnGas --config ./echidna.yaml .\",\n    \"echidna:burn:eth\": \"echidna-test --contract EchidnaFuzzBurnEth --config ./echidna.yaml .\",\n    \"echidna:encoding\": \"echidna-test --contract EchidnaFuzzEncoding --config ./echidna.yaml .\",\n    \"echidna:portal\": \"echidna-test --contract EchidnaFuzzOptimismPortal --config ./echidna.yaml .\",\n    \"echidna:hashing\": \"echidna-test --contract EchidnaFuzzHashing --config ./echidna.yaml .\",\n    \"echidna:metering\": \"echidna-test --contract EchidnaFuzzResourceMetering --config ./echidna.yaml .\"\n  },\n  \"dependencies\": {\n    \"@eth-optimism/core-utils\": \"^0.12.0\",\n    \"@openzeppelin/contracts\": \"4.7.3\",\n    \"@openzeppelin/contracts-upgradeable\": \"4.7.3\",\n    \"ethers\": \"^5.7.0\",\n    \"hardhat\": \"^2.9.6\"\n  },\n  \"devDependencies\": {\n    \"@eth-optimism/hardhat-deploy-config\": \"^0.2.6\",\n    \"@ethersproject/abstract-provider\": \"^5.7.0\",\n    \"@ethersproject/abstract-signer\": \"^5.7.0\",\n    \"ethereumjs-wallet\": \"^1.0.2\",\n    \"@defi-wonderland/smock\": \"^2.0.2\",\n    \"@foundry-rs/hardhat-forge\": \"^0.1.17\",\n    \"@foundry-rs/easy-foundryup\": \"^0.1.3\",\n    \"@nomiclabs/hardhat-ethers\": \"^2.0.0\",\n    \"@nomiclabs/hardhat-waffle\": \"^2.0.0\",\n    \"@rari-capital/solmate\": \"https://github.com/rari-capital/solmate.git#8f9b23f8838670afda0fd8983f2c41e8037ae6bc\",\n    \"clones-with-immutable-args\": \"https://github.com/Saw-mon-and-Natalie/clones-with-immutable-args.git#105efee1b9127ed7f6fedf139e1fc796ce8791f2\",\n    \"@typechain/ethers-v5\": \"^10.1.0\",\n    \"@typescript-eslint/eslint-plugin\": \"^5.45.1\",\n    \"@typescript-eslint/parser\": \"^5.45.1\",\n    \"bip39\": \"^3.0.4\",\n    \"chai\": \"^4.2.0\",\n    \"command-exists\": \"1.2.9\",\n    \"dotenv\": \"^16.0.0\",\n    \"ds-test\": \"https://github.com/dapphub/ds-test.git#9310e879db8ba3ea6d5c6489a579118fd264a3f5\",\n    \"ethereum-waffle\": \"^3.0.0\",\n    \"forge-std\": \"https://github.com/foundry-rs/forge-std.git#46264e9788017fc74f9f58b7efa0bc6e1df6d410\",\n    \"glob\": \"^7.1.6\",\n    \"hardhat-deploy\": \"^0.11.4\",\n    \"solhint\": \"^3.3.7\",\n    \"solhint-plugin-prettier\": \"^0.0.5\",\n    \"ts-node\": \"^10.9.1\",\n    \"typechain\": \"^8.1.0\",\n    \"typescript\": \"^4.9.3\"\n  }\n}"
    }
  ]
}