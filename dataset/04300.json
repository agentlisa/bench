{
  "Title": "AMM - Unchecked return value in ShareToken.mint Â Pending",
  "Content": "\n\n#### Resolution\n\n\n\nThis issue was addressed by adding checks to `mintShareTokenTo` verifying its return value. In addition, the signature for `ShareToken.burn` was changed to also return an error indicator. The assessment team would like to note that this deviates from the openzeppelin implementation which (a) does not return an error indication but throws instead, (b) burns the callers token on calls to `burn` while this implementation more behaves like a `burnFrom`.\n\n\n#### Description\n\n\n`ShareToken` is an extension of the Openzeppelin [ERC20Mintable](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v2.5.1/contracts/token/ERC20/ERC20Mintable.sol#L20-L23) pattern which exposes a method called `mint()` that allows accounts owning the minter role to mint new tokens. The return value of `ShareToken.mint()` is not checked.\n\n\nSince the ERC20 standard does not define whether this method should return a value or revert it may be problematic to assume that all tokens revert. If, for example, an implementation is used that does not revert on error but returns a boolean error indicator instead the caller might falsely continue without the token minted.\n\n\nWe would like to note that the functionality is intended to be used with the provided `ShareToken` and therefore the contract is safe to use assuming `ERC20Mintable.mint` reverts on error. The issue arises if the system is used with a different `ShareToken` implementation that is not implemented in the same way.\n\n\n#### Examples\n\n\n* Openzeppelin implementation\n\n\n\n```\nfunction mint(address account, uint256 amount) public onlyMinter returns (bool) {\n    \\_mint(account, amount);\n    return true;\n}\n\n```\n* Call with unchecked return value\n\n\n**code/contracts/liquidity/AMM.sol:L499-L502**\n\n\n\n```\n\nfunction mintShareTokenTo(address guy, uint256 amount) internal {\n    shareToken.mint(guy, amount);\n}\n\n```\n#### Recommendation\n\n\nConsider wrapping the `mint` statement in a `require` clause, however, this way only tokens that are returning a boolean error indicator are supported. Document the specification requirements for the `ShareToken` and clearly state if the token is expected to revert or return an error indicator.\n\n\nIt should also be documented that the Token exposes a `burn` method that does not adhere to the Openzeppelin `ERC20Burnable` implementation. The `ERC20Burnable` import is unused as noted in [issue 6.23](#unused-imports).\n\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/token/ERC20/ERC20Mintable.sol",
      "content": "pragma solidity ^0.5.0;\n\nimport \"./ERC20.sol\";\nimport \"../../access/roles/MinterRole.sol\";\n\n/**\n * @dev Extension of {ERC20} that adds a set of accounts with the {MinterRole},\n * which have permission to mint (create) new tokens as they see fit.\n *\n * At construction, the deployer of the contract is the only minter.\n */\ncontract ERC20Mintable is ERC20, MinterRole {\n    /**\n     * @dev See {ERC20-_mint}.\n     *\n     * Requirements:\n     *\n     * - the caller must have the {MinterRole}.\n     */\n    function mint(address account, uint256 amount) public onlyMinter returns (bool) {\n        _mint(account, amount);\n        return true;\n    }\n}"
    }
  ]
}