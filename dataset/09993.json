{
  "Title": "[M-31] execute in VoteProxy should be payable",
  "Content": "_Submitted by wuwe1_\n\n`execute` will revert when `msg.value > 0`\n\n### Proof of Concept\n\nLacking `payable` mutability specifier.\n\n[VoteProxy.sol#L28-L35](https://github.com/code-423n4/2022-02-concur/blob/main/contracts/VoteProxy.sol#L28-L35)<br>\n\n```solidity\n    function execute(\n        address _to,\n        uint256 _value,\n        bytes calldata _data\n    ) external onlyOwner returns (bool, bytes memory) {\n        (bool success, bytes memory result) = _to.call{value: _value}(_data);\n        return (success, result);\n    }\n```\n\n### Recommended Mitigation Steps\n\nAdd `payable` mutability specifier.\n\n**[leekt (Concur) confirmed](https://github.com/code-423n4/2022-02-concur-findings/issues/17)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-02-concur-findings/issues/17#issuecomment-1095728527):**\n > @leekt Can you tell me what you'd need [`execute`](https://github.com/code-423n4/2022-02-concur/blob/72b5216bfeaa7c52983060ebfc56e72e0aa8e3b0/contracts/VoteProxy.sol#L28) to be used for?\n> \n> Do you really need it to be payable?\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-02-concur-findings/issues/17#issuecomment-1103158805):**\n > After some thinking, I do believe that it would be wise to allow for payable calls.\n> \n> Will mark as valid and because this is contingent on a specific usage, I think Medium Severity to be appropriate.\n\n\n\n***\n\n\n\n",
  "Impact": "MEDIUM",
  "Source": "https://code4rena.com/contests/2022-02-concur-finance-contest",
  "Code": [
    {
      "filename": "contracts/VoteProxy.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.11;\n\nimport \"@openzeppelin/contracts/access/Ownable.sol\";\nimport \"./interfaces/Iauction.sol\";\n\ncontract VoteProxy is Ownable {\n    Iauction public auctioneer;\n\n    function updateAuctioneer(address _auctioneer) external onlyOwner {\n        auctioneer = Iauction(_auctioneer);\n    }\n\n    function isValidSignature(bytes32 _hash, bytes calldata _signature)\n        external\n        view\n        returns (bytes4)\n    {\n        // Validate signatures\n        if (auctioneer.isWinningSignature(_hash, _signature) == true) {\n            return 0x1626ba7e;\n        } else {\n            return 0xffffffff;\n        }\n    }\n\n    function execute(\n        address _to,\n        uint256 _value,\n        bytes calldata _data\n    ) external onlyOwner returns (bool, bytes memory) {\n        (bool success, bytes memory result) = _to.call{value: _value}(_data);\n        return (success, result);\n    }\n}"
    },
    {
      "filename": "contracts/VoteProxy.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.11;\n\nimport \"@openzeppelin/contracts/access/Ownable.sol\";\nimport \"./interfaces/Iauction.sol\";\n\ncontract VoteProxy is Ownable {\n    Iauction public auctioneer;\n\n    function updateAuctioneer(address _auctioneer) external onlyOwner {\n        auctioneer = Iauction(_auctioneer);\n    }\n\n    function isValidSignature(bytes32 _hash, bytes calldata _signature)\n        external\n        view\n        returns (bytes4)\n    {\n        // Validate signatures\n        if (auctioneer.isWinningSignature(_hash, _signature) == true) {\n            return 0x1626ba7e;\n        } else {\n            return 0xffffffff;\n        }\n    }\n\n    function execute(\n        address _to,\n        uint256 _value,\n        bytes calldata _data\n    ) external onlyOwner returns (bool, bytes memory) {\n        (bool success, bytes memory result) = _to.call{value: _value}(_data);\n        return (success, result);\n    }\n}"
    }
  ]
}