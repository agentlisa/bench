{
  "Title": "[G-03] Multiple `address` mappings can be combined into a single `mapping` of an `address` to a `struct`, where appropriate",
  "Content": "\nSaves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (20000 gas) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: smart-contracts/CollateralAdapter.sol   #1\n\n27      mapping(address => address) internal _assetToVaults;\n28      // External collateral asset -> internal collateral asset\n29:     mapping(address => address) internal _collateralAssets;\n```\n\n<https://github.com/code-423n4/2022-05-sturdy/blob/78f51a7a74ebe8adfd055bdbaedfddc05632566f/smart-contracts/CollateralAdapter.sol#L27-L29>\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/contests/2022-05-sturdy-contest",
  "Code": [
    {
      "filename": "smart-contracts/CollateralAdapter.sol",
      "content": "// SPDX-License-Identifier: agpl-3.0\npragma solidity 0.6.12;\npragma experimental ABIEncoderV2;\n\nimport {Errors} from '../libraries/helpers/Errors.sol';\nimport {ILendingPool} from '../../interfaces/ILendingPool.sol';\nimport {VersionedInitializable} from '../../protocol/libraries/sturdy-upgradeability/VersionedInitializable.sol';\nimport {ILendingPoolAddressesProvider} from '../../interfaces/ILendingPoolAddressesProvider.sol';\n\n/**\n * @title CollateralAdapter\n * @notice CollateralToVault mapping adapter\n * @author Sturdy\n **/\n\ncontract CollateralAdapter is VersionedInitializable {\n  modifier onlyAdmin() {\n    require(_addressesProvider.getPoolAdmin() == msg.sender, Errors.CALLER_NOT_POOL_ADMIN);\n    _;\n  }\n\n  uint256 public constant VAULT_REVISION = 0x1;\n\n  ILendingPoolAddressesProvider internal _addressesProvider;\n\n  // External collateral asset -> vault\n  mapping(address => address) internal _assetToVaults;\n  // External collateral asset -> internal collateral asset\n  mapping(address => address) internal _collateralAssets;\n\n  /**\n   * @dev Function is invoked by the proxy contract when the Adapter contract is deployed.\n   * @param _provider The address of the provider\n   **/\n  function initialize(ILendingPoolAddressesProvider _provider) public initializer {\n    _addressesProvider = _provider;\n  }\n\n  function getRevision() internal pure override returns (uint256) {\n    return VAULT_REVISION;\n  }\n\n  function addCollateralAsset(\n    address _externalAsset,\n    address _internalAsset,\n    address _acceptVault\n  ) external onlyAdmin {\n    _assetToVaults[_externalAsset] = _acceptVault;\n    _collateralAssets[_externalAsset] = _internalAsset;\n  }\n\n  function getAcceptableVault(address _externalAsset) external view returns (address) {\n    return _assetToVaults[_externalAsset];\n  }\n\n  function getInternalCollateralAsset(address _externalAsset) external view returns (address) {\n    return _collateralAssets[_externalAsset];\n  }\n}"
    }
  ]
}