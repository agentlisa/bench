{
  "Title": "[L01] BOND_MAX_RATE_PER_DAY doesn’t cap bond rates at 30% as intended",
  "Content": "The [`BOND_MAX_RATE_PER_DAY` variable](https://github.com/BarnBridge/BarnBridge-SmartYieldBonds/blob/943df3a8fcd8dd128af3beb0c85a0480c0e95ead/contracts/IController.sol#L26) places [an upper bound on](https://github.com/BarnBridge/BarnBridge-SmartYieldBonds/blob/943df3a8fcd8dd128af3beb0c85a0480c0e95ead/contracts/SmartYield.sol#L351) the daily interest rate that an oracle can report for an underlying pool. The inline comment alongside this variable states the initial rate assignment should be equal to “APY ~30% / year”. However, the calculation used to set this initial value, i.e., `3 * 49201150733 * 5760`, translates to approximately 36.4% APY. Even though the second part of that computation, `49201150733 * 5760`, would yield an approximately 10% APY, due to compounding, the relationship between this max rate and the resultant APY is superlinear. Consider reconciling the code and comment to avoid any confusion and to clarify intent.\n\n\n**Update**: *Fixed in commit [`e6ac08cfbe0ab1eb0f682927a11f7e0a5bf20a6b`](https://github.com/BarnBridge/BarnBridge-SmartYieldBonds/commit/e6ac08cfbe0ab1eb0f682927a11f7e0a5bf20a6b). The referenced commit includes other changes to the codebase which have not been reviewed by OpenZeppelin.*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/IController.sol",
      "content": "// SPDX-License-Identifier: Apache-2.0\npragma solidity ^0.7.6;\npragma abicoder v2;\n\nimport \"./Governed.sol\";\n\ncontract IController is Governed {\n\n    address public oracle; // IYieldOracle\n\n    address public bondModel; // IBondModel\n\n    address public feesOwner; // fees are sent here\n\n    // reward for calling harvest 3%\n    uint256 public HARVEST_REWARD = 3 * 1e16; // 3%\n\n    // fee for buying jTokens\n    uint256 public FEE_BUY_JUNIOR_TOKEN = 3 * 1e16; // 3%\n\n    // fee for redeeming a sBond\n    uint256 public FEE_REDEEM_SENIOR_BOND = 3 * 1e16; // 3%\n\n    // max rate per day for sBonds\n    // k * supplyRatePerBlock * blocksPerDay\n    uint256 public BOND_MAX_RATE_PER_DAY = 3 * 49201150733 * 5760; // APY ~30% / year\n\n    // max duration of a purchased sBond\n    uint16 public BOND_LIFE_MAX = 90; // in days\n\n    bool public PAUSED_BUY_JUNIOR_TOKEN = false;\n\n    bool public PAUSED_BUY_SENIOR_BOND = false;\n\n    constructor() Governed() { }\n\n    function setHarvestReward(uint256 newValue_)\n      public\n      onlyDaoOrGuardian\n    {\n        HARVEST_REWARD = newValue_;\n    }\n\n    function setBondMaxRatePerDay(uint256 newVal_)\n      external\n      onlyDaoOrGuardian\n    {\n      BOND_MAX_RATE_PER_DAY = newVal_;\n    }\n\n    function setBondLifeMax(uint16 newVal_)\n      external\n      onlyDaoOrGuardian\n    {\n      BOND_LIFE_MAX = newVal_;\n    }\n\n    function setFeeBuyJuniorToken(uint256 newVal_)\n      external\n      onlyDaoOrGuardian\n    {\n      FEE_BUY_JUNIOR_TOKEN = newVal_;\n    }\n\n    function setFeeRedeemSeniorBond(uint256 newVal_)\n      external\n      onlyDaoOrGuardian\n    {\n      FEE_REDEEM_SENIOR_BOND = newVal_;\n    }\n\n    function setPaused(bool buyJToken_, bool buySBond_)\n      external\n      onlyDaoOrGuardian\n    {\n      PAUSED_BUY_JUNIOR_TOKEN = buyJToken_;\n      PAUSED_BUY_SENIOR_BOND = buySBond_;\n    }\n\n    function setOracle(address newVal_)\n      external\n      onlyDaoOrGuardian\n    {\n      oracle = newVal_;\n    }\n\n    function setBondModel(address newVal_)\n      external\n      onlyDaoOrGuardian\n    {\n      bondModel = newVal_;\n    }\n\n    function setFeesOwner(address newVal_)\n      external\n      onlyDaoOrGuardian\n    {\n      feesOwner = newVal_;\n    }\n}"
    }
  ]
}