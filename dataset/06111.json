{
  "Title": "[N-09] Redundant Inheritance",
  "Content": "- Severity: Non-Critical\n- Confidence: High\n\n### Description\nDetects when a contract inherits from another contract that it already indirectly inherits from.\n\n<details>\n\n<summary>\nThere are 1 instances of this issue:\n\n</summary>\n\n###\n- File: solidity/contracts/core/WUSDA.sol\n```\n \nLine: 28          contract WUSDA is IWUSDA, ERC20, ERC20Permit \n```\n The contract `WUSDA` has redundant inheritance: `ERC20` is already inherited indirectly.\n\n[https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/core/WUSDA.sol#L28-L257](https://github.com/code-423n4/2023-07-amphora/blob/main/core/solidity/contracts/core/WUSDA.sol#L28-L257)\n\n</details>\n\n**[0xShaito (Amphora) confirmed](https://github.com/code-423n4/2023-07-amphora-findings/issues/382#issuecomment-1667529356)**\n\n\n\n***\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2023-07-amphora",
  "Code": [
    {
      "filename": "core/solidity/contracts/core/WUSDA.sol",
      "content": "// SPDX-License-Identifier: GPL-3.0-or-later\npragma solidity ^0.8.9;\n\nimport {IWUSDA} from '@interfaces/core/IWUSDA.sol';\n\nimport {SafeERC20} from '@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol';\nimport {ERC20, IERC20} from '@openzeppelin/contracts/token/ERC20/ERC20.sol';\n// solhint-disable-next-line max-line-length\nimport {ERC20Permit} from '@openzeppelin/contracts/token/ERC20/extensions/draft-ERC20Permit.sol';\n\n/**\n * @title wUSDA (Wrapped usda).\n *\n * @notice A fixed-balance ERC-20 wrapper for the usda rebasing token.\n *\n *      Users deposit usda into this contract and are minted wUSDA.\n *\n *      Each account's wUSDA balance represents the fixed percentage ownership\n *      of usda's market cap.\n *\n *      For exusdae: 100K wUSDA => 1% of the usda market cap\n *        when the usda supply is 100M, 100K wUSDA will be redeemable for 1M usda\n *        when the usda supply is 500M, 100K wUSDA will be redeemable for 5M usda\n *        and so on.\n *\n *      We call wUSDA the 'wrapper' token and usda the 'underlying' or 'wrapped' token.\n */\ncontract WUSDA is IWUSDA, ERC20, ERC20Permit {\n  using SafeERC20 for IERC20;\n\n  //--------------------------------------------------------------------------\n  // Constants\n\n  /// @notice The maximum wUSDA supply.\n  uint256 public constant MAX_wUSDA_SUPPLY = 10_000_000 * (10 ** 18); // 10 M\n\n  //--------------------------------------------------------------------------\n  // Attributes\n\n  /// @notice The reference to the usda token.\n  address public immutable USDA;\n\n  //--------------------------------------------------------------------------\n\n  /// @param _usdaToken The usda ERC20 token address.\n  /// @param _name The wUSDA ERC20 name.\n  /// @param _symbol The wUSDA ERC20 symbol.\n  constructor(address _usdaToken, string memory _name, string memory _symbol) ERC20(_name, _symbol) ERC20Permit(_name) {\n    USDA = _usdaToken;\n  }\n\n  //--------------------------------------------------------------------------\n  // wUSDA write methods\n\n  /// @notice Transfers usda amount from {msg.sender} and mints wusda amount.\n  ///\n  /// @param _wusdaAmount The amount of wusda to mint.\n  /// @return _usdaAmount The amount of usda deposited.\n  function mint(uint256 _wusdaAmount) external override returns (uint256 _usdaAmount) {\n    _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _deposit(_msgSender(), _msgSender(), _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Transfers usda amount from {msg.sender} and mints wusda amount,\n  ///         to the specified beneficiary.\n  ///\n  /// @param _to The beneficiary wallet.\n  /// @param _wusdaAmount The amount of wusda to mint.\n  /// @return _usdaAmount The amount of usda deposited.\n  function mintFor(address _to, uint256 _wusdaAmount) external override returns (uint256 _usdaAmount) {\n    _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _deposit(_msgSender(), _to, _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns wusda from {msg.sender} and transfers usda amount back.\n  ///\n  /// @param _wusdaAmount The amount of _wusdaAmount to burn.\n  /// @return _usdaAmount The amount of usda withdrawn.\n  function burn(uint256 _wusdaAmount) external override returns (uint256 _usdaAmount) {\n    _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _msgSender(), _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns wusda amount from {msg.sender} and transfers usda amount back,\n  ///         to the specified beneficiary.\n  ///\n  /// @param _to The beneficiary wallet.\n  /// @param _wusdaAmount The amount of _wusdaAmount to burn.\n  /// @return _usdaAmount The amount of _usdaAmount withdrawn.\n  function burnTo(address _to, uint256 _wusdaAmount) external override returns (uint256 _usdaAmount) {\n    _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _to, _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns all wusda from {msg.sender} and transfers usda back.\n  ///\n  /// @return _usdaAmount The amount of usda withdrawn.\n  function burnAll() external override returns (uint256 _usdaAmount) {\n    uint256 _wusdaAmount = balanceOf(_msgSender());\n    _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _msgSender(), _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns all wusda from {msg.sender} and transfers usda back,\n  ///         to the specified beneficiary.\n  ///\n  /// @param _to The beneficiary wallet.\n  /// @return _usdaAmount The amount of _usdaAmount withdrawn.\n  function burnAllTo(address _to) external override returns (uint256 _usdaAmount) {\n    uint256 _wusdaAmount = balanceOf(_msgSender());\n    _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _to, _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Transfers usda amount from {msg.sender} and mints wusda amount.\n  ///\n  /// @param _usdaAmount The amount of _usdaAmount to deposit.\n  /// @return _wusdaAmount The amount of _wusdaAmount minted.\n  function deposit(uint256 _usdaAmount) external override returns (uint256 _wusdaAmount) {\n    _wusdaAmount = _usdaToWUSDA(_usdaAmount, _usdaSupply());\n    _deposit(_msgSender(), _msgSender(), _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Transfers usda amount from {msg.sender} and mints wusda amount,\n  ///         to the specified beneficiary.\n  ///\n  /// @param _to The beneficiary wallet.\n  /// @param _usdaAmount The amount of _usdaAmount to deposit.\n  /// @return _wusdaAmount The amount of _wusdaAmount minted.\n  function depositFor(address _to, uint256 _usdaAmount) external override returns (uint256 _wusdaAmount) {\n    _wusdaAmount = _usdaToWUSDA(_usdaAmount, _usdaSupply());\n    _deposit(_msgSender(), _to, _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns wusda amount from {msg.sender} and transfers usda amount back.\n  ///\n  /// @param _usdaAmount The amount of _usdaAmount to withdraw.\n  /// @return _wusdaAmount The amount of burnt _wusdaAmount.\n  function withdraw(uint256 _usdaAmount) external override returns (uint256 _wusdaAmount) {\n    _wusdaAmount = _usdaToWUSDA(_usdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _msgSender(), _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns wusda amount from {msg.sender} and transfers usda amount back,\n  ///         to the specified beneficiary.\n  ///\n  /// @param _to The beneficiary wallet.\n  /// @param _usdaAmount The amount of _usdaAmount to withdraw.\n  /// @return _wusdaAmount The amount of burnt _wusdaAmount.\n  function withdrawTo(address _to, uint256 _usdaAmount) external override returns (uint256 _wusdaAmount) {\n    _wusdaAmount = _usdaToWUSDA(_usdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _to, _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns all wusda from {msg.sender} and transfers usda amount back.\n  ///\n  /// @return _wusdaAmount The amount of burnt.\n  function withdrawAll() external override returns (uint256 _wusdaAmount) {\n    _wusdaAmount = balanceOf(_msgSender());\n    uint256 _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _msgSender(), _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Burns all wusda from {msg.sender} and transfers usda amount back,\n  ///         to the specified beneficiary.\n  ///\n  /// @param _to The beneficiary wallet.\n  /// @return _wusdaAmount The amount of burnt.\n  function withdrawAllTo(address _to) external override returns (uint256 _wusdaAmount) {\n    _wusdaAmount = balanceOf(_msgSender());\n    uint256 _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n    _withdraw(_msgSender(), _to, _usdaAmount, _wusdaAmount);\n  }\n\n  //--------------------------------------------------------------------------\n  // wUSDA view methods\n\n  /// @return _usdaAddress The address of the underlying 'wrapped' token ie) usda.\n  function underlying() external view override returns (address _usdaAddress) {\n    _usdaAddress = USDA;\n  }\n\n  /// @return _usdaAmount The total _usdaAmount held by this contract.\n  function totalUnderlying() external view override returns (uint256 _usdaAmount) {\n    _usdaAmount = _wUSDAToUSDA(totalSupply(), _usdaSupply());\n  }\n\n  /// @param _owner The account address.\n  /// @return _redeemableUSDA The usda balance redeemable by the owner.\n  function balanceOfUnderlying(address _owner) external view override returns (uint256 _redeemableUSDA) {\n    _redeemableUSDA = _wUSDAToUSDA(balanceOf(_owner), _usdaSupply());\n  }\n\n  /// @param _usdaAmount The amount of usda tokens.\n  /// @return _wusdaAmount The amount of wUSDA tokens exchangeable.\n  function underlyingToWrapper(uint256 _usdaAmount) external view override returns (uint256 _wusdaAmount) {\n    _wusdaAmount = _usdaToWUSDA(_usdaAmount, _usdaSupply());\n  }\n\n  /// @param _wusdaAmount The amount of wUSDA tokens.\n  /// @return _usdaAmount The amount of usda tokens exchangeable.\n  function wrapperToUnderlying(uint256 _wusdaAmount) external view override returns (uint256 _usdaAmount) {\n    _usdaAmount = _wUSDAToUSDA(_wusdaAmount, _usdaSupply());\n  }\n\n  //--------------------------------------------------------------------------\n  // Private methods\n\n  /// @notice Internal helper function to handle deposit state change.\n  /// @param _from The initiator wallet.\n  /// @param _to The beneficiary wallet.\n  /// @param _usdaAmount The amount of _usdaAmount to deposit.\n  /// @param _wusdaAmount The amount of _wusdaAmount to mint.\n  function _deposit(address _from, address _to, uint256 _usdaAmount, uint256 _wusdaAmount) private {\n    IERC20(USDA).safeTransferFrom(_from, address(this), _usdaAmount);\n    _mint(_to, _wusdaAmount);\n\n    emit Deposit(_from, _to, _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Internal helper function to handle withdraw state change.\n  /// @param _from The initiator wallet.\n  /// @param _to The beneficiary wallet.\n  /// @param _usdaAmount The amount of _usdaAmount to withdraw.\n  /// @param _wusdaAmount The amount of _wusdaAmount to burn.\n  function _withdraw(address _from, address _to, uint256 _usdaAmount, uint256 _wusdaAmount) private {\n    _burn(_from, _wusdaAmount);\n    IERC20(USDA).safeTransfer(_to, _usdaAmount);\n\n    emit Withdraw(_from, _to, _usdaAmount, _wusdaAmount);\n  }\n\n  /// @notice Queries the current total supply of usda.\n  /// @return _totalUsdaSupply The current usda supply.\n  function _usdaSupply() private view returns (uint256 _totalUsdaSupply) {\n    _totalUsdaSupply = IERC20(USDA).totalSupply();\n  }\n\n  //--------------------------------------------------------------------------\n  // Pure methods\n\n  /// @notice Converts _usdaAmount to wUSDA amount.\n  /// @param _usdaAmount The amount of usda tokens.\n  /// @param _totalUsdaSupply The total usda supply.\n  /// @return _wusdaAmount The amount of wUSDA tokens exchangeable.\n  function _usdaToWUSDA(uint256 _usdaAmount, uint256 _totalUsdaSupply) private pure returns (uint256 _wusdaAmount) {\n    _wusdaAmount = (_usdaAmount * MAX_wUSDA_SUPPLY) / _totalUsdaSupply;\n  }\n\n  /// @notice Converts _wusdaAmount amount to _usdaAmount.\n  /// @param _wusdaAmount The amount of wUSDA tokens.\n  /// @param _totalUsdaSupply The total usda supply.\n  /// @return _usdaAmount The amount of usda tokens exchangeable.\n  function _wUSDAToUSDA(uint256 _wusdaAmount, uint256 _totalUsdaSupply) private pure returns (uint256 _usdaAmount) {\n    _usdaAmount = (_wusdaAmount * _totalUsdaSupply) / MAX_wUSDA_SUPPLY;\n  }\n}"
    }
  ]
}