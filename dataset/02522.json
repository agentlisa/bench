{
  "Title": "Lack of access control on potentially sensitive functions",
  "Content": "In the `BaseEscalationManager` contract, the following `public` functions may benefit from access control:\n\n\n* [`requestPrice`](https://github.com/UMAprotocol/protocol/blob/fed1c5677b5e764eb0b3e59817941c129e6c26f7/packages/core/contracts/optimistic-asserter/implementation/escalation-manager/BaseEscalationManager.sol#L61)\n* [`assertionResolvedCallback`](https://github.com/UMAprotocol/protocol/blob/fed1c5677b5e764eb0b3e59817941c129e6c26f7/packages/core/contracts/optimistic-asserter/implementation/escalation-manager/BaseEscalationManager.sol#L70)\n* [`assertionDisputedCallback`](https://github.com/UMAprotocol/protocol/blob/fed1c5677b5e764eb0b3e59817941c129e6c26f7/packages/core/contracts/optimistic-asserter/implementation/escalation-manager/BaseEscalationManager.sol#L73)\n\n\nCurrently anyone can call these functions, which can result in them executing state-changing logic in an unintended context.\n\n\nConsider implementing appropriate access control on these functions so that only the expected instance(s) of the `OptimisticAsserter` contract can call them.\n\n\n***Update:** Resolved in [pull request #4334](https://github.com/UMAprotocol/protocol/pull/4334) with commit [dd99434](https://github.com/UMAprotocol/protocol/commit/dd9943454cd8706503244279dfb331b184cbf389).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "packages/core/contracts/optimistic-asserter/implementation/escalation-manager/BaseEscalationManager.sol",
      "content": "pragma solidity 0.8.16;\n\nimport \"../../interfaces/EscalationManagerInterface.sol\";\n\n/**\n * @title BaseEscalationManager\n * @notice Base contract for escalation managers. This contract is responsible for managing the escalation policy for\n * assertions. This base implementation simply exposes the required interface and provides a default implementation\n * (returning default values or doing nothing).\n */\ncontract BaseEscalationManager is EscalationManagerInterface {\n    event PriceRequestAdded(bytes32 indexed identifier, uint256 time, bytes ancillaryData);\n\n    /**\n     * @notice Returns the assertion policy for the given assertionId.\n     * @param assertionId the assertionId to get the assertion policy for.\n     * @return the assertion policy for the given assertionId.\n     */\n    function getAssertionPolicy(bytes32 assertionId) public view virtual override returns (AssertionPolicy memory) {\n        return\n            AssertionPolicy({\n                blockAssertion: false,\n                arbitrateViaEscalationManager: false,\n                discardOracle: false,\n                validateDisputers: false\n            });\n    }\n\n    /**\n     * @notice Callback function that is called by Optimistic Asserter when an assertion is disputed. Used to validate\n     * if the dispute should be allowed based on the escalation policy.\n     * @param assertionId the assertionId to validate the dispute for.\n     * @param disputeCaller the caller of the dispute function.\n     * @return bool if the dispute is allowed, false otherwise.\n     */\n    function isDisputeAllowed(bytes32 assertionId, address disputeCaller) public view virtual override returns (bool) {\n        return true;\n    }\n\n    /**\n     * @notice Implements price getting logic. This method is called by Optimistic Asserter settling an assertion that\n     * is configured to use the escalation manager as the oracle. The interface is constructed to mimic the UMA DVM.\n     * @param identifier price identifier being requested.\n     * @param time timestamp of the price being requested.\n     * @param ancillaryData ancillary data of the price being requested.\n     * @return price from the escalation manager to inform the resolution of the dispute.\n     */\n    function getPrice(\n        bytes32 identifier,\n        uint256 time,\n        bytes memory ancillaryData\n    ) public view virtual override returns (int256) {}\n\n    /**\n     * @notice Implements price requesting logic for the escalation manager. This function is called by the Optimistic\n     * on dispute and is constructed to mimic that of the UMA DVM interface.\n     * @param identifier the identifier to fetch the price for.\n     * @param time the time to fetch the price for.\n     * @param ancillaryData ancillary data of the price being requested.\n     */\n    function requestPrice(\n        bytes32 identifier,\n        uint256 time,\n        bytes memory ancillaryData\n    ) public virtual override {\n        emit PriceRequestAdded(identifier, time, ancillaryData);\n    }\n\n    // Callback function that is called by Optimistic Asserter when an assertion is resolved.\n    function assertionResolvedCallback(bytes32 assertionId, bool assertedTruthfully) public virtual override {}\n\n    // Callback function that is called by Optimistic Asserter when an assertion is disputed.\n    function assertionDisputedCallback(bytes32 assertionId) public virtual override {}\n}"
    },
    {
      "filename": "packages/core/contracts/optimistic-asserter/implementation/escalation-manager/BaseEscalationManager.sol",
      "content": "pragma solidity 0.8.16;\n\nimport \"../../interfaces/EscalationManagerInterface.sol\";\n\n/**\n * @title BaseEscalationManager\n * @notice Base contract for escalation managers. This contract is responsible for managing the escalation policy for\n * assertions. This base implementation simply exposes the required interface and provides a default implementation\n * (returning default values or doing nothing).\n */\ncontract BaseEscalationManager is EscalationManagerInterface {\n    event PriceRequestAdded(bytes32 indexed identifier, uint256 time, bytes ancillaryData);\n\n    /**\n     * @notice Returns the assertion policy for the given assertionId.\n     * @param assertionId the assertionId to get the assertion policy for.\n     * @return the assertion policy for the given assertionId.\n     */\n    function getAssertionPolicy(bytes32 assertionId) public view virtual override returns (AssertionPolicy memory) {\n        return\n            AssertionPolicy({\n                blockAssertion: false,\n                arbitrateViaEscalationManager: false,\n                discardOracle: false,\n                validateDisputers: false\n            });\n    }\n\n    /**\n     * @notice Callback function that is called by Optimistic Asserter when an assertion is disputed. Used to validate\n     * if the dispute should be allowed based on the escalation policy.\n     * @param assertionId the assertionId to validate the dispute for.\n     * @param disputeCaller the caller of the dispute function.\n     * @return bool if the dispute is allowed, false otherwise.\n     */\n    function isDisputeAllowed(bytes32 assertionId, address disputeCaller) public view virtual override returns (bool) {\n        return true;\n    }\n\n    /**\n     * @notice Implements price getting logic. This method is called by Optimistic Asserter settling an assertion that\n     * is configured to use the escalation manager as the oracle. The interface is constructed to mimic the UMA DVM.\n     * @param identifier price identifier being requested.\n     * @param time timestamp of the price being requested.\n     * @param ancillaryData ancillary data of the price being requested.\n     * @return price from the escalation manager to inform the resolution of the dispute.\n     */\n    function getPrice(\n        bytes32 identifier,\n        uint256 time,\n        bytes memory ancillaryData\n    ) public view virtual override returns (int256) {}\n\n    /**\n     * @notice Implements price requesting logic for the escalation manager. This function is called by the Optimistic\n     * on dispute and is constructed to mimic that of the UMA DVM interface.\n     * @param identifier the identifier to fetch the price for.\n     * @param time the time to fetch the price for.\n     * @param ancillaryData ancillary data of the price being requested.\n     */\n    function requestPrice(\n        bytes32 identifier,\n        uint256 time,\n        bytes memory ancillaryData\n    ) public virtual override {\n        emit PriceRequestAdded(identifier, time, ancillaryData);\n    }\n\n    // Callback function that is called by Optimistic Asserter when an assertion is resolved.\n    function assertionResolvedCallback(bytes32 assertionId, bool assertedTruthfully) public virtual override {}\n\n    // Callback function that is called by Optimistic Asserter when an assertion is disputed.\n    function assertionDisputedCallback(bytes32 assertionId) public virtual override {}\n}"
    },
    {
      "filename": "packages/core/contracts/optimistic-asserter/implementation/escalation-manager/BaseEscalationManager.sol",
      "content": "pragma solidity 0.8.16;\n\nimport \"../../interfaces/EscalationManagerInterface.sol\";\n\n/**\n * @title BaseEscalationManager\n * @notice Base contract for escalation managers. This contract is responsible for managing the escalation policy for\n * assertions. This base implementation simply exposes the required interface and provides a default implementation\n * (returning default values or doing nothing).\n */\ncontract BaseEscalationManager is EscalationManagerInterface {\n    event PriceRequestAdded(bytes32 indexed identifier, uint256 time, bytes ancillaryData);\n\n    /**\n     * @notice Returns the assertion policy for the given assertionId.\n     * @param assertionId the assertionId to get the assertion policy for.\n     * @return the assertion policy for the given assertionId.\n     */\n    function getAssertionPolicy(bytes32 assertionId) public view virtual override returns (AssertionPolicy memory) {\n        return\n            AssertionPolicy({\n                blockAssertion: false,\n                arbitrateViaEscalationManager: false,\n                discardOracle: false,\n                validateDisputers: false\n            });\n    }\n\n    /**\n     * @notice Callback function that is called by Optimistic Asserter when an assertion is disputed. Used to validate\n     * if the dispute should be allowed based on the escalation policy.\n     * @param assertionId the assertionId to validate the dispute for.\n     * @param disputeCaller the caller of the dispute function.\n     * @return bool if the dispute is allowed, false otherwise.\n     */\n    function isDisputeAllowed(bytes32 assertionId, address disputeCaller) public view virtual override returns (bool) {\n        return true;\n    }\n\n    /**\n     * @notice Implements price getting logic. This method is called by Optimistic Asserter settling an assertion that\n     * is configured to use the escalation manager as the oracle. The interface is constructed to mimic the UMA DVM.\n     * @param identifier price identifier being requested.\n     * @param time timestamp of the price being requested.\n     * @param ancillaryData ancillary data of the price being requested.\n     * @return price from the escalation manager to inform the resolution of the dispute.\n     */\n    function getPrice(\n        bytes32 identifier,\n        uint256 time,\n        bytes memory ancillaryData\n    ) public view virtual override returns (int256) {}\n\n    /**\n     * @notice Implements price requesting logic for the escalation manager. This function is called by the Optimistic\n     * on dispute and is constructed to mimic that of the UMA DVM interface.\n     * @param identifier the identifier to fetch the price for.\n     * @param time the time to fetch the price for.\n     * @param ancillaryData ancillary data of the price being requested.\n     */\n    function requestPrice(\n        bytes32 identifier,\n        uint256 time,\n        bytes memory ancillaryData\n    ) public virtual override {\n        emit PriceRequestAdded(identifier, time, ancillaryData);\n    }\n\n    // Callback function that is called by Optimistic Asserter when an assertion is resolved.\n    function assertionResolvedCallback(bytes32 assertionId, bool assertedTruthfully) public virtual override {}\n\n    // Callback function that is called by Optimistic Asserter when an assertion is disputed.\n    function assertionDisputedCallback(bytes32 assertionId) public virtual override {}\n}"
    }
  ]
}