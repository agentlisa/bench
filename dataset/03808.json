{
  "Title": "[M09] Not using OpenZeppelin contracts",
  "Content": "[OpenZeppelin maintains a library of standard, audited, community-reviewed, and battle-tested smart contracts](https://github.com/OpenZeppelin/openzeppelin-contracts/tree/v2.5.0).  \n\nInstead of always importing these contracts, the Holdefi project reimplements them in some cases, while in other cases it just copies them.\n\n\nThis increases the amount of code that the Holdefi team will have to maintain and misses all the improvements and bug fixes that the OpenZeppelin team is constantly implementing with the help of the community.\n\n\nIn particular, the following contracts and libraries are being reimplemented or copied:\n\n\n* [the `Ownable` contract](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/Ownable.sol) can be replaced with the [OpenZeppelin’s `Ownable` contract](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v2.5.0/contracts/ownership/Ownable.sol)\n* [the `SafeMath` library](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/SafeMath.sol) can be replaced with the [OpenZeppelin’s `SafeMath` library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v2.5.0/contracts/math/SafeMath.sol)\n* The `ERC20` interface defined in [line 3](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/CollateralsWallet.sol#L3) of `CollateralsWallet.sol` and [line 25](https://github.com/holdefi/Holdefi/blob/f4df394d7cf6df347b1f1e9af8e2676c5933c2c9/contracts/Holdefi.sol#L25) of `Holdefi.sol` can be replaced with the [OpenZeppelin’s `IERC20.sol` interface](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v2.5.0/contracts/token/ERC20/IERC20.sol)\n\n\nConsider importing the OpenZeppelin contracts instead of reimplementing or copying them. These contracts can be extended to add the extra functionalities required by Holdefi.  \n\nConsider always using the full ERC interfaces so that obviously non-compliant implementations can be easily excluded.  \n\nConsider updating the library to its [latest stable version for Solidity 0.5.16](https://github.com/OpenZeppelin/openzeppelin-contracts/tree/v2.5.0).\n\n\n**Update**: *Not fixed. Holdefi’s statement for this issue:*\n\n\n\n> If we use exactly OpenZeppelin contracts, we will miss some added features like ownerChanger. But we need them and can’t remove them. For ERC20 interface, we don’t need all functions so web just use a reduced version of IERC20.sol interface.\n> \n> \n\n\n*We have updated our suggestion to make it clearer.*\n\n\n",
  "Impact": "MEDIUM",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/CollateralsWallet.sol",
      "content": "pragma solidity ^0.5.16;\r\n\r\ninterface ERC20 {\r\n\r\n    function transfer(address recipient, uint256 amount) external returns (bool);\r\n}\r\n\r\n// This contract holds collateralls\r\ncontract CollateralsWallet {\r\n\r\n\taddress public holdefiContract;\r\n\r\n\t// Disposable function to Get in touch with Holdefi contract\r\n\tfunction setHoldefiContract(address holdefiContractAddress) external {\r\n\t\trequire (holdefiContract == address(0),'Should be set once');\r\n\t\tholdefiContract = holdefiContractAddress;\r\n\t}\r\n\t\r\n\t// Holdefi contract withdraws collateral's tokens from this contract to caller's account\r\n\tfunction withdraw (address collateralAsset, address payable recipient, uint amount) external {\r\n\t\trequire (msg.sender == holdefiContract,'Sender should be holdefi contract');\r\n\t\t\r\n\t\tif (collateralAsset == address(0)){\r\n\t\t\trecipient.transfer(amount);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tERC20 token = ERC20(collateralAsset);\r\n\t\t\tbool success = token.transfer(recipient, amount);\r\n\t\t\trequire (success, 'Cannot Transfer Token');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction () payable external {\r\n\t\trequire (msg.sender == holdefiContract,'Sender should be holdefi contract');\r\n\t}\r\n}"
    }
  ]
}