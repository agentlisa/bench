{
  "Title": "[G-20] Avoid transferring amounts of zero in order to save gas",
  "Content": "\nPerforming token or Ether transfers with a zero amount may result in unnecessary gas consumption. The absence of a zero-amount check before a transfer or send operation can lead to wasted gas, as the state of the contract remains the same even if the amount is zero. \n\nAdding a conditional check for zero amounts can prevent these costly, unnecessary operations, thereby optimizing the contract's gas usage.\n\n1 issue instance in 1 file:\n\n```solidity\nFile: pt-v5-vault/src/TwabERC20.sol\n/// @audit `SafeCast.toUint96(_amount)` has not been checked for zero value before transfer\n101: twabController.transfer(_from, _to, SafeCast.toUint96(_amount));\n```\n\n[101](https://github.com/code-423n4/2024-03-pooltogether/blob/main/pt-v5-vault/src/TwabERC20.sol#L101)\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/reports/2024-03-pooltogether",
  "Code": [
    {
      "filename": "pt-v5-vault/src/TwabERC20.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.24;\n\nimport { ERC20 } from \"openzeppelin/token/ERC20/ERC20.sol\";\nimport { ERC20Permit } from \"openzeppelin/token/ERC20/extensions/ERC20Permit.sol\";\nimport { SafeCast } from \"openzeppelin/utils/math/SafeCast.sol\";\n\nimport { TwabController } from \"pt-v5-twab-controller/TwabController.sol\";\n\n/// @title  PoolTogether V5 TWAB ERC20 Token\n/// @author G9 Software Inc.\n/// @notice This contract creates an ERC20 token with balances stored in a TwabController,\n///         enabling time-weighted average balances for each depositor and token compatibility\n///         with the PoolTogether V5 Prize Pool.\n/// @dev    This contract is designed to be used as an accounting layer when building a vault\n///         for PoolTogether V5.\n/// @dev    The TwabController limits all balances including total token supply to uint96 for\n///         gas savings. Any mints that increase a balance past this limit will fail.\ncontract TwabERC20 is ERC20, ERC20Permit {\n\n    ////////////////////////////////////////////////////////////////////////////////\n    // Public Variables\n    ////////////////////////////////////////////////////////////////////////////////\n\n    /// @notice Address of the TwabController used to keep track of balances.\n    TwabController public immutable twabController;\n\n    ////////////////////////////////////////////////////////////////////////////////\n    // Errors\n    ////////////////////////////////////////////////////////////////////////////////\n\n    /// @notice Thrown if the TwabController address is the zero address.\n    error TwabControllerZeroAddress();\n\n    ////////////////////////////////////////////////////////////////////////////////\n    // Constructor\n    ////////////////////////////////////////////////////////////////////////////////\n\n    /// @notice TwabERC20 Constructor\n    /// @param name_ The name of the token\n    /// @param symbol_ The token symbol\n    constructor(\n        string memory name_,\n        string memory symbol_,\n        TwabController twabController_\n    ) ERC20(name_, symbol_) ERC20Permit(name_) {\n        if (address(0) == address(twabController_)) revert TwabControllerZeroAddress();\n        twabController = twabController_;\n    }\n\n    ////////////////////////////////////////////////////////////////////////////////\n    // Public ERC20 Overrides\n    ////////////////////////////////////////////////////////////////////////////////\n\n    /// @inheritdoc ERC20\n    function balanceOf(\n        address _account\n    ) public view virtual override(ERC20) returns (uint256) {\n        return twabController.balanceOf(address(this), _account);\n    }\n\n    /// @inheritdoc ERC20\n    function totalSupply() public view virtual override(ERC20) returns (uint256) {\n        return twabController.totalSupply(address(this));\n    }\n\n    ////////////////////////////////////////////////////////////////////////////////\n    // Internal ERC20 Overrides\n    ////////////////////////////////////////////////////////////////////////////////\n\n    /// @notice Mints tokens to `_receiver` and increases the total supply.\n    /// @dev Emits a {Transfer} event with `from` set to the zero address.\n    /// @dev `_receiver` cannot be the zero address.\n    /// @param _receiver Address that will receive the minted tokens\n    /// @param _amount Tokens to mint\n    function _mint(address _receiver, uint256 _amount) internal virtual override {\n        twabController.mint(_receiver, SafeCast.toUint96(_amount));\n        emit Transfer(address(0), _receiver, _amount);\n    }\n\n    /// @notice Destroys tokens from `_owner` and reduces the total supply.\n    /// @dev Emits a {Transfer} event with `to` set to the zero address.\n    /// @dev `_owner` cannot be the zero address.\n    /// @dev `_owner` must have at least `_amount` tokens.\n    /// @param _owner The owner of the tokens\n    /// @param _amount The amount of tokens to burn\n    function _burn(address _owner, uint256 _amount) internal virtual override {\n        twabController.burn(_owner, SafeCast.toUint96(_amount));\n        emit Transfer(_owner, address(0), _amount);\n    }\n\n    /// @notice Transfers tokens from one account to another.\n    /// @dev Emits a {Transfer} event.\n    /// @dev `_from` cannot be the zero address.\n    /// @dev `_to` cannot be the zero address.\n    /// @dev `_from` must have a balance of at least `_amount`.\n    /// @param _from Address to transfer from\n    /// @param _to Address to transfer to\n    /// @param _amount The amount of tokens to transfer\n    function _transfer(address _from, address _to, uint256 _amount) internal virtual override {\n        twabController.transfer(_from, _to, SafeCast.toUint96(_amount));\n        emit Transfer(_from, _to, _amount);\n    }\n\n}"
    }
  ]
}