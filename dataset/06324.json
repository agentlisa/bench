{
  "Title": "[G-01] Using `calldata` instead of `memory` for read-only arguments in external functions saves gas",
  "Content": "\nWhen a function with a `memory` array is called externally, the `abi.decode()` step has to use a `for-loop` to copy each index of the `calldata` to the `memory` index. Each iteration of this `for-loop` costs at least 60 gas (i.e. `60 * <mem_array>.length`). Using `calldata` directly, obliviates the need for such a loop in the contract code and runtime execution. Structs have the same overhead as an array of length one\n\n```solidity\nFile: /contracts/interfaces/IERC725X.sol\n93   function executeBatch(\n        uint256[] memory operationsType,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory datas\n    ) external payable returns (bytes[] memory);\n```\nhttps://github.com/ERC725Alliance/ERC725/blob/v5.1.0/implementations/contracts/interfaces/IERC725X.sol#L93\n\n```solidity\nFile: /contracts/interfaces/IERC725Y.sol\n35  function getDataBatch(\n        bytes32[] memory dataKeys\n    ) external view returns (bytes[] memory dataValues);\n\n52   function setData(bytes32 dataKey, bytes memory dataValue) external payable;\n\n67   function setDataBatch(\n        bytes32[] memory dataKeys,\n        bytes[] memory dataValues\n    ) external payable;    \n```\nhttps://github.com/ERC725Alliance/ERC725/blob/v5.1.0/implementations/contracts/interfaces/IERC725Y.sol#L35\n\n```solidity\nFile: /contracts/LSP20CallVerification/ILSP20CallVerifier.sol\n19  function lsp20VerifyCall(\n        address caller,\n        uint256 value,\n        bytes memory receivedCalldata\n    ) external returns (bytes4 magicValue);\n\n31    function lsp20VerifyCallResult(\n        bytes32 callHash,\n        bytes memory result\n    ) external returns (bytes4);    \n```\nhttps://github.com/code-423n4/2023-06-lukso/tree/main/contracts/LSP20CallVerification/ILSP20CallVerifier.sol#L19\n\n",
  "Impact": "GAS",
  "Source": "https://code4rena.com/reports/2023-06-lukso",
  "Code": [
    {
      "filename": "implementations/contracts/interfaces/IERC725X.sol",
      "content": "// SPDX-License-Identifier: CC0-1.0\npragma solidity ^0.8.0;\n\n// interfaces\nimport {IERC165} from \"@openzeppelin/contracts/utils/introspection/IERC165.sol\";\n\n/**\n * @title The interface for ERC725X General executor\n * @dev ERC725X provides the ability to call arbitrary functions at any other smart contract and itself,\n * including using `delegatecall`, `staticcall`, as well as creating contracts using `create` and `create2`\n * This is the basis for a smart contract based account system, but could also be used as a proxy account system\n */\ninterface IERC725X is IERC165 {\n    /**\n     * @notice Emitted when deploying a contract\n     * @param operationType The opcode used to deploy the contract (CREATE or CREATE2)\n     * @param contractAddress The created contract address\n     * @param value The amount of native tokens (in Wei) sent to fund the created contract address\n     */\n    event ContractCreated(\n        uint256 indexed operationType,\n        address indexed contractAddress,\n        uint256 indexed value,\n        bytes32 salt\n    );\n\n    /**\n     * @notice Emitted when calling an address (EOA or contract)\n     * @param operationType The low-level call opcode used to call the `to` address (CALL, STATICALL or DELEGATECALL)\n     * @param target The address to call. `target` will be unused if a contract is created (operation types 1 and 2).\n     * @param value The amount of native tokens transferred with the call (in Wei)\n     * @param selector The first 4 bytes (= function selector) of the data sent with the call\n     */\n    event Executed(\n        uint256 indexed operationType,\n        address indexed target,\n        uint256 indexed value,\n        bytes4 selector\n    );\n\n    /**\n     * @param operationType The operation type used: CALL = 0; CREATE = 1; CREATE2 = 2; STATICCALL = 3; DELEGATECALL = 4\n     * @param target The address of the EOA or smart contract.  (unused if a contract is created via operation type 1 or 2)\n     * @param value The amount of native tokens to transfer (in Wei)\n     * @param data The call data, or the creation bytecode of the contract to deploy\n     *\n     * @dev Generic executor function to:\n     *\n     * - send native tokens to any address.\n     * - interact with any contract by passing an abi-encoded function call in the `data` parameter.\n     * - deploy a contract by providing its creation bytecode in the `data` parameter.\n     *\n     * Requirements:\n     *\n     * - SHOULD only be callable by the owner of the contract set via ERC173.\n     * - if a `value` is provided, the contract MUST have at least this amount in its balance to execute successfully.\n     * - if the operation type is STATICCALL or DELEGATECALL, `value` SHOULD be 0.\n     * - `target` SHOULD be address(0) when deploying a contract.\n     *\n     * Emits an {Executed} event, when a call is made with `operationType` 0 (CALL), 3 (STATICCALL) or 4 (DELEGATECALL)\n     * Emits a {ContractCreated} event, when deploying a contract with `operationType` 1 (CREATE) or 2 (CREATE2)\n     */\n    function execute(\n        uint256 operationType,\n        address target,\n        uint256 value,\n        bytes memory data\n    ) external payable returns (bytes memory);\n\n    /**\n     * @param operationsType The list of operations type used: CALL = 0; CREATE = 1; CREATE2 = 2; STATICCALL = 3; DELEGATECALL = 4\n     * @param targets The list of addresses to call. `targets` will be unused if a contract is created (operation types 1 and 2).\n     * @param values The list of native token amounts to transfer (in Wei)\n     * @param datas The list of call data, or the creation bytecode of the contract to deploy\n     *\n     * @dev Generic batch executor function to:\n     *\n     * - send native tokens to any address.\n     * - interact with any contract by passing an abi-encoded function call in the `datas` parameter.\n     * - deploy a contract by providing its creation bytecode in the `datas` parameter.\n     *\n     * Requirements:\n     *\n     * - The length of the parameters provided MUST be equal\n     * - SHOULD only be callable by the owner of the contract set via ERC173.\n     * - if a `values` is provided, the contract MUST have at least this amount in its balance to execute successfully.\n     * - if the operation type is STATICCALL or DELEGATECALL, `values` SHOULD be 0.\n     * - `targets` SHOULD be address(0) when deploying a contract.\n     *\n     * Emits an {Executed} event, when a call is made with `operationType` 0 (CALL), 3 (STATICCALL) or 4 (DELEGATECALL)\n     * Emits a {ContractCreated} event, when deploying a contract with `operationType` 1 (CREATE) or 2 (CREATE2)\n     */\n    function executeBatch(\n        uint256[] memory operationsType,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory datas\n    ) external payable returns (bytes[] memory);\n}"
    },
    {
      "filename": "implementations/contracts/interfaces/IERC725Y.sol",
      "content": "// SPDX-License-Identifier: CC0-1.0\npragma solidity ^0.8.0;\n\n// interfaces\nimport {IERC165} from \"@openzeppelin/contracts/utils/introspection/IERC165.sol\";\n\n/**\n * @title The interface for ERC725Y General data key/value store\n * @dev ERC725Y provides the ability to set arbitrary data key/value pairs that can be changed over time\n * It is intended to standardise certain data key/value pairs to allow automated read and writes\n * from/to the contract storage\n */\ninterface IERC725Y is IERC165 {\n    /**\n     * @notice Emitted when data at a key is changed\n     * @param dataKey The data key which data value is set\n     * @param dataValue The data value to set\n     */\n    event DataChanged(bytes32 indexed dataKey, bytes dataValue);\n\n    /**\n     * @notice Gets singular data at a given `dataKey`\n     * @param dataKey The key which value to retrieve\n     * @return dataValue The data stored at the key\n     */\n    function getData(bytes32 dataKey) external view returns (bytes memory dataValue);\n\n    /**\n     * @notice Gets array of data for multiple given keys\n     * @param dataKeys The array of keys which values to retrieve\n     * @return dataValues The array of data stored at multiple keys\n     */\n    function getDataBatch(\n        bytes32[] memory dataKeys\n    ) external view returns (bytes[] memory dataValues);\n\n    /**\n     * @notice Sets singular data for a given `dataKey`\n     * @param dataKey The key to retrieve stored value\n     * @param dataValue The value to set\n     * SHOULD only be callable by the owner of the contract set via ERC173\n     *\n     * The function is marked as payable to enable flexibility on child contracts\n     *\n     * If the function is not intended to receive value, an additional check\n     * should be implemented to check that value equal 0.\n     *\n     * Emits a {DataChanged} event.\n     */\n    function setData(bytes32 dataKey, bytes memory dataValue) external payable;\n\n    /**\n     * @param dataKeys The array of data keys for values to set\n     * @param dataValues The array of values to set\n     * @dev Sets array of data for multiple given `dataKeys`\n     * SHOULD only be callable by the owner of the contract set via ERC173\n     *\n     * The function is marked as payable to enable flexibility on child contracts\n     *\n     * If the function is not intended to receive value, an additional check\n     * should be implemented to check that value equal 0.\n     *\n     * Emits a {DataChanged} event.\n     */\n    function setDataBatch(bytes32[] memory dataKeys, bytes[] memory dataValues) external payable;\n}"
    }
  ]
}