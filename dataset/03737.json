{
  "Title": "[L01] Lack of input validation",
  "Content": "The [`initialize`](https://github.com/graphprotocol/contracts/blob/d51553b3d70c61108852f0ffe1ed249254c91e9a/contracts/governance/GraphGovernance.sol#L34) function of the `GraphGovernance` contract is not validating the input parameter passed in.\n\n\nConsider adding proper checks to determine if the zero address is passed as an input parameter to avoid mistakenly setting the `governor` to a null address.\n\n\n**Update:** *Fixed in [PR463](https://github.com/graphprotocol/contracts/pull/463) at commit [`f01518d1b669aeed89d3ceaa112b315cbdfb8f85`](https://github.com/graphprotocol/contracts/pull/463/commits/f01518d1b669aeed89d3ceaa112b315cbdfb8f85).*\n\n\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "contracts/governance/GraphGovernance.sol",
      "content": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.7.3;\n\nimport \"../upgrades/GraphUpgradeable.sol\";\n\nimport \"./GraphGovernanceStorage.sol\";\n\n/**\n * @title Graph Governance Contract\n * @notice Governance contract used to inscribe Graph Council and community votes.\n */\ncontract GraphGovernance is GraphGovernanceV1Storage, GraphUpgradeable, IGraphGovernance {\n    // -- Events --\n\n    event ProposalCreated(\n        address submitter,\n        bytes32 proposalId,\n        bytes32 votes,\n        bytes32 metadata,\n        ProposalResolution resolution\n    );\n    event ProposalUpdated(\n        address submitter,\n        bytes32 proposalId,\n        bytes32 votes,\n        bytes32 metadata,\n        ProposalResolution resolution\n    );\n\n    /**\n     * @notice Initialize this contract.\n     */\n    function initialize(address _governor) public onlyImpl {\n        Governed._initialize(_governor);\n    }\n\n    // -- Proposals --\n\n    /**\n     * @notice Return whether the proposal is created.\n     * @param _proposalId Proposal identifier\n     * @return True if the proposal is already created\n     */\n    function isProposalCreated(bytes32 _proposalId) public view override returns (bool) {\n        return proposals[_proposalId].votes != 0;\n    }\n\n    /**\n     * @notice Submit a new proposal.\n     * @param _proposalId Proposal identifier. This is an IPFS hash to the content of the proposal\n     * @param _votes An IPFS hash of the collection of signatures for each vote\n     * @param _metadata A bytes32 field to attach metadata to the proposal if needed\n     * @param _resolution Resolution choice, either Accepted or Rejected\n     */\n    function createProposal(\n        bytes32 _proposalId,\n        bytes32 _votes,\n        bytes32 _metadata,\n        ProposalResolution _resolution\n    ) external override onlyGovernor {\n        require(_proposalId != 0x0, \"!proposalId\");\n        require(_votes != 0x0, \"!votes\");\n        require(_resolution != ProposalResolution.Null, \"!resolved\");\n        require(!isProposalCreated(_proposalId), \"proposed\");\n\n        proposals[_proposalId] = Proposal({ votes: _votes, metadata: _metadata, resolution: _resolution });\n        emit ProposalCreated(msg.sender, _proposalId, _votes, _metadata, _resolution);\n    }\n\n    /**\n     * @notice Updates an existing proposal.\n     * @param _proposalId Proposal identifier. This is an IPFS hash to the content of the proposal\n     * @param _votes An IPFS hash of the collection of signatures for each vote\n     * @param _metadata A bytes32 field to attach metadata to the proposal if needed\n     * @param _resolution Resolution choice, either Accepted or Rejected\n     */\n    function updateProposal(\n        bytes32 _proposalId,\n        bytes32 _votes,\n        bytes32 _metadata,\n        ProposalResolution _resolution\n    ) external override onlyGovernor {\n        require(_proposalId != 0x0, \"!proposalId\");\n        require(_votes != 0x0, \"!votes\");\n        require(_resolution != ProposalResolution.Null, \"!resolved\");\n        require(isProposalCreated(_proposalId), \"!proposed\");\n\n        proposals[_proposalId] = Proposal({ votes: _votes, metadata: _metadata, resolution: _resolution });\n        emit ProposalUpdated(msg.sender, _proposalId, _votes, _metadata, _resolution);\n    }\n}"
    }
  ]
}