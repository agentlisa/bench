{
  "Title": "Redundant operation on return values",
  "Content": "##### Description\nHere are performed some redundant operation on return values of `swapExactTokensForTokens()`:\n- https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/async/UniswapV2Swapper.sol#L52\n- https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/sync/UniswapV2AnchorSwapper.sol#L74\n\nIt makes no impact on contract security or perfomance and only noted in favour of graceful code.\n##### Recommendation\nWe recommend to remove redundant operations\n\n***\n",
  "Impact": "LOW",
  "Source": "",
  "Code": [
    {
      "filename": "packages/yswaps/contracts/swappers/async/UniswapV2Swapper.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity >=0.8.4 <0.9.0;\n\nimport '@uniswap/v2-periphery/contracts/interfaces/IUniswapV2Router02.sol';\nimport '@uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol';\nimport '@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol';\nimport './AsyncSwapper.sol';\n\ninterface IUniswapV2Swapper is IAsyncSwapper {\n  // solhint-disable-next-line func-name-mixedcase\n  function FACTORY() external view returns (address);\n\n  // solhint-disable-next-line func-name-mixedcase\n  function ROUTER() external view returns (address);\n}\n\ncontract UniswapV2Swapper is IUniswapV2Swapper, AsyncSwapper {\n  using SafeERC20 for IERC20;\n\n  // solhint-disable-next-line var-name-mixedcase\n  address public immutable override FACTORY;\n  // solhint-disable-next-line var-name-mixedcase\n  address public immutable override ROUTER;\n\n  constructor(\n    address _governor,\n    address _tradeFactory,\n    address _uniswapFactory,\n    address _uniswapRouter\n  ) AsyncSwapper(_governor, _tradeFactory) {\n    FACTORY = _uniswapFactory;\n    ROUTER = _uniswapRouter;\n  }\n\n  function _executeSwap(\n    address _receiver,\n    address _tokenIn,\n    address _tokenOut,\n    uint256 _amountIn,\n    bytes calldata _data\n  ) internal override {\n    address[] memory _path = abi.decode(_data, (address[]));\n    if (_tokenIn != _path[0] || _tokenOut != _path[_path.length - 1]) revert CommonErrors.IncorrectSwapInformation();\n    IERC20(_path[0]).approve(ROUTER, 0);\n    IERC20(_path[0]).approve(ROUTER, _amountIn);\n    IUniswapV2Router02(ROUTER).swapExactTokensForTokens(\n      _amountIn,\n      0, // Slippage protection is done in AsyncSwapper abstract\n      _path,\n      _receiver,\n      block.timestamp\n    )[_path.length - 1];\n  }\n}"
    },
    {
      "filename": "packages/yswaps/contracts/swappers/sync/UniswapV2AnchorSwapper.sol",
      "content": "// SPDX-License-Identifier: MIT\npragma solidity >=0.8.4 <0.9.0;\n\nimport '@uniswap/v2-periphery/contracts/interfaces/IUniswapV2Router02.sol';\nimport '@uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol';\nimport '@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol';\nimport '@openzeppelin/contracts/utils/math/Math.sol';\nimport './SyncSwapper.sol';\n\ninterface IUniswapV2AnchorSwapper is ISyncSwapper {\n  // solhint-disable-next-line func-name-mixedcase\n  function WANCHOR() external view returns (address);\n\n  // solhint-disable-next-line func-name-mixedcase\n  function WETH() external view returns (address);\n\n  // solhint-disable-next-line func-name-mixedcase\n  function FACTORY() external view returns (address);\n\n  // solhint-disable-next-line func-name-mixedcase\n  function ROUTER() external view returns (address);\n}\n\ncontract UniswapV2AnchorSwapper is IUniswapV2AnchorSwapper, SyncSwapper {\n  using SafeERC20 for IERC20;\n\n  // solhint-disable-next-line var-name-mixedcase\n  address public immutable override WETH;\n  // solhint-disable-next-line var-name-mixedcase\n  address public immutable override WANCHOR;\n  // solhint-disable-next-line var-name-mixedcase\n  address public immutable override FACTORY;\n  // solhint-disable-next-line var-name-mixedcase\n  address public immutable override ROUTER;\n\n  constructor(\n    address _governor,\n    address _tradeFactory,\n    address _weth,\n    address _wanchor,\n    address _factory,\n    address _router\n  ) SyncSwapper(_governor, _tradeFactory) {\n    WETH = _weth;\n    WANCHOR = _wanchor;\n    FACTORY = _factory;\n    ROUTER = _router;\n  }\n\n  function _executeSwap(\n    address _receiver,\n    address _tokenIn,\n    address _tokenOut,\n    uint256 _amountIn,\n    uint256 _maxSlippage,\n    bytes calldata _data\n  ) internal override {\n    address[] memory _path;\n    uint256 _amountOut;\n    if (_data.length > 0) {\n      _path = abi.decode(_data, (address[]));\n      _amountOut = IUniswapV2Router02(ROUTER).getAmountsOut(_amountIn, _path)[_path.length - 1];\n    } else {\n      (_path, _amountOut) = _getPathAndAmountOut(_tokenIn, _tokenOut, _amountIn);\n    }\n    IERC20(_path[0]).approve(ROUTER, 0);\n    IERC20(_path[0]).approve(ROUTER, _amountIn);\n    IUniswapV2Router02(ROUTER).swapExactTokensForTokens(\n      _amountIn,\n      _amountOut - ((_amountOut * _maxSlippage) / SLIPPAGE_PRECISION / 100), // slippage calcs\n      _path,\n      _receiver,\n      block.timestamp + 1800\n    )[_path.length - 1];\n  }\n\n  function _getPathAndAmountOut(\n    address _tokenIn,\n    address _tokenOut,\n    uint256 _amountIn\n  ) internal view returns (address[] memory _path, uint256 _amountOut) {\n    uint256 _amountOutByDirectPath;\n    address[] memory _directPath;\n    if (IUniswapV2Factory(FACTORY).getPair(_tokenIn, _tokenOut) != address(0)) {\n      _directPath = new address[](2);\n      _directPath[0] = _tokenIn;\n      _directPath[1] = _tokenOut;\n      _amountOutByDirectPath = IUniswapV2Router02(ROUTER).getAmountsOut(_amountIn, _directPath)[1];\n    }\n\n    uint256 _amountOutByWETHHopPath;\n    // solhint-disable-next-line var-name-mixedcase\n    address[] memory _WETHHopPath;\n    if (IUniswapV2Factory(FACTORY).getPair(_tokenIn, WETH) != address(0) && IUniswapV2Factory(FACTORY).getPair(WETH, _tokenOut) != address(0)) {\n      _WETHHopPath = new address[](3);\n      _WETHHopPath[0] = _tokenIn;\n      _WETHHopPath[1] = WETH;\n      _WETHHopPath[2] = _tokenOut;\n      _amountOutByWETHHopPath = IUniswapV2Router02(ROUTER).getAmountsOut(_amountIn, _WETHHopPath)[2];\n    }\n\n    uint256 _amountOutByWANCHORHopPath;\n    // solhint-disable-next-line var-name-mixedcase\n    address[] memory _WANCHORHopPath;\n    if (\n      IUniswapV2Factory(FACTORY).getPair(_tokenIn, WANCHOR) != address(0) && IUniswapV2Factory(FACTORY).getPair(WANCHOR, _tokenOut) != address(0)\n    ) {\n      _WANCHORHopPath = new address[](3);\n      _WANCHORHopPath[0] = _tokenIn;\n      _WANCHORHopPath[1] = WANCHOR;\n      _WANCHORHopPath[2] = _tokenOut;\n      _amountOutByWANCHORHopPath = IUniswapV2Router02(ROUTER).getAmountsOut(_amountIn, _WANCHORHopPath)[2];\n    }\n\n    if (\n      Math.max(Math.max(_amountOutByDirectPath, _amountOutByWETHHopPath), Math.max(_amountOutByDirectPath, _amountOutByWANCHORHopPath)) ==\n      _amountOutByDirectPath\n    ) {\n      return (_directPath, _amountOutByDirectPath);\n    }\n\n    if (Math.max(_amountOutByWETHHopPath, _amountOutByWANCHORHopPath) == _amountOutByWETHHopPath) {\n      return (_WETHHopPath, _amountOutByWETHHopPath);\n    }\n\n    return (_WANCHORHopPath, _amountOutByWANCHORHopPath);\n  }\n}"
    }
  ]
}