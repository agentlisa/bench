{
  "Title": "[R-04] Parameter `_mTokenData` for `MultiRewardDistributor::calculateBorrowRewardsForUser` is unnecessary",
  "Content": "\nThe struct `MTokenData` has two fields: [`mTokenBalance` and `borrowBalanceStored`](https://github.com/code-423n4/2023-07-moonwell/blob/main/src/core/MultiRewardDistributor/MultiRewardDistributorCommon.sol#L50-L53). However only [one of them is used](https://github.com/code-423n4/2023-07-moonwell/blob/main/src/core/MultiRewardDistributor/MultiRewardDistributor.sol#L887) in `calculateBorrowRewardsForUser`.\n\nTherefore it is confusing that the whole struct is passed to the function as that implies that both fields would be used.\n\nConsider just passing `borrowBalanceStored` directly instead of the struct.\n\n## Non-critical (6)\n\n",
  "Impact": "LOW",
  "Source": "https://code4rena.com/reports/2023-07-moonwell",
  "Code": [
    {
      "filename": "src/core/MultiRewardDistributor/MultiRewardDistributorCommon.sol",
      "content": "// SPDX-License-Identifier: BSD-3-Clause\npragma solidity 0.8.17;\n\nimport \"../MToken.sol\";\n\n// The commonly structures and events for the MultiRewardDistributor\ninterface MultiRewardDistributorCommon {\n    struct MarketConfig {\n        // The owner/admin of the emission config\n        address owner;\n\n        // The emission token\n        address emissionToken;\n\n        // Scheduled to end at this time\n        uint endTime;\n\n        // Supplier global state\n        uint224 supplyGlobalIndex;\n        uint32 supplyGlobalTimestamp;\n\n        // Borrower global state\n        uint224 borrowGlobalIndex;\n        uint32 borrowGlobalTimestamp;\n\n        uint supplyEmissionsPerSec;\n        uint borrowEmissionsPerSec;\n    }\n\n    struct MarketEmissionConfig {\n        MarketConfig config;\n        mapping(address => uint) supplierIndices;\n        mapping(address => uint) supplierRewardsAccrued;\n        mapping(address => uint) borrowerIndices;\n        mapping(address => uint) borrowerRewardsAccrued;\n    }\n\n    struct RewardInfo{\n        address emissionToken;\n        uint totalAmount;\n        uint supplySide;\n        uint borrowSide;\n    }\n\n    struct IndexUpdate{\n        uint224 newIndex;\n        uint32 newTimestamp;\n    }\n\n    struct MTokenData {\n        uint mTokenBalance;\n        uint borrowBalanceStored;\n    }\n\n    struct RewardWithMToken {\n        address mToken;\n        RewardInfo[] rewards;\n    }\n\n    // Global index updates\n    event GlobalSupplyIndexUpdated(MToken mToken, address emissionToken, uint newSupplyIndex, uint32 newSupplyGlobalTimestamp);\n    event GlobalBorrowIndexUpdated(MToken mToken, address emissionToken, uint newIndex, uint32 newTimestamp);\n\n    // Reward Disbursal\n    event DisbursedSupplierRewards(MToken indexed mToken, address indexed supplier, address indexed emissionToken, uint totalAccrued);\n    event DisbursedBorrowerRewards(MToken indexed mToken, address indexed borrower, address indexed emissionToken, uint totalAccrued);\n\n    // Admin update events\n    event NewConfigCreated(MToken indexed mToken, address indexed owner, address indexed emissionToken, uint supplySpeed, uint borrowSpeed, uint endTime);\n    event NewPauseGuardian(address oldPauseGuardian, address newPauseGuardian);\n    event NewEmissionCap(uint oldEmissionCap, uint newEmissionCap);\n    event NewEmissionConfigOwner(MToken indexed mToken, address indexed emissionToken, address currentOwner, address newOwner);\n    event NewRewardEndTime(MToken indexed mToken, address indexed emissionToken, uint currentEndTime, uint newEndTime);\n    event NewSupplyRewardSpeed(MToken indexed mToken, address indexed emissionToken, uint oldRewardSpeed, uint newRewardSpeed);\n    event NewBorrowRewardSpeed(MToken indexed mToken, address indexed emissionToken, uint oldRewardSpeed, uint newRewardSpeed);\n    event FundsRescued(address token, uint amount);\n\n    // Pause guardian stuff\n    event RewardsPaused();\n    event RewardsUnpaused();\n\n    // Errors\n    event InsufficientTokensToEmit(address payable user, address rewardToken, uint amount);\n}"
    }
  ]
}