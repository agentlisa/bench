{
  "Title": "[H-03] Update initializer modifier to prevent reentrancy during initialization",
  "Content": "_Submitted by Dravee_\n\n[package.json#L18-L19](https://github.com/code-423n4/2022-04-jpegd/blob/main/package.json#L18-L19)<br>\n\nThe solution uses:\n\n```jsx\n    \"@openzeppelin/contracts\": \"^4.0.0\",\n    \"@openzeppelin/contracts-upgradeable\": \"^4.3.2\",\n```\n\nThese dependencies have a known high severity vulnerability:\n\n*   <https://security.snyk.io/vuln/SNYK-JS-OPENZEPPELINCONTRACTSUPGRADEABLE-2320177>\n*   <https://snyk.io/test/npm/@openzeppelin/contracts-upgradeable/4.3.2#SNYK-JS-OPENZEPPELINCONTRACTSUPGRADEABLE-2320177>\n*   <https://snyk.io/test/npm/@openzeppelin/contracts/4.0.0#SNYK-JS-OPENZEPPELINCONTRACTS-2320176>\n\nWhich makes these contracts vulnerable:\n\n```jsx\ncontracts/helpers/CryptoPunksHelper.sol:\n  19:     function initialize(address punksAddress) external initializer {\n\ncontracts/helpers/EtherRocksHelper.sol:\n  19:     function initialize(address rocksAddress) external initializer {\n\ncontracts/staking/JPEGStaking.sol:\n  21:     function initialize(IERC20Upgradeable _jpeg) external initializer {\n\ncontracts/vaults/FungibleAssetVaultForDAO.sol:\n  71:     ) external initializer {\n\ncontracts/vaults/NFTVault.sol:\n  149:     ) external initializer {\n```\n\n### Recommended Mitigation Steps\n\nUpgrade `@openzeppelin/contracts` and `@openzeppelin/contracts-upgradeable` to version 4.4.1 or higher.\n\n**[spaghettieth (JPEG'd) confirmed, but disagreed with High severity](https://github.com/code-423n4/2022-04-jpegd-findings/issues/227)**\n\n**[spaghettieth (JPEG'd) resolved and commented](https://github.com/code-423n4/2022-04-jpegd-findings/issues/227#issuecomment-1099246138):**\n > Fixed in [jpegd/core#11](https://github.com/jpegd/core/pull/11).\n\n\n\n***\n\n",
  "Impact": "HIGH",
  "Source": "https://code4rena.com/contests/2022-04-jpegd-contest",
  "Code": [
    {
      "filename": "package.json",
      "content": "{\n  \"name\": \"jpegd\",\n  \"version\": \"1.0.0\",\n  \"main\": \"index.js\",\n  \"repository\": \"git@github.com:iceboxup/jpegd.git\",\n  \"license\": \"MIT\",\n  \"scripts\": {\n    \"compile\": \"hardhat compile\",\n    \"prettier\": \"prettier --write \\\"tests/**/*.ts\\\" \\\"deploy/**/*.ts\\\"\",\n    \"test\": \"hardhat test\",\n    \"coverage\": \"rm -r ./cache & hardhat coverage --network hardhat\"\n  },\n  \"devDependencies\": {\n    \"@nomiclabs/hardhat-ethers\": \"^2.0.2\",\n    \"@nomiclabs/hardhat-etherscan\": \"^2.1.2\",\n    \"@nomiclabs/hardhat-waffle\": \"^2.0.1\",\n    \"@nomiclabs/hardhat-web3\": \"^2.0.0\",\n    \"@openzeppelin/contracts\": \"^4.0.0\",\n    \"@openzeppelin/contracts-upgradeable\": \"^4.3.2\",\n    \"@openzeppelin/hardhat-upgrades\": \"^1.11.0\",\n    \"@openzeppelin/test-helpers\": \"^0.5.10\",\n    \"@typechain/ethers-v5\": \"^7.0.0\",\n    \"@typechain/hardhat\": \"^2.0.1\",\n    \"@types/mocha\": \"^9.0.0\",\n    \"chai\": \"^4.3.4\",\n    \"ethereum-waffle\": \"^3.3.0\",\n    \"ethers\": \"^5.1.0\",\n    \"hardhat\": \"^2.2.0\",\n    \"hardhat-abi-exporter\": \"^2.2.1\",\n    \"hardhat-gas-reporter\": \"^1.0.4\",\n    \"solc\": \"^0.8.3\",\n    \"solidity-bytes-utils\": \"^0.8.0\",\n    \"solidity-coverage\": \"^0.7.16\",\n    \"ts-node\": \"^10.3.0\",\n    \"typechain\": \"^5.0.0\",\n    \"typescript\": \"^4.4.4\",\n    \"web3\": \"^1.3.5\"\n  },\n  \"dependencies\": {\n    \"dotenv\": \"^8.2.0\"\n  }\n}"
    }
  ]
}