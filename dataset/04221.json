{
  "Title": "Certain encodings can make passwords impossible to input",
  "Content": "Type:   Data   Validation\nTarget:    eth2deposit\n\nDiﬃculty:   High\nDescription\nThe   use   of   certain   characters   (e.g.,    ñ )   in   the   password   will   produce   diﬀerent   results\naccording   to   the   terminal   encoding   and   how   the   password   is   provided.\nThe   deposit   tool   was   implemented   to   accept   UTF-8   input,   forcing   the   conversion   to   that\nencoding   at   each   point   of   input   handling:\n@staticmethod\ndef     _process_password (password:   str)    ->    bytes:\n\"\"\"\nEncode   password   as   NFKD   UTF-8   as   per:\nhttps://github.com/ethereum/EIPs/blob/master/EIPS/eip-2335.md#password-requirements\n\"\"\"\npassword    =     normalize ( 'NFKD' ,   password)\npassword    =     '' . join (c    for    c    in    password    if     ord (c)    not     in     UNICODE_CONTROL_CHARS )\nreturn    password. encode ( 'UTF-8' )\nFigure   8.1:    _process_password    function   to   force   UTF-8   encoding.\nHowever,   it   seems   that   the   tool   can   still   fail   with   the   following   list   of   errors   when   it   is   run   by\nforcing    LANG=\"en_US-iso8859-1\" ,    iso8859-1    as   the   terminal   input   encoding   or   the\npassword   speciﬁed   in   the   command   line:\nUnicodeDecodeError:   'utf-8'   codec   can't   decode   byte   0xf1   in   position   0:\ninvalid   continuation   byte\nUnicodeDecodeError:   'ascii'   codec   can't   decode   byte   0xc3   in   position   0:\nordinal   not   in   range(128)\nUnicodeEncodeError:   'utf-8'   codec   can't   encode   character   '\\udcf1'   in\nposition   0:   surrogates   not   allowed\nFigure   8.2:    Diﬀerent   encoding   errors.\nAdditionally,   Windows   users   could   have   issues   since   the   use   of   UTF-8   in   that   operating\nsystem   is    not   enabled   by   default .\n©   2020   Trail   of   Bits\nDeposit   CLI   Assessment   |   20\nExploit   Scenario\nAlice   generates   a   password   with   certain   characters   in   one   operating   system.   Later,   she\nmoves   to   another   platform   with   unsupported   encoding   and   is   unable   to   re-enter   her\npassword.\nRecommendation\nShort   term,   validate   the   conﬁguration   of   terminal   encoding   and   system   encoding     to\nmitigate   the   risk   of   users   employing   conﬁgurations   that   fail   to   run   the   tool   properly.\nAdditionally,   document   the   recommended   conﬁguration   for   users.\nLong   term,   review   the   use   of   text   encoding   in   each   step   of   key   generation   and   storage.   This\nwill   mitigate   the   risk   of   users   employing   conﬁgurations   that   fail   to   run   the   tool   properly.\nAlso,   properly   document   each   corner   case,   especially   for   non-Latin   languages.\n©   2020   Trail   of   Bits\nDeposit   CLI   Assessment   |   21",
  "Impact": "LOW",
  "Source": "https://github.com/trailofbits/publications/blob/master/reviews/ETH2DepositCLI.pdf",
  "Code": [
    {
      "filename": "EIPS/eip-2335.md",
      "content": "---\neip: 2335\ncategory: ERC\nstatus: Moved\n---\n\nThis file was moved to https://github.com/ethereum/ercs/blob/master/ERCS/erc-2335.md"
    }
  ]
}